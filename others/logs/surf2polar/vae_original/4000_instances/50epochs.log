trn -- size:4000,  avg_surf_len: 10.04, avg_feat_len: 10.76, avg_root_len: 3.98 
Pos tag Verb: 0.97, count: 3886
Pos tag Noun: 0.02, count: 78
Pos tag Adj: 0.01, count: 36
Polarity tag Neg: 0.50, count: 2000 
Polarity tag Pos: 0.50, count: 2000 
Tense tag <unk>: 0.44, count: 1759 
Tense tag Past: 0.25, count: 993 
Tense tag Aor: 0.15, count: 599 
Tense tag Prog1: 0.08, count: 333 
Tense tag Narr: 0.04, count: 163 
Tense tag Fut: 0.04, count: 149 
Tense tag Prog2: 0.00, count: 04 
Surfpos tag Verb: 0.68, count: 2701 
Surfpos tag Noun: 0.24, count: 956 
Surfpos tag Adj: 0.09, count: 343 
val -- size:3000,  avg_surf_len: 10.07, avg_feat_len: 10.72, avg_root_len: 3.91 
Pos tag Verb: 0.98, count: 2947
Pos tag Noun: 0.01, count: 30
Pos tag Adj: 0.01, count: 23
Polarity tag Neg: 0.50, count: 1500 
Polarity tag Pos: 0.50, count: 1500 
Tense tag <unk>: 0.47, count: 1423 
Tense tag Past: 0.22, count: 671 
Tense tag Aor: 0.11, count: 326 
Tense tag Prog1: 0.10, count: 313 
Tense tag Narr: 0.05, count: 141 
Tense tag Fut: 0.04, count: 120 
Tense tag Prog2: 0.00, count: 06 
Surfpos tag Verb: 0.64, count: 1907 
Surfpos tag Noun: 0.27, count: 818 
Surfpos tag Adj: 0.09, count: 275 

number of params: 3072 
Namespace(axs=array([<matplotlib.axes._subplots.AxesSubplot object at 0x7f7dac971cd0>,
       <matplotlib.axes._subplots.AxesSubplot object at 0x7f7da29e7f90>],
      dtype=object), basemodel='models/vae/VAE_trmor_agg1_kls0.10_warm10_0_0.pt', batchsize=128, bidirectional=False, bmodel='vae_original', clip_grad=5.0, dec_dropout_in=0.0, dec_dropout_out=0.0, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_nh=1024, epochs=50, fig=<Figure size 640x480 with 2 Axes>, fig_path='logs/surf2polar/vae_original/4000_instances/50epochs.png', freeze_decoder=True, freeze_encoder=True, is_clip_grad=False, log_path='logs/surf2polar/vae_original/4000_instances/50epochs.log', logger=<utils.Logger object at 0x7f7da293c410>, lr=0.01, maxtrnsize=57769, maxtstsize=8517, maxvalsize=8329, model=VAE(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): None
  )
  (decoder): None
  (probe_linear): Linear(in_features=1024, out_features=3, bias=False)
  (closs): CrossEntropyLoss()
), modelname='logs/surf2polar/vae_original/4000_instances', ni=512, nz=32, opt='Adam', plt_style='-', reset_decoder=False, reset_encoder=False, save_path='logs/surf2polar/vae_original/4000_instances/50epochs.pt', seq_to_no_pad='surface', surface_vocab_file='trmor_data/surf/surf.uniquesurfs.trn.txt', task='surf2polar', trndata='trmor_data/polar/polar.uniquesurfs.trn.txt', trnsize=4000, tstsize=0, valdata='trmor_data/polar/polar.uniquesurfs.val.txt', valsize=3000)

encoder.embed.weight, torch.Size([39, 512]): False
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): False
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): False
encoder.lstm.bias_ih_l0, torch.Size([4096]): False
encoder.lstm.bias_hh_l0, torch.Size([4096]): False
probe_linear.weight, torch.Size([3, 1024]): True
epoch: 0 avg_loss: 74.2754, ppl: 2.4383, acc: 0.7690 
epoch correct: 3076 epoch wrong: 924 epoch_num_tokens: 4000 
val --- avg_loss: 57.6637, ppl: 2.0759, acc: 0.8453  
epoch correct: 2536 epoch wrong: 464 epoch_num_tokens: 3000 
update best loss 

epoch: 1 avg_loss: 54.0054, ppl: 1.9118, acc: 0.8160 
epoch correct: 3264 epoch wrong: 736 epoch_num_tokens: 4000 
val --- avg_loss: 45.8332, ppl: 1.7870, acc: 0.8427  
epoch correct: 2528 epoch wrong: 472 epoch_num_tokens: 3000 
update best loss 

epoch: 2 avg_loss: 45.1673, ppl: 1.7195, acc: 0.8335 
epoch correct: 3334 epoch wrong: 666 epoch_num_tokens: 4000 
val --- avg_loss: 39.7953, ppl: 1.6555, acc: 0.8490  
epoch correct: 2547 epoch wrong: 453 epoch_num_tokens: 3000 
update best loss 

epoch: 3 avg_loss: 39.9091, ppl: 1.6143, acc: 0.8465 
epoch correct: 3386 epoch wrong: 614 epoch_num_tokens: 4000 
val --- avg_loss: 36.1912, ppl: 1.5816, acc: 0.8610  
epoch correct: 2583 epoch wrong: 417 epoch_num_tokens: 3000 
update best loss 

epoch: 4 avg_loss: 36.8757, ppl: 1.5566, acc: 0.8508 
epoch correct: 3403 epoch wrong: 597 epoch_num_tokens: 4000 
val --- avg_loss: 33.5277, ppl: 1.5291, acc: 0.8720  
epoch correct: 2616 epoch wrong: 384 epoch_num_tokens: 3000 
update best loss 

epoch: 5 avg_loss: 33.8796, ppl: 1.5016, acc: 0.8665 
epoch correct: 3466 epoch wrong: 534 epoch_num_tokens: 4000 
val --- avg_loss: 31.5674, ppl: 1.4916, acc: 0.8747  
epoch correct: 2624 epoch wrong: 376 epoch_num_tokens: 3000 
update best loss 

epoch: 6 avg_loss: 31.9467, ppl: 1.4672, acc: 0.8802 
epoch correct: 3521 epoch wrong: 479 epoch_num_tokens: 4000 
val --- avg_loss: 30.1105, ppl: 1.4643, acc: 0.8807  
epoch correct: 2642 epoch wrong: 358 epoch_num_tokens: 3000 
update best loss 

epoch: 7 avg_loss: 30.1224, ppl: 1.4354, acc: 0.8925 
epoch correct: 3570 epoch wrong: 430 epoch_num_tokens: 4000 
val --- avg_loss: 28.7739, ppl: 1.4397, acc: 0.8910  
epoch correct: 2673 epoch wrong: 327 epoch_num_tokens: 3000 
update best loss 

epoch: 8 avg_loss: 28.8558, ppl: 1.4138, acc: 0.8955 
epoch correct: 3582 epoch wrong: 418 epoch_num_tokens: 4000 
val --- avg_loss: 27.5999, ppl: 1.4185, acc: 0.8973  
epoch correct: 2692 epoch wrong: 308 epoch_num_tokens: 3000 
update best loss 

epoch: 9 avg_loss: 27.6748, ppl: 1.3939, acc: 0.9008 
epoch correct: 3603 epoch wrong: 397 epoch_num_tokens: 4000 
val --- avg_loss: 26.7235, ppl: 1.4028, acc: 0.8947  
epoch correct: 2684 epoch wrong: 316 epoch_num_tokens: 3000 
update best loss 

epoch: 10 avg_loss: 26.7005, ppl: 1.3777, acc: 0.9018 
epoch correct: 3607 epoch wrong: 393 epoch_num_tokens: 4000 
val --- avg_loss: 25.8324, ppl: 1.3871, acc: 0.9023  
epoch correct: 2707 epoch wrong: 293 epoch_num_tokens: 3000 
update best loss 

epoch: 11 avg_loss: 25.7659, ppl: 1.3623, acc: 0.9090 
epoch correct: 3636 epoch wrong: 364 epoch_num_tokens: 4000 
val --- avg_loss: 25.0701, ppl: 1.3738, acc: 0.9067  
epoch correct: 2720 epoch wrong: 280 epoch_num_tokens: 3000 
update best loss 

epoch: 12 avg_loss: 24.9065, ppl: 1.3483, acc: 0.9103 
epoch correct: 3641 epoch wrong: 359 epoch_num_tokens: 4000 
val --- avg_loss: 24.4349, ppl: 1.3628, acc: 0.9097  
epoch correct: 2729 epoch wrong: 271 epoch_num_tokens: 3000 
update best loss 

epoch: 13 avg_loss: 24.3493, ppl: 1.3394, acc: 0.9145 
epoch correct: 3658 epoch wrong: 342 epoch_num_tokens: 4000 
val --- avg_loss: 23.8359, ppl: 1.3525, acc: 0.9130  
epoch correct: 2739 epoch wrong: 261 epoch_num_tokens: 3000 
update best loss 

epoch: 14 avg_loss: 23.4875, ppl: 1.3256, acc: 0.9200 
epoch correct: 3680 epoch wrong: 320 epoch_num_tokens: 4000 
val --- avg_loss: 23.2750, ppl: 1.3429, acc: 0.9150  
epoch correct: 2745 epoch wrong: 255 epoch_num_tokens: 3000 
update best loss 

epoch: 15 avg_loss: 23.0329, ppl: 1.3184, acc: 0.9250 
epoch correct: 3700 epoch wrong: 300 epoch_num_tokens: 4000 
val --- avg_loss: 22.7228, ppl: 1.3335, acc: 0.9173  
epoch correct: 2752 epoch wrong: 248 epoch_num_tokens: 3000 
update best loss 

epoch: 16 avg_loss: 22.6603, ppl: 1.3125, acc: 0.9260 
epoch correct: 3704 epoch wrong: 296 epoch_num_tokens: 4000 
val --- avg_loss: 22.2407, ppl: 1.3254, acc: 0.9197  
epoch correct: 2759 epoch wrong: 241 epoch_num_tokens: 3000 
update best loss 

epoch: 17 avg_loss: 21.8054, ppl: 1.2991, acc: 0.9280 
epoch correct: 3712 epoch wrong: 288 epoch_num_tokens: 4000 
val --- avg_loss: 21.8274, ppl: 1.3185, acc: 0.9197  
epoch correct: 2759 epoch wrong: 241 epoch_num_tokens: 3000 
update best loss 

epoch: 18 avg_loss: 21.5664, ppl: 1.2954, acc: 0.9300 
epoch correct: 3720 epoch wrong: 280 epoch_num_tokens: 4000 
val --- avg_loss: 21.4160, ppl: 1.3116, acc: 0.9213  
epoch correct: 2764 epoch wrong: 236 epoch_num_tokens: 3000 
update best loss 

epoch: 19 avg_loss: 20.8911, ppl: 1.2849, acc: 0.9313 
epoch correct: 3725 epoch wrong: 275 epoch_num_tokens: 4000 
val --- avg_loss: 21.0308, ppl: 1.3052, acc: 0.9223  
epoch correct: 2767 epoch wrong: 233 epoch_num_tokens: 3000 
update best loss 

epoch: 20 avg_loss: 20.6567, ppl: 1.2813, acc: 0.9335 
epoch correct: 3734 epoch wrong: 266 epoch_num_tokens: 4000 
val --- avg_loss: 20.6674, ppl: 1.2992, acc: 0.9253  
epoch correct: 2776 epoch wrong: 224 epoch_num_tokens: 3000 
update best loss 

epoch: 21 avg_loss: 20.0507, ppl: 1.2720, acc: 0.9360 
epoch correct: 3744 epoch wrong: 256 epoch_num_tokens: 4000 
val --- avg_loss: 20.2926, ppl: 1.2931, acc: 0.9260  
epoch correct: 2778 epoch wrong: 222 epoch_num_tokens: 3000 
update best loss 

epoch: 22 avg_loss: 19.7352, ppl: 1.2672, acc: 0.9367 
epoch correct: 3747 epoch wrong: 253 epoch_num_tokens: 4000 
val --- avg_loss: 20.0369, ppl: 1.2889, acc: 0.9277  
epoch correct: 2783 epoch wrong: 217 epoch_num_tokens: 3000 
update best loss 

epoch: 23 avg_loss: 19.4472, ppl: 1.2628, acc: 0.9380 
epoch correct: 3752 epoch wrong: 248 epoch_num_tokens: 4000 
val --- avg_loss: 19.7072, ppl: 1.2835, acc: 0.9283  
epoch correct: 2785 epoch wrong: 215 epoch_num_tokens: 3000 
update best loss 

epoch: 24 avg_loss: 19.2995, ppl: 1.2606, acc: 0.9365 
epoch correct: 3746 epoch wrong: 254 epoch_num_tokens: 4000 
val --- avg_loss: 19.3889, ppl: 1.2784, acc: 0.9297  
epoch correct: 2789 epoch wrong: 211 epoch_num_tokens: 3000 
update best loss 

epoch: 25 avg_loss: 18.7288, ppl: 1.2520, acc: 0.9400 
epoch correct: 3760 epoch wrong: 240 epoch_num_tokens: 4000 
val --- avg_loss: 19.1489, ppl: 1.2745, acc: 0.9300  
epoch correct: 2790 epoch wrong: 210 epoch_num_tokens: 3000 
update best loss 

epoch: 26 avg_loss: 18.4763, ppl: 1.2482, acc: 0.9407 
epoch correct: 3763 epoch wrong: 237 epoch_num_tokens: 4000 
val --- avg_loss: 18.8863, ppl: 1.2703, acc: 0.9317  
epoch correct: 2795 epoch wrong: 205 epoch_num_tokens: 3000 
update best loss 

epoch: 27 avg_loss: 18.1905, ppl: 1.2439, acc: 0.9415 
epoch correct: 3766 epoch wrong: 234 epoch_num_tokens: 4000 
val --- avg_loss: 18.6361, ppl: 1.2662, acc: 0.9320  
epoch correct: 2796 epoch wrong: 204 epoch_num_tokens: 3000 
update best loss 

epoch: 28 avg_loss: 17.9457, ppl: 1.2403, acc: 0.9435 
epoch correct: 3774 epoch wrong: 226 epoch_num_tokens: 4000 
val --- avg_loss: 18.3544, ppl: 1.2617, acc: 0.9327  
epoch correct: 2798 epoch wrong: 202 epoch_num_tokens: 3000 
update best loss 

epoch: 29 avg_loss: 17.7207, ppl: 1.2369, acc: 0.9437 
epoch correct: 3775 epoch wrong: 225 epoch_num_tokens: 4000 
val --- avg_loss: 18.1323, ppl: 1.2582, acc: 0.9333  
epoch correct: 2800 epoch wrong: 200 epoch_num_tokens: 3000 
update best loss 

epoch: 30 avg_loss: 17.4456, ppl: 1.2329, acc: 0.9470 
epoch correct: 3788 epoch wrong: 212 epoch_num_tokens: 4000 
val --- avg_loss: 17.9174, ppl: 1.2548, acc: 0.9347  
epoch correct: 2804 epoch wrong: 196 epoch_num_tokens: 3000 
update best loss 

epoch: 31 avg_loss: 17.1817, ppl: 1.2290, acc: 0.9435 
epoch correct: 3774 epoch wrong: 226 epoch_num_tokens: 4000 
val --- avg_loss: 17.7107, ppl: 1.2515, acc: 0.9353  
epoch correct: 2806 epoch wrong: 194 epoch_num_tokens: 3000 
update best loss 

epoch: 32 avg_loss: 16.9212, ppl: 1.2251, acc: 0.9485 
epoch correct: 3794 epoch wrong: 206 epoch_num_tokens: 4000 
val --- avg_loss: 17.5059, ppl: 1.2482, acc: 0.9370  
epoch correct: 2811 epoch wrong: 189 epoch_num_tokens: 3000 
update best loss 

epoch: 33 avg_loss: 16.8700, ppl: 1.2244, acc: 0.9457 
epoch correct: 3783 epoch wrong: 217 epoch_num_tokens: 4000 
val --- avg_loss: 17.3187, ppl: 1.2453, acc: 0.9387  
epoch correct: 2816 epoch wrong: 184 epoch_num_tokens: 3000 
update best loss 

epoch: 34 avg_loss: 16.6292, ppl: 1.2209, acc: 0.9457 
epoch correct: 3783 epoch wrong: 217 epoch_num_tokens: 4000 
val --- avg_loss: 17.1244, ppl: 1.2422, acc: 0.9377  
epoch correct: 2813 epoch wrong: 187 epoch_num_tokens: 3000 
update best loss 

epoch: 35 avg_loss: 16.3432, ppl: 1.2167, acc: 0.9493 
epoch correct: 3797 epoch wrong: 203 epoch_num_tokens: 4000 
val --- avg_loss: 16.9237, ppl: 1.2391, acc: 0.9383  
epoch correct: 2815 epoch wrong: 185 epoch_num_tokens: 3000 
update best loss 

epoch: 36 avg_loss: 16.2694, ppl: 1.2156, acc: 0.9513 
epoch correct: 3805 epoch wrong: 195 epoch_num_tokens: 4000 
val --- avg_loss: 16.7608, ppl: 1.2365, acc: 0.9400  
epoch correct: 2820 epoch wrong: 180 epoch_num_tokens: 3000 
update best loss 

epoch: 37 avg_loss: 15.8972, ppl: 1.2102, acc: 0.9530 
epoch correct: 3812 epoch wrong: 188 epoch_num_tokens: 4000 
val --- avg_loss: 16.5764, ppl: 1.2336, acc: 0.9403  
epoch correct: 2821 epoch wrong: 179 epoch_num_tokens: 3000 
update best loss 

epoch: 38 avg_loss: 15.8685, ppl: 1.2098, acc: 0.9505 
epoch correct: 3802 epoch wrong: 198 epoch_num_tokens: 4000 
val --- avg_loss: 16.3984, ppl: 1.2309, acc: 0.9397  
epoch correct: 2819 epoch wrong: 181 epoch_num_tokens: 3000 
update best loss 

epoch: 39 avg_loss: 15.7418, ppl: 1.2079, acc: 0.9527 
epoch correct: 3811 epoch wrong: 189 epoch_num_tokens: 4000 
val --- avg_loss: 16.2394, ppl: 1.2284, acc: 0.9410  
epoch correct: 2823 epoch wrong: 177 epoch_num_tokens: 3000 
update best loss 

epoch: 40 avg_loss: 15.4205, ppl: 1.2033, acc: 0.9525 
epoch correct: 3810 epoch wrong: 190 epoch_num_tokens: 4000 
val --- avg_loss: 16.0729, ppl: 1.2258, acc: 0.9410  
epoch correct: 2823 epoch wrong: 177 epoch_num_tokens: 3000 
update best loss 

epoch: 41 avg_loss: 15.5590, ppl: 1.2053, acc: 0.9500 
epoch correct: 3800 epoch wrong: 200 epoch_num_tokens: 4000 
val --- avg_loss: 15.9899, ppl: 1.2245, acc: 0.9403  
epoch correct: 2821 epoch wrong: 179 epoch_num_tokens: 3000 
update best loss 

epoch: 42 avg_loss: 15.2572, ppl: 1.2009, acc: 0.9540 
epoch correct: 3816 epoch wrong: 184 epoch_num_tokens: 4000 
val --- avg_loss: 15.7851, ppl: 1.2213, acc: 0.9437  
epoch correct: 2831 epoch wrong: 169 epoch_num_tokens: 3000 
update best loss 

epoch: 43 avg_loss: 15.1148, ppl: 1.1989, acc: 0.9513 
epoch correct: 3805 epoch wrong: 195 epoch_num_tokens: 4000 
val --- avg_loss: 15.6634, ppl: 1.2195, acc: 0.9440  
epoch correct: 2832 epoch wrong: 168 epoch_num_tokens: 3000 
update best loss 

epoch: 44 avg_loss: 14.9015, ppl: 1.1958, acc: 0.9557 
epoch correct: 3823 epoch wrong: 177 epoch_num_tokens: 4000 
val --- avg_loss: 15.4937, ppl: 1.2168, acc: 0.9453  
epoch correct: 2836 epoch wrong: 164 epoch_num_tokens: 3000 
update best loss 

epoch: 45 avg_loss: 14.7131, ppl: 1.1931, acc: 0.9560 
epoch correct: 3824 epoch wrong: 176 epoch_num_tokens: 4000 
val --- avg_loss: 15.3631, ppl: 1.2148, acc: 0.9483  
epoch correct: 2845 epoch wrong: 155 epoch_num_tokens: 3000 
update best loss 

epoch: 46 avg_loss: 14.5204, ppl: 1.1903, acc: 0.9555 
epoch correct: 3822 epoch wrong: 178 epoch_num_tokens: 4000 
val --- avg_loss: 15.2307, ppl: 1.2128, acc: 0.9467  
epoch correct: 2840 epoch wrong: 160 epoch_num_tokens: 3000 
update best loss 

epoch: 47 avg_loss: 14.4192, ppl: 1.1889, acc: 0.9555 
epoch correct: 3822 epoch wrong: 178 epoch_num_tokens: 4000 
val --- avg_loss: 15.0987, ppl: 1.2108, acc: 0.9477  
epoch correct: 2843 epoch wrong: 157 epoch_num_tokens: 3000 
update best loss 

epoch: 48 avg_loss: 14.4136, ppl: 1.1888, acc: 0.9577 
epoch correct: 3831 epoch wrong: 169 epoch_num_tokens: 4000 
val --- avg_loss: 15.0229, ppl: 1.2096, acc: 0.9487  
epoch correct: 2846 epoch wrong: 154 epoch_num_tokens: 3000 
update best loss 

epoch: 49 avg_loss: 14.2341, ppl: 1.1863, acc: 0.9580 
epoch correct: 3832 epoch wrong: 168 epoch_num_tokens: 4000 
val --- avg_loss: 14.8896, ppl: 1.2076, acc: 0.9477  
epoch correct: 2843 epoch wrong: 157 epoch_num_tokens: 3000 
update best loss 
