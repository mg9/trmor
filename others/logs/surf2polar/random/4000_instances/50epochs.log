trn -- size:4000,  avg_surf_len: 10.04, avg_feat_len: 10.76, avg_root_len: 3.98 
Pos tag Verb: 0.97, count: 3886
Pos tag Noun: 0.02, count: 78
Pos tag Adj: 0.01, count: 36
Polarity tag Neg: 0.50, count: 2000 
Polarity tag Pos: 0.50, count: 2000 
Tense tag <unk>: 0.44, count: 1759 
Tense tag Past: 0.25, count: 993 
Tense tag Aor: 0.15, count: 599 
Tense tag Prog1: 0.08, count: 333 
Tense tag Narr: 0.04, count: 163 
Tense tag Fut: 0.04, count: 149 
Tense tag Prog2: 0.00, count: 04 
Surfpos tag Verb: 0.68, count: 2701 
Surfpos tag Noun: 0.24, count: 956 
Surfpos tag Adj: 0.09, count: 343 
val -- size:3000,  avg_surf_len: 10.07, avg_feat_len: 10.72, avg_root_len: 3.91 
Pos tag Verb: 0.98, count: 2947
Pos tag Noun: 0.01, count: 30
Pos tag Adj: 0.01, count: 23
Polarity tag Neg: 0.50, count: 1500 
Polarity tag Pos: 0.50, count: 1500 
Tense tag <unk>: 0.47, count: 1423 
Tense tag Past: 0.22, count: 671 
Tense tag Aor: 0.11, count: 326 
Tense tag Prog1: 0.10, count: 313 
Tense tag Narr: 0.05, count: 141 
Tense tag Fut: 0.04, count: 120 
Tense tag Prog2: 0.00, count: 06 
Surfpos tag Verb: 0.64, count: 1907 
Surfpos tag Noun: 0.27, count: 818 
Surfpos tag Adj: 0.09, count: 275 

number of params: 3072 
Namespace(axs=array([<matplotlib.axes._subplots.AxesSubplot object at 0x7f7389020a50>,
       <matplotlib.axes._subplots.AxesSubplot object at 0x7f7381098f10>],
      dtype=object), batchsize=128, bidirectional=False, bmodel='random', clip_grad=5.0, dec_dropout_in=0.0, dec_dropout_out=0.0, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_nh=1024, epochs=50, fig=<Figure size 640x480 with 2 Axes>, fig_path='logs/surf2polar/random/4000_instances/50epochs.png', freeze_decoder=True, freeze_encoder=True, is_clip_grad=False, log_path='logs/surf2polar/random/4000_instances/50epochs.log', logger=<utils.Logger object at 0x7f7380feb390>, lr=0.01, maxtrnsize=57769, maxtstsize=8517, maxvalsize=8329, model=VAE(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): None
  )
  (decoder): None
  (probe_linear): Linear(in_features=1024, out_features=3, bias=False)
  (closs): CrossEntropyLoss()
), modelname='logs/surf2polar/random/4000_instances', ni=512, nz=32, opt='Adam', plt_style='-', reset_decoder=True, reset_encoder=True, save_path='logs/surf2polar/random/4000_instances/50epochs.pt', seq_to_no_pad='surface', surface_vocab_file='trmor_data/surf/surf.uniquesurfs.trn.txt', task='surf2polar', trndata='trmor_data/polar/polar.uniquesurfs.trn.txt', trnsize=4000, tstsize=0, valdata='trmor_data/polar/polar.uniquesurfs.val.txt', valsize=3000)

encoder.embed.weight, torch.Size([39, 512]): False
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): False
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): False
encoder.lstm.bias_ih_l0, torch.Size([4096]): False
encoder.lstm.bias_hh_l0, torch.Size([4096]): False
probe_linear.weight, torch.Size([3, 1024]): True
epoch: 0 avg_loss: 74.6665, ppl: 2.4498, acc: 0.4973 
epoch correct: 1989 epoch wrong: 2011 epoch_num_tokens: 4000 
val --- avg_loss: 61.7989, ppl: 2.1876, acc: 0.5000  
epoch correct: 1500 epoch wrong: 1500 epoch_num_tokens: 3000 
update best loss 

epoch: 1 avg_loss: 63.2524, ppl: 2.1362, acc: 0.4338 
epoch correct: 1735 epoch wrong: 2265 epoch_num_tokens: 4000 
val --- avg_loss: 57.6864, ppl: 2.0765, acc: 0.5763  
epoch correct: 1729 epoch wrong: 1271 epoch_num_tokens: 3000 
update best loss 

epoch: 2 avg_loss: 61.0476, ppl: 2.0804, acc: 0.4380 
epoch correct: 1752 epoch wrong: 2248 epoch_num_tokens: 4000 
val --- avg_loss: 56.3471, ppl: 2.0416, acc: 0.5040  
epoch correct: 1512 epoch wrong: 1488 epoch_num_tokens: 3000 
update best loss 

epoch: 3 avg_loss: 59.3452, ppl: 2.0384, acc: 0.5225 
epoch correct: 2090 epoch wrong: 1910 epoch_num_tokens: 4000 
val --- avg_loss: 55.6045, ppl: 2.0225, acc: 0.5707  
epoch correct: 1712 epoch wrong: 1288 epoch_num_tokens: 3000 
update best loss 

epoch: 4 avg_loss: 59.8687, ppl: 2.0512, acc: 0.5245 
epoch correct: 2098 epoch wrong: 1902 epoch_num_tokens: 4000 
val --- avg_loss: 55.1626, ppl: 2.0112, acc: 0.5673  
epoch correct: 1702 epoch wrong: 1298 epoch_num_tokens: 3000 
update best loss 

epoch: 5 avg_loss: 58.3499, ppl: 2.0142, acc: 0.5258 
epoch correct: 2103 epoch wrong: 1897 epoch_num_tokens: 4000 
val --- avg_loss: 54.9697, ppl: 2.0063, acc: 0.5430  
epoch correct: 1629 epoch wrong: 1371 epoch_num_tokens: 3000 
update best loss 

epoch: 6 avg_loss: 57.9399, ppl: 2.0043, acc: 0.5068 
epoch correct: 2027 epoch wrong: 1973 epoch_num_tokens: 4000 
val --- avg_loss: 54.6781, ppl: 1.9989, acc: 0.5880  
epoch correct: 1764 epoch wrong: 1236 epoch_num_tokens: 3000 
update best loss 

epoch: 7 avg_loss: 57.1457, ppl: 1.9853, acc: 0.6020 
epoch correct: 2408 epoch wrong: 1592 epoch_num_tokens: 4000 
val --- avg_loss: 54.4414, ppl: 1.9929, acc: 0.5493  
epoch correct: 1648 epoch wrong: 1352 epoch_num_tokens: 3000 
update best loss 

epoch: 8 avg_loss: 57.4608, ppl: 1.9928, acc: 0.5377 
epoch correct: 2151 epoch wrong: 1849 epoch_num_tokens: 4000 
val --- avg_loss: 54.3206, ppl: 1.9899, acc: 0.5390  
epoch correct: 1617 epoch wrong: 1383 epoch_num_tokens: 3000 
update best loss 

epoch: 9 avg_loss: 57.1972, ppl: 1.9865, acc: 0.5825 
epoch correct: 2330 epoch wrong: 1670 epoch_num_tokens: 4000 
val --- avg_loss: 54.1882, ppl: 1.9865, acc: 0.5387  
epoch correct: 1616 epoch wrong: 1384 epoch_num_tokens: 3000 
update best loss 

epoch: 10 avg_loss: 56.8946, ppl: 1.9793, acc: 0.5547 
epoch correct: 2219 epoch wrong: 1781 epoch_num_tokens: 4000 
val --- avg_loss: 54.0318, ppl: 1.9826, acc: 0.5410  
epoch correct: 1623 epoch wrong: 1377 epoch_num_tokens: 3000 
update best loss 

epoch: 11 avg_loss: 56.5368, ppl: 1.9708, acc: 0.5945 
epoch correct: 2378 epoch wrong: 1622 epoch_num_tokens: 4000 
val --- avg_loss: 53.9005, ppl: 1.9793, acc: 0.5890  
epoch correct: 1767 epoch wrong: 1233 epoch_num_tokens: 3000 
update best loss 

epoch: 12 avg_loss: 56.5165, ppl: 1.9703, acc: 0.6095 
epoch correct: 2438 epoch wrong: 1562 epoch_num_tokens: 4000 
val --- avg_loss: 53.8542, ppl: 1.9781, acc: 0.6187  
epoch correct: 1856 epoch wrong: 1144 epoch_num_tokens: 3000 
update best loss 

epoch: 13 avg_loss: 56.9004, ppl: 1.9794, acc: 0.5665 
epoch correct: 2266 epoch wrong: 1734 epoch_num_tokens: 4000 
val --- avg_loss: 53.7213, ppl: 1.9748, acc: 0.5923  
epoch correct: 1777 epoch wrong: 1223 epoch_num_tokens: 3000 
update best loss 

epoch: 14 avg_loss: 55.9956, ppl: 1.9580, acc: 0.6230 
epoch correct: 2492 epoch wrong: 1508 epoch_num_tokens: 4000 
val --- avg_loss: 53.7446, ppl: 1.9754, acc: 0.5433  
epoch correct: 1630 epoch wrong: 1370 epoch_num_tokens: 3000 

epoch: 15 avg_loss: 56.4499, ppl: 1.9687, acc: 0.5847 
epoch correct: 2339 epoch wrong: 1661 epoch_num_tokens: 4000 
val --- avg_loss: 53.5187, ppl: 1.9697, acc: 0.5680  
epoch correct: 1704 epoch wrong: 1296 epoch_num_tokens: 3000 
update best loss 

epoch: 16 avg_loss: 57.9160, ppl: 2.0037, acc: 0.5112 
epoch correct: 2045 epoch wrong: 1955 epoch_num_tokens: 4000 
val --- avg_loss: 53.4675, ppl: 1.9685, acc: 0.5823  
epoch correct: 1747 epoch wrong: 1253 epoch_num_tokens: 3000 
update best loss 

epoch: 17 avg_loss: 55.4752, ppl: 1.9459, acc: 0.6168 
epoch correct: 2467 epoch wrong: 1533 epoch_num_tokens: 4000 
val --- avg_loss: 53.4884, ppl: 1.9690, acc: 0.6133  
epoch correct: 1840 epoch wrong: 1160 epoch_num_tokens: 3000 

epoch: 18 avg_loss: 56.4450, ppl: 1.9686, acc: 0.5780 
epoch correct: 2312 epoch wrong: 1688 epoch_num_tokens: 4000 
val --- avg_loss: 53.3322, ppl: 1.9651, acc: 0.5840  
epoch correct: 1752 epoch wrong: 1248 epoch_num_tokens: 3000 
update best loss 

epoch: 19 avg_loss: 55.3732, ppl: 1.9435, acc: 0.6192 
epoch correct: 2477 epoch wrong: 1523 epoch_num_tokens: 4000 
val --- avg_loss: 53.2593, ppl: 1.9633, acc: 0.5797  
epoch correct: 1739 epoch wrong: 1261 epoch_num_tokens: 3000 
update best loss 

epoch: 20 avg_loss: 56.2678, ppl: 1.9645, acc: 0.5952 
epoch correct: 2381 epoch wrong: 1619 epoch_num_tokens: 4000 
val --- avg_loss: 53.2058, ppl: 1.9620, acc: 0.5743  
epoch correct: 1723 epoch wrong: 1277 epoch_num_tokens: 3000 
update best loss 

epoch: 21 avg_loss: 55.1729, ppl: 1.9388, acc: 0.6220 
epoch correct: 2488 epoch wrong: 1512 epoch_num_tokens: 4000 
val --- avg_loss: 53.3013, ppl: 1.9643, acc: 0.6200  
epoch correct: 1860 epoch wrong: 1140 epoch_num_tokens: 3000 

epoch: 22 avg_loss: 55.1256, ppl: 1.9377, acc: 0.6205 
epoch correct: 2482 epoch wrong: 1518 epoch_num_tokens: 4000 
val --- avg_loss: 53.1805, ppl: 1.9613, acc: 0.5910  
epoch correct: 1773 epoch wrong: 1227 epoch_num_tokens: 3000 
update best loss 

epoch: 23 avg_loss: 54.8104, ppl: 1.9304, acc: 0.6300 
epoch correct: 2520 epoch wrong: 1480 epoch_num_tokens: 4000 
val --- avg_loss: 53.0550, ppl: 1.9582, acc: 0.5830  
epoch correct: 1749 epoch wrong: 1251 epoch_num_tokens: 3000 
update best loss 

epoch: 24 avg_loss: 55.5919, ppl: 1.9486, acc: 0.6015 
epoch correct: 2406 epoch wrong: 1594 epoch_num_tokens: 4000 
val --- avg_loss: 52.9984, ppl: 1.9568, acc: 0.5740  
epoch correct: 1722 epoch wrong: 1278 epoch_num_tokens: 3000 
update best loss 

epoch: 25 avg_loss: 54.6870, ppl: 1.9275, acc: 0.6328 
epoch correct: 2531 epoch wrong: 1469 epoch_num_tokens: 4000 
val --- avg_loss: 52.9901, ppl: 1.9566, acc: 0.5880  
epoch correct: 1764 epoch wrong: 1236 epoch_num_tokens: 3000 
update best loss 

epoch: 26 avg_loss: 55.3359, ppl: 1.9426, acc: 0.6068 
epoch correct: 2427 epoch wrong: 1573 epoch_num_tokens: 4000 
val --- avg_loss: 52.9700, ppl: 1.9561, acc: 0.5947  
epoch correct: 1784 epoch wrong: 1216 epoch_num_tokens: 3000 
update best loss 

epoch: 27 avg_loss: 54.6354, ppl: 1.9263, acc: 0.6195 
epoch correct: 2478 epoch wrong: 1522 epoch_num_tokens: 4000 
val --- avg_loss: 52.8956, ppl: 1.9543, acc: 0.5880  
epoch correct: 1764 epoch wrong: 1236 epoch_num_tokens: 3000 
update best loss 

epoch: 28 avg_loss: 54.4465, ppl: 1.9220, acc: 0.6348 
epoch correct: 2539 epoch wrong: 1461 epoch_num_tokens: 4000 
val --- avg_loss: 52.8547, ppl: 1.9532, acc: 0.5803  
epoch correct: 1741 epoch wrong: 1259 epoch_num_tokens: 3000 
update best loss 

epoch: 29 avg_loss: 54.6153, ppl: 1.9259, acc: 0.6202 
epoch correct: 2481 epoch wrong: 1519 epoch_num_tokens: 4000 
val --- avg_loss: 52.8419, ppl: 1.9529, acc: 0.5923  
epoch correct: 1777 epoch wrong: 1223 epoch_num_tokens: 3000 
update best loss 

epoch: 30 avg_loss: 54.4308, ppl: 1.9216, acc: 0.6255 
epoch correct: 2502 epoch wrong: 1498 epoch_num_tokens: 4000 
val --- avg_loss: 52.7686, ppl: 1.9511, acc: 0.5780  
epoch correct: 1734 epoch wrong: 1266 epoch_num_tokens: 3000 
update best loss 

epoch: 31 avg_loss: 54.4633, ppl: 1.9224, acc: 0.6310 
epoch correct: 2524 epoch wrong: 1476 epoch_num_tokens: 4000 
val --- avg_loss: 52.7366, ppl: 1.9503, acc: 0.5780  
epoch correct: 1734 epoch wrong: 1266 epoch_num_tokens: 3000 
update best loss 

epoch: 32 avg_loss: 54.1688, ppl: 1.9156, acc: 0.6260 
epoch correct: 2504 epoch wrong: 1496 epoch_num_tokens: 4000 
val --- avg_loss: 52.7105, ppl: 1.9497, acc: 0.5857  
epoch correct: 1757 epoch wrong: 1243 epoch_num_tokens: 3000 
update best loss 

epoch: 33 avg_loss: 55.1370, ppl: 1.9380, acc: 0.6075 
epoch correct: 2430 epoch wrong: 1570 epoch_num_tokens: 4000 
val --- avg_loss: 53.1420, ppl: 1.9604, acc: 0.5457  
epoch correct: 1637 epoch wrong: 1363 epoch_num_tokens: 3000 

epoch: 34 avg_loss: 54.7238, ppl: 1.9284, acc: 0.6138 
epoch correct: 2455 epoch wrong: 1545 epoch_num_tokens: 4000 
val --- avg_loss: 52.6391, ppl: 1.9479, acc: 0.5830  
epoch correct: 1749 epoch wrong: 1251 epoch_num_tokens: 3000 
update best loss 

epoch: 35 avg_loss: 54.2600, ppl: 1.9177, acc: 0.6140 
epoch correct: 2456 epoch wrong: 1544 epoch_num_tokens: 4000 
val --- avg_loss: 52.6108, ppl: 1.9472, acc: 0.5840  
epoch correct: 1752 epoch wrong: 1248 epoch_num_tokens: 3000 
update best loss 

epoch: 36 avg_loss: 54.6737, ppl: 1.9272, acc: 0.6045 
epoch correct: 2418 epoch wrong: 1582 epoch_num_tokens: 4000 
val --- avg_loss: 52.5779, ppl: 1.9464, acc: 0.5860  
epoch correct: 1758 epoch wrong: 1242 epoch_num_tokens: 3000 
update best loss 

epoch: 37 avg_loss: 54.1240, ppl: 1.9146, acc: 0.6278 
epoch correct: 2511 epoch wrong: 1489 epoch_num_tokens: 4000 
val --- avg_loss: 52.5646, ppl: 1.9461, acc: 0.5823  
epoch correct: 1747 epoch wrong: 1253 epoch_num_tokens: 3000 
update best loss 

epoch: 38 avg_loss: 54.7743, ppl: 1.9296, acc: 0.6052 
epoch correct: 2421 epoch wrong: 1579 epoch_num_tokens: 4000 
val --- avg_loss: 52.5216, ppl: 1.9450, acc: 0.5867  
epoch correct: 1760 epoch wrong: 1240 epoch_num_tokens: 3000 
update best loss 

epoch: 39 avg_loss: 54.6818, ppl: 1.9274, acc: 0.6100 
epoch correct: 2440 epoch wrong: 1560 epoch_num_tokens: 4000 
val --- avg_loss: 52.4986, ppl: 1.9445, acc: 0.5830  
epoch correct: 1749 epoch wrong: 1251 epoch_num_tokens: 3000 
update best loss 

epoch: 40 avg_loss: 54.0726, ppl: 1.9134, acc: 0.6402 
epoch correct: 2561 epoch wrong: 1439 epoch_num_tokens: 4000 
val --- avg_loss: 52.5501, ppl: 1.9457, acc: 0.5997  
epoch correct: 1799 epoch wrong: 1201 epoch_num_tokens: 3000 

epoch: 41 avg_loss: 56.2646, ppl: 1.9644, acc: 0.5587 
epoch correct: 2235 epoch wrong: 1765 epoch_num_tokens: 4000 
val --- avg_loss: 52.7637, ppl: 1.9510, acc: 0.6267  
epoch correct: 1880 epoch wrong: 1120 epoch_num_tokens: 3000 

epoch: 42 avg_loss: 55.0361, ppl: 1.9356, acc: 0.5960 
epoch correct: 2384 epoch wrong: 1616 epoch_num_tokens: 4000 
val --- avg_loss: 52.4263, ppl: 1.9427, acc: 0.5857  
epoch correct: 1757 epoch wrong: 1243 epoch_num_tokens: 3000 
update best loss 

epoch: 43 avg_loss: 54.3950, ppl: 1.9208, acc: 0.6255 
epoch correct: 2502 epoch wrong: 1498 epoch_num_tokens: 4000 
val --- avg_loss: 52.5154, ppl: 1.9449, acc: 0.5643  
epoch correct: 1693 epoch wrong: 1307 epoch_num_tokens: 3000 

epoch: 44 avg_loss: 53.9919, ppl: 1.9115, acc: 0.6085 
epoch correct: 2434 epoch wrong: 1566 epoch_num_tokens: 4000 
val --- avg_loss: 52.4056, ppl: 1.9422, acc: 0.5920  
epoch correct: 1776 epoch wrong: 1224 epoch_num_tokens: 3000 
update best loss 

epoch: 45 avg_loss: 53.8621, ppl: 1.9086, acc: 0.6208 
epoch correct: 2483 epoch wrong: 1517 epoch_num_tokens: 4000 
val --- avg_loss: 52.3616, ppl: 1.9411, acc: 0.5873  
epoch correct: 1762 epoch wrong: 1238 epoch_num_tokens: 3000 
update best loss 

epoch: 46 avg_loss: 53.6984, ppl: 1.9048, acc: 0.6332 
epoch correct: 2533 epoch wrong: 1467 epoch_num_tokens: 4000 
val --- avg_loss: 52.4180, ppl: 1.9425, acc: 0.5683  
epoch correct: 1705 epoch wrong: 1295 epoch_num_tokens: 3000 

epoch: 47 avg_loss: 53.7820, ppl: 1.9067, acc: 0.6282 
epoch correct: 2513 epoch wrong: 1487 epoch_num_tokens: 4000 
val --- avg_loss: 52.3305, ppl: 1.9403, acc: 0.5870  
epoch correct: 1761 epoch wrong: 1239 epoch_num_tokens: 3000 
update best loss 

epoch: 48 avg_loss: 53.4616, ppl: 1.8994, acc: 0.6175 
epoch correct: 2470 epoch wrong: 1530 epoch_num_tokens: 4000 
val --- avg_loss: 52.5571, ppl: 1.9459, acc: 0.5513  
epoch correct: 1654 epoch wrong: 1346 epoch_num_tokens: 3000 

epoch: 49 avg_loss: 53.8824, ppl: 1.9090, acc: 0.6192 
epoch correct: 2477 epoch wrong: 1523 epoch_num_tokens: 4000 
val --- avg_loss: 52.4087, ppl: 1.9422, acc: 0.5967  
epoch correct: 1790 epoch wrong: 1210 epoch_num_tokens: 3000 
