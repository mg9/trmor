VQVAE_2(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 512, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
  )
  (decoder): LSTMDecoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (dropout_out): Dropout(p=0.0, inplace=False)
    (lstm): LSTM(1024, 512, batch_first=True)
    (pred_linear): Linear(in_features=512, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
  (multi_vq_layer): MultiVectorQuantizer(
    (embedding_1): Embedding(6, 128)
    (embedding_2): Embedding(6, 128)
    (embedding_3): Embedding(6, 128)
    (embedding_4): Embedding(6, 128)
  )
)beta:0.25
----- Parameters: -----
encoder.embed.weight, torch.Size([39, 512]): True
encoder.lstm.weight_ih_l0, torch.Size([2048, 512]): True
encoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0, torch.Size([2048]): True
encoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.embed.weight, torch.Size([39, 512]): True
decoder.lstm.weight_ih_l0, torch.Size([2048, 1024]): True
decoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
decoder.lstm.bias_ih_l0, torch.Size([2048]): True
decoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.pred_linear.weight, torch.Size([39, 512]): True
multi_vq_layer.embedding_1.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_2.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_3.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_4.weight, torch.Size([6, 128]): True
Epoch 0, ppl: 1.0902,  recon_loss: 34.3716, vq_loss: 0.0283, acc: 0.1014
val -- ppl: 1.0342,  recon_loss: 35.8952, vq_loss: 0.0141, acc: 0.0907 
update best loss
Epoch 1, ppl: 1.0785,  recon_loss: 30.1054, vq_loss: 0.3865, acc: 0.1027
val -- ppl: 1.0335,  recon_loss: 35.1664, vq_loss: 0.0427, acc: 0.1222 
update best loss
Epoch 2, ppl: 1.0776,  recon_loss: 29.7537, vq_loss: 0.0171, acc: 0.1363
val -- ppl: 1.0332,  recon_loss: 34.8716, vq_loss: 0.0148, acc: 0.1045 
update best loss
Epoch 3, ppl: 1.0765,  recon_loss: 29.3449, vq_loss: 0.0155, acc: 0.1199
val -- ppl: 1.0332,  recon_loss: 34.8185, vq_loss: 0.0165, acc: 0.0854 
update best loss
Epoch 4, ppl: 1.0759,  recon_loss: 29.1242, vq_loss: 0.0388, acc: 0.1443
val -- ppl: 1.0327,  recon_loss: 34.3179, vq_loss: 0.0748, acc: 0.1737 
update best loss
Epoch 5, ppl: 1.0749,  recon_loss: 28.7610, vq_loss: 0.5238, acc: 0.1775
val -- ppl: 1.0322,  recon_loss: 33.8512, vq_loss: 1.1767, acc: 0.1669 
update best loss
Epoch 6, ppl: 1.0734,  recon_loss: 28.2101, vq_loss: 1.3215, acc: 0.1484
val -- ppl: 1.0316,  recon_loss: 33.2095, vq_loss: 1.5190, acc: 0.1696 
update best loss
Epoch 7, ppl: 1.0710,  recon_loss: 27.3174, vq_loss: 1.4017, acc: 0.1715
val -- ppl: 1.0306,  recon_loss: 32.1193, vq_loss: 1.7382, acc: 0.1699 
update best loss
Epoch 8, ppl: 1.0685,  recon_loss: 26.3699, vq_loss: 1.7658, acc: 0.1948
val -- ppl: 1.0294,  recon_loss: 30.9541, vq_loss: 2.3433, acc: 0.1953 
update best loss
Epoch 9, ppl: 1.0659,  recon_loss: 25.4256, vq_loss: 1.7209, acc: 0.1744
val -- ppl: 1.0288,  recon_loss: 30.2373, vq_loss: 0.7604, acc: 0.2031 
update best loss