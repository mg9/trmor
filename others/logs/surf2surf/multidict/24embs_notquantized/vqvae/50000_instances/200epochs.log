VQVAE_2(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 512, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
  )
  (decoder): LSTMDecoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (dropout_out): Dropout(p=0.0, inplace=False)
    (lstm): LSTM(1024, 512, batch_first=True)
    (pred_linear): Linear(in_features=512, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
  (multi_vq_layer): MultiVectorQuantizer(
    (embedding_1): Embedding(6, 128)
    (embedding_2): Embedding(6, 128)
    (embedding_3): Embedding(6, 128)
    (embedding_4): Embedding(6, 128)
  )
)beta:0.25
----- Parameters: -----
encoder.embed.weight, torch.Size([39, 512]): True
encoder.lstm.weight_ih_l0, torch.Size([2048, 512]): True
encoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0, torch.Size([2048]): True
encoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.embed.weight, torch.Size([39, 512]): True
decoder.lstm.weight_ih_l0, torch.Size([2048, 1024]): True
decoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
decoder.lstm.bias_ih_l0, torch.Size([2048]): True
decoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.pred_linear.weight, torch.Size([39, 512]): True
multi_vq_layer.embedding_1.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_2.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_3.weight, torch.Size([6, 128]): True
multi_vq_layer.embedding_4.weight, torch.Size([6, 128]): True
Epoch 0, ppl: 1.0180,  recon_loss: 22.5785, vq_loss: 0.3865, acc: 0.3390
val -- ppl: 1.0185,  recon_loss: 19.5148, vq_loss: 0.4797, acc: 0.4766 
update best loss
Epoch 1, ppl: 1.0107,  recon_loss: 13.5021, vq_loss: 0.4612, acc: 0.6074
val -- ppl: 1.0091,  recon_loss: 9.6318, vq_loss: 0.5788, acc: 0.7656 
update best loss
Epoch 2, ppl: 1.0036,  recon_loss: 4.4989, vq_loss: 0.5839, acc: 0.8819
val -- ppl: 1.0076,  recon_loss: 8.0989, vq_loss: 0.6200, acc: 0.8187 
update best loss
Epoch 3, ppl: 1.0013,  recon_loss: 1.6355, vq_loss: 0.6187, acc: 0.9619
val -- ppl: 1.0011,  recon_loss: 1.1562, vq_loss: 0.6253, acc: 0.9823 
update best loss
Epoch 4, ppl: 1.0006,  recon_loss: 0.7191, vq_loss: 0.6185, acc: 0.9853
val -- ppl: 1.0008,  recon_loss: 0.8039, vq_loss: 0.6137, acc: 0.9883 
update best loss
Epoch 5, ppl: 1.0003,  recon_loss: 0.3982, vq_loss: 0.6228, acc: 0.9924
val -- ppl: 1.0011,  recon_loss: 1.1621, vq_loss: 0.6179, acc: 0.9746 