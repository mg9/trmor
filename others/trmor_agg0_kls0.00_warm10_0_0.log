using cuda
Namespace(aggressive=0, batch_size=128, cuda=True, dataset='trmor', dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, dec_type='lstm', decode_from='', decode_input='', decoding_strategy='greedy', enc_nh=1024, enc_type='lstm', epochs=10, eval=False, iw_nsamples=500, jobid=0, kl_start=0.0, label=False, load_path='', log_path='logs/trmor/trmor_agg0_kls0.00_warm10_0_0.log', momentum=0, ni=512, nsamples=1, nz=32, save_path='models/trmor/trmor_agg0_kls0.00_warm10_0_0.pt', seed=1, taskid=0, test_data='datasets/trmor_data/surf.uniquesurfs.tst.txt', test_nepoch=5, train_data='datasets/trmor_data/surf.uniquesurfs.trn.txt', val_data='datasets/trmor_data/surf.uniquesurfs.val.txt', warm_up=10)
Train data: 50000 samples
finish reading datasets, vocab size is 39
dropped sentences: 0
VAE(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (linear): Linear(in_features=1024, out_features=64, bias=False)
  )
  (decoder): LSTMDecoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
)
epoch: 0, iter: 0, avg_loss: 51.2868, kl: 0.0000, mi: 0.1157, recon: 51.2867, au 0, time elapsed 0.86s, acc:  0.0329
epoch: 0, iter: 39, avg_loss: 33.4129, kl: 0.0000, mi: -0.0437, recon: 33.4129, au 0, time elapsed 2.73s, acc:  0.1306
epoch: 0, iter: 78, avg_loss: 29.1455, kl: 0.0000, mi: -0.0142, recon: 29.1455, au 0, time elapsed 4.58s, acc:  0.2020
epoch: 0, iter: 117, avg_loss: 25.2191, kl: 0.0000, mi: 0.0126, recon: 25.2191, au 0, time elapsed 6.39s, acc:  0.2575
epoch: 0, iter: 156, avg_loss: 23.7141, kl: 0.0000, mi: -0.0214, recon: 23.7141, au 0, time elapsed 8.15s, acc:  0.2649
epoch: 0, iter: 195, avg_loss: 23.8643, kl: 0.0000, mi: 0.0364, recon: 23.8643, au 0, time elapsed 9.97s, acc:  0.2888
epoch: 0, iter: 234, avg_loss: 23.1764, kl: 0.0000, mi: -0.0516, recon: 23.1764, au 0, time elapsed 11.81s, acc:  0.3010
epoch: 0, iter: 273, avg_loss: 21.2189, kl: 0.0000, mi: 0.0126, recon: 21.2189, au 0, time elapsed 13.62s, acc:  0.3159
epoch: 0, iter: 312, avg_loss: 21.2257, kl: 0.0000, mi: 0.0416, recon: 21.2257, au 0, time elapsed 15.42s, acc:  0.3138
epoch: 0, iter: 351, avg_loss: 21.6703, kl: 0.0000, mi: -0.0429, recon: 21.6702, au 0, time elapsed 17.27s, acc:  0.3258
epoch: 0, iter: 390, avg_loss: 20.9362, kl: 0.0000, mi: -0.0210, recon: 20.9362, au 0, time elapsed 19.12s, acc:  0.3398
train acc: 0.2745
kl weight 0.0000
VAL --- avg_loss: 22.3545, kl: 0.0001, mi: 0.0744, recon: 22.3544, nll: 22.3544, ppl: 7.7981, acc: 0.3320
0 active units
update best loss
saved model
epoch: 1, iter: 429, avg_loss: 19.6467, kl: 0.0001, recon: 19.6466, time elapsed 21.42s, acc:  0.3273
epoch: 1, iter: 468, avg_loss: 21.2439, kl: 0.0009, recon: 21.2430, time elapsed 22.70s, acc:  0.3609
epoch: 1, iter: 507, avg_loss: 21.1560, kl: 0.3319, recon: 20.8241, time elapsed 23.85s, acc:  0.3382
epoch: 1, iter: 546, avg_loss: 20.5865, kl: 0.0153, recon: 20.5712, time elapsed 25.02s, acc:  0.3455
epoch: 1, iter: 585, avg_loss: 20.9647, kl: 0.4402, recon: 20.5244, time elapsed 26.29s, acc:  0.3784
epoch: 1, iter: 624, avg_loss: 20.4870, kl: 0.4708, recon: 20.0161, time elapsed 27.48s, acc:  0.3610
epoch: 1, iter: 663, avg_loss: 20.2577, kl: 0.8450, recon: 19.4127, time elapsed 28.67s, acc:  0.3813
epoch: 1, iter: 702, avg_loss: 20.2981, kl: 1.0035, recon: 19.2946, time elapsed 29.89s, acc:  0.3720
epoch: 1, iter: 741, avg_loss: 20.8328, kl: 0.9115, recon: 19.9212, time elapsed 31.20s, acc:  0.4061
epoch: 1, iter: 780, avg_loss: 20.1318, kl: 0.9820, recon: 19.1497, time elapsed 32.41s, acc:  0.3892
train acc: 0.3705
kl weight 0.0000
VAL --- avg_loss: 21.0040, kl: 0.9512, mi: 0.4370, recon: 20.0528, nll: 20.0528, ppl: 6.3117, acc: 0.4112
20 active units
update best loss
saved model
epoch: 2, iter: 819, avg_loss: 20.1069, kl: 0.9316, recon: 19.1752, time elapsed 34.82s, acc:  0.4215
epoch: 2, iter: 858, avg_loss: 20.0649, kl: 1.2148, recon: 18.8502, time elapsed 36.01s, acc:  0.3920
epoch: 2, iter: 897, avg_loss: 21.3752, kl: 1.4855, recon: 19.8897, time elapsed 37.34s, acc:  0.4233
epoch: 2, iter: 936, avg_loss: 20.0635, kl: 2.0070, recon: 18.0565, time elapsed 38.56s, acc:  0.4299
epoch: 2, iter: 975, avg_loss: 20.2330, kl: 2.2651, recon: 17.9679, time elapsed 39.81s, acc:  0.4314
epoch: 2, iter: 1014, avg_loss: 19.6311, kl: 2.4663, recon: 17.1647, time elapsed 40.97s, acc:  0.4143
epoch: 2, iter: 1053, avg_loss: 20.4050, kl: 2.8861, recon: 17.5189, time elapsed 42.19s, acc:  0.4458
epoch: 2, iter: 1092, avg_loss: 20.1261, kl: 2.9333, recon: 17.1928, time elapsed 43.37s, acc:  0.4419
epoch: 2, iter: 1131, avg_loss: 20.0430, kl: 3.5940, recon: 16.4490, time elapsed 44.53s, acc:  0.4472
epoch: 2, iter: 1170, avg_loss: 21.1167, kl: 3.7184, recon: 17.3983, time elapsed 45.83s, acc:  0.4733
epoch: 2, iter: 1209, avg_loss: 21.0981, kl: 4.0163, recon: 17.0818, time elapsed 47.11s, acc:  0.4775
train acc: 0.4384
kl weight 0.0000
VAL --- avg_loss: 22.1467, kl: 3.5040, mi: 1.5909, recon: 18.6427, nll: 18.6427, ppl: 5.5448, acc: 0.4494
32 active units
saved model
epoch: 3, iter: 1248, avg_loss: 21.0771, kl: 4.7501, recon: 16.3270, time elapsed 49.65s, acc:  0.5038
epoch: 3, iter: 1287, avg_loss: 21.3363, kl: 5.0248, recon: 16.3115, time elapsed 50.91s, acc:  0.4998
epoch: 3, iter: 1326, avg_loss: 20.9775, kl: 5.7554, recon: 15.2221, time elapsed 52.13s, acc:  0.5043
epoch: 3, iter: 1365, avg_loss: 22.3442, kl: 5.3103, recon: 17.0339, time elapsed 53.45s, acc:  0.4930
epoch: 3, iter: 1404, avg_loss: 20.2959, kl: 5.8801, recon: 14.4158, time elapsed 54.62s, acc:  0.5103
epoch: 3, iter: 1443, avg_loss: 21.6385, kl: 6.4215, recon: 15.2170, time elapsed 55.88s, acc:  0.5203
epoch: 3, iter: 1482, avg_loss: 21.1169, kl: 6.6735, recon: 14.4434, time elapsed 57.08s, acc:  0.5356
epoch: 3, iter: 1521, avg_loss: 20.8005, kl: 6.6145, recon: 14.1860, time elapsed 58.28s, acc:  0.5546
epoch: 3, iter: 1560, avg_loss: 21.2042, kl: 6.7526, recon: 14.4516, time elapsed 59.61s, acc:  0.5643
epoch: 3, iter: 1599, avg_loss: 23.0179, kl: 8.2016, recon: 14.8163, time elapsed 60.90s, acc:  0.5509
train acc: 0.5251
kl weight 0.0000
VAL --- avg_loss: 23.3764, kl: 10.5365, mi: 3.7164, recon: 12.8399, nll: 12.8399, ppl: 3.2534, acc: 0.6148
32 active units
saved model
epoch: 4, iter: 1638, avg_loss: 22.1647, kl: 9.1530, recon: 13.0118, time elapsed 63.22s, acc:  0.5651
epoch: 4, iter: 1677, avg_loss: 21.8986, kl: 9.0897, recon: 12.8089, time elapsed 64.48s, acc:  0.5940
epoch: 4, iter: 1716, avg_loss: 21.5357, kl: 9.6653, recon: 11.8704, time elapsed 65.67s, acc:  0.6043
epoch: 4, iter: 1755, avg_loss: 24.2690, kl: 11.6965, recon: 12.5725, time elapsed 66.88s, acc:  0.5887
epoch: 4, iter: 1794, avg_loss: 23.3058, kl: 11.2886, recon: 12.0172, time elapsed 68.14s, acc:  0.6237
epoch: 4, iter: 1833, avg_loss: 25.5210, kl: 12.1926, recon: 13.3285, time elapsed 69.52s, acc:  0.6291
epoch: 4, iter: 1872, avg_loss: 23.6313, kl: 12.8124, recon: 10.8190, time elapsed 70.78s, acc:  0.6538
epoch: 4, iter: 1911, avg_loss: 24.0787, kl: 13.4178, recon: 10.6608, time elapsed 71.98s, acc:  0.6442
epoch: 4, iter: 1950, avg_loss: 24.3284, kl: 13.1562, recon: 11.1723, time elapsed 73.36s, acc:  0.6848
epoch: 4, iter: 1989, avg_loss: 25.8644, kl: 14.6594, recon: 11.2049, time elapsed 74.62s, acc:  0.6560
train acc: 0.6346
kl weight 0.0000
VAL --- avg_loss: 23.1890, kl: 14.1625, mi: 4.3238, recon: 9.0265, nll: 9.0265, ppl: 2.2918, acc: 0.7323
32 active units
saved model
epoch: 5, iter: 2028, avg_loss: 23.8613, kl: 15.3379, recon: 8.5234, time elapsed 77.67s, acc:  0.7253
epoch: 5, iter: 2067, avg_loss: 25.2267, kl: 16.1349, recon: 9.0918, time elapsed 78.88s, acc:  0.7084
epoch: 5, iter: 2106, avg_loss: 25.3189, kl: 16.1553, recon: 9.1636, time elapsed 80.19s, acc:  0.7222
epoch: 5, iter: 2145, avg_loss: 24.8681, kl: 16.3302, recon: 8.5379, time elapsed 81.49s, acc:  0.7375
epoch: 5, iter: 2184, avg_loss: 25.4424, kl: 16.8536, recon: 8.5888, time elapsed 82.72s, acc:  0.7325
epoch: 5, iter: 2223, avg_loss: 25.7101, kl: 17.3503, recon: 8.3598, time elapsed 84.01s, acc:  0.7478
epoch: 5, iter: 2262, avg_loss: 25.0388, kl: 17.9440, recon: 7.0948, time elapsed 85.26s, acc:  0.7724
epoch: 5, iter: 2301, avg_loss: 26.3951, kl: 18.8872, recon: 7.5078, time elapsed 86.51s, acc:  0.7615
epoch: 5, iter: 2340, avg_loss: 26.8064, kl: 18.9465, recon: 7.8600, time elapsed 87.79s, acc:  0.7584
epoch: 5, iter: 2379, avg_loss: 25.6701, kl: 19.2048, recon: 6.4653, time elapsed 89.06s, acc:  0.7925
epoch: 5, iter: 2418, avg_loss: 25.5233, kl: 19.1353, recon: 6.3880, time elapsed 90.41s, acc:  0.8053
train acc: 0.7532
kl weight 0.0000
VAL --- avg_loss: 27.5361, kl: 18.7461, mi: 4.6325, recon: 8.7900, nll: 8.7900, ppl: 2.2425, acc: 0.7471
32 active units
saved model
epoch: 6, iter: 2457, avg_loss: 26.7596, kl: 20.0218, recon: 6.7378, time elapsed 92.82s, acc:  0.7848
epoch: 6, iter: 2496, avg_loss: 28.7465, kl: 22.0560, recon: 6.6905, time elapsed 94.11s, acc:  0.7974
epoch: 6, iter: 2535, avg_loss: 27.4690, kl: 21.3493, recon: 6.1197, time elapsed 95.39s, acc:  0.8127
epoch: 6, iter: 2574, avg_loss: 27.4456, kl: 21.0598, recon: 6.3858, time elapsed 96.59s, acc:  0.7998
epoch: 6, iter: 2613, avg_loss: 26.3227, kl: 21.3041, recon: 5.0187, time elapsed 97.84s, acc:  0.8326
epoch: 6, iter: 2652, avg_loss: 27.3238, kl: 21.0381, recon: 6.2857, time elapsed 99.19s, acc:  0.8174
epoch: 6, iter: 2691, avg_loss: 26.0337, kl: 21.2962, recon: 4.7375, time elapsed 100.47s, acc:  0.8470
epoch: 6, iter: 2730, avg_loss: 26.9060, kl: 22.0658, recon: 4.8403, time elapsed 101.71s, acc:  0.8407
epoch: 6, iter: 2769, avg_loss: 26.3955, kl: 22.1540, recon: 4.2415, time elapsed 103.00s, acc:  0.8632
epoch: 6, iter: 2808, avg_loss: 28.3781, kl: 22.5204, recon: 5.8577, time elapsed 104.31s, acc:  0.8325
train acc: 0.8255
kl weight 0.0000
VAL --- avg_loss: 27.2386, kl: 23.3783, mi: 4.6691, recon: 3.8603, nll: 3.8603, ppl: 1.4257, acc: 0.8855
32 active units
saved model
epoch: 7, iter: 2847, avg_loss: 27.0085, kl: 23.0103, recon: 3.9982, time elapsed 106.79s, acc:  0.8762
epoch: 7, iter: 2886, avg_loss: 27.3218, kl: 23.8166, recon: 3.5052, time elapsed 108.04s, acc:  0.8837
epoch: 7, iter: 2925, avg_loss: 28.6771, kl: 23.8811, recon: 4.7960, time elapsed 109.30s, acc:  0.8569
epoch: 7, iter: 2964, avg_loss: 28.2545, kl: 23.9217, recon: 4.3328, time elapsed 110.64s, acc:  0.8700
epoch: 7, iter: 3003, avg_loss: 28.6740, kl: 24.8743, recon: 3.7996, time elapsed 111.92s, acc:  0.8810
epoch: 7, iter: 3042, avg_loss: 30.4387, kl: 25.9675, recon: 4.4711, time elapsed 113.19s, acc:  0.8628
epoch: 7, iter: 3081, avg_loss: 28.3837, kl: 24.7164, recon: 3.6673, time elapsed 114.51s, acc:  0.8879
epoch: 7, iter: 3120, avg_loss: 28.1449, kl: 24.2995, recon: 3.8454, time elapsed 115.80s, acc:  0.8853
epoch: 7, iter: 3159, avg_loss: 28.0074, kl: 24.9147, recon: 3.0928, time elapsed 117.03s, acc:  0.9011
epoch: 7, iter: 3198, avg_loss: 27.1304, kl: 24.3781, recon: 2.7523, time elapsed 118.31s, acc:  0.9130
train acc: 0.8850
kl weight 0.0000
VAL --- avg_loss: 23.7580, kl: 21.5863, mi: 4.6869, recon: 2.1717, nll: 2.1717, ppl: 1.2208, acc: 0.9384
32 active units
saved model
epoch: 8, iter: 3237, avg_loss: 25.5635, kl: 23.6168, recon: 1.9467, time elapsed 120.87s, acc:  0.9367
epoch: 8, iter: 3276, avg_loss: 26.5078, kl: 23.8116, recon: 2.6962, time elapsed 122.16s, acc:  0.9215
epoch: 8, iter: 3315, avg_loss: 28.4170, kl: 25.2348, recon: 3.1822, time elapsed 123.41s, acc:  0.9019
epoch: 8, iter: 3354, avg_loss: 28.6677, kl: 25.5529, recon: 3.1148, time elapsed 124.79s, acc:  0.9095
epoch: 8, iter: 3393, avg_loss: 28.4596, kl: 26.3430, recon: 2.1167, time elapsed 126.08s, acc:  0.9335
epoch: 8, iter: 3432, avg_loss: 28.3613, kl: 26.0685, recon: 2.2928, time elapsed 127.36s, acc:  0.9275
epoch: 8, iter: 3471, avg_loss: 29.9411, kl: 26.3612, recon: 3.5799, time elapsed 128.56s, acc:  0.8939
epoch: 8, iter: 3510, avg_loss: 30.1424, kl: 27.8810, recon: 2.2614, time elapsed 129.79s, acc:  0.9254
epoch: 8, iter: 3549, avg_loss: 28.8450, kl: 26.0915, recon: 2.7536, time elapsed 131.08s, acc:  0.9185
epoch: 8, iter: 3588, avg_loss: 28.3764, kl: 25.7225, recon: 2.6539, time elapsed 132.42s, acc:  0.9220
epoch: 8, iter: 3627, avg_loss: 26.6372, kl: 25.1146, recon: 1.5226, time elapsed 133.71s, acc:  0.9515
train acc: 0.9216
kl weight 0.0000
VAL --- avg_loss: 26.5421, kl: 24.7067, mi: 4.6863, recon: 1.8354, nll: 1.8354, ppl: 1.1837, acc: 0.9488
32 active units
saved model
epoch: 9, iter: 3666, avg_loss: 28.9267, kl: 26.7525, recon: 2.1742, time elapsed 136.15s, acc:  0.9346
epoch: 9, iter: 3705, avg_loss: 27.8091, kl: 25.9088, recon: 1.9003, time elapsed 137.36s, acc:  0.9383
epoch: 9, iter: 3744, avg_loss: 28.1046, kl: 25.8644, recon: 2.2402, time elapsed 138.64s, acc:  0.9331
epoch: 9, iter: 3783, avg_loss: 27.2575, kl: 25.2264, recon: 2.0312, time elapsed 139.94s, acc:  0.9383
epoch: 9, iter: 3822, avg_loss: 29.4454, kl: 26.6639, recon: 2.7815, time elapsed 141.23s, acc:  0.9208
epoch: 9, iter: 3861, avg_loss: 27.2297, kl: 25.6795, recon: 1.5502, time elapsed 142.54s, acc:  0.9515
epoch: 9, iter: 3900, avg_loss: 26.8732, kl: 25.1355, recon: 1.7377, time elapsed 143.91s, acc:  0.9483
epoch: 9, iter: 3939, avg_loss: 28.6566, kl: 26.6061, recon: 2.0505, time elapsed 145.20s, acc:  0.9365
epoch: 9, iter: 3978, avg_loss: 28.3668, kl: 25.6816, recon: 2.6852, time elapsed 146.57s, acc:  0.9261
epoch: 9, iter: 4017, avg_loss: 28.5817, kl: 27.2425, recon: 1.3391, time elapsed 147.74s, acc:  0.9562
train acc: 0.9389
kl weight 0.0000
VAL --- avg_loss: 26.9372, kl: 25.5667, mi: 4.6234, recon: 1.3704, nll: 1.3704, ppl: 1.1342, acc: 0.9613
32 active units
saved model
