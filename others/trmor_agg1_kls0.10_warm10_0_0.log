using cuda
Namespace(aggressive=1, batch_size=128, cuda=True, dataset='trmor', dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, dec_type='lstm', decode_from='', decode_input='', decoding_strategy='greedy', enc_nh=1024, enc_type='lstm', epochs=10, eval=False, iw_nsamples=500, jobid=0, kl_start=0.1, label=False, load_path='', log_path='logs/trmor/trmor_agg1_kls0.10_warm10_0_0.log', momentum=0, ni=512, nsamples=1, nz=32, save_path='models/trmor/trmor_agg1_kls0.10_warm10_0_0.pt', seed=1, taskid=0, test_data='datasets/trmor_data/surf.uniquesurfs.tst.txt', test_nepoch=5, train_data='datasets/trmor_data/surf.uniquesurfs.trn.txt', val_data='datasets/trmor_data/surf.uniquesurfs.val.txt', warm_up=10)
Train data: 50000 samples
finish reading datasets, vocab size is 39
dropped sentences: 0
VAE(
  (encoder): LSTMEncoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (linear): Linear(in_features=1024, out_features=64, bias=False)
  )
  (decoder): LSTMDecoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
)
epoch: 0, iter: 0, avg_loss: 51.2880, kl: 0.0001, mi: -0.0403, recon: 51.2879, au 0, time elapsed 2.79s, acc:  0.0223
epoch: 0, iter: 39, avg_loss: 41.9750, kl: 10.8502, mi: 4.2795, recon: 31.1248, au 32, time elapsed 87.16s, acc:  0.1882
epoch: 0, iter: 78, avg_loss: 43.7849, kl: 22.1103, mi: 4.8115, recon: 21.6746, au 32, time elapsed 176.60s, acc:  0.3790
epoch: 0, iter: 117, avg_loss: 43.7739, kl: 27.7130, mi: 4.6961, recon: 16.0609, au 32, time elapsed 267.21s, acc:  0.4981
epoch: 0, iter: 156, avg_loss: 41.8621, kl: 30.4005, mi: 4.7176, recon: 11.4616, au 32, time elapsed 346.27s, acc:  0.6213
epoch: 0, iter: 195, avg_loss: 43.9531, kl: 34.2055, mi: 4.7337, recon: 9.7476, au 32, time elapsed 422.43s, acc:  0.6986
epoch: 0, iter: 234, avg_loss: 42.1833, kl: 34.9194, mi: 4.7327, recon: 7.2639, au 32, time elapsed 494.28s, acc:  0.7743
epoch: 0, iter: 273, avg_loss: 40.2144, kl: 35.3977, mi: 4.7176, recon: 4.8167, au 32, time elapsed 559.77s, acc:  0.8395
epoch: 0, iter: 312, avg_loss: 37.7804, kl: 33.5720, mi: 4.6667, recon: 4.2084, au 32, time elapsed 621.90s, acc:  0.8622
epoch: 0, iter: 351, avg_loss: 36.8646, kl: 32.7247, mi: 4.6694, recon: 4.1399, au 32, time elapsed 688.10s, acc:  0.8698
epoch: 0, iter: 390, avg_loss: 36.3545, kl: 32.3745, mi: 4.6241, recon: 3.9799, au 32, time elapsed 747.80s, acc:  0.8728
pre mi:0.0000. cur mi:4.6361
train acc: 0.6629
kl weight 0.1931
VAL --- avg_loss: 36.0963, kl: 32.6663, mi: 4.8040, recon: 3.4301, nll: 3.4301, ppl: 1.3705, acc: 0.8988
32 active units
update best loss
saved model
epoch: 1, iter: 429, avg_loss: 34.2676, kl: 30.9466, mi: 4.6981, recon: 3.3210, au 32, time elapsed 809.52s, acc:  0.8888
epoch: 1, iter: 468, avg_loss: 32.5810, kl: 29.5482, mi: 4.8177, recon: 3.0329, au 32, time elapsed 871.01s, acc:  0.8948
epoch: 1, iter: 507, avg_loss: 35.0355, kl: 31.4974, mi: 4.6206, recon: 3.5381, au 32, time elapsed 933.11s, acc:  0.8993
epoch: 1, iter: 546, avg_loss: 30.8743, kl: 28.3044, mi: 4.5977, recon: 2.5699, au 32, time elapsed 991.17s, acc:  0.9114
epoch: 1, iter: 585, avg_loss: 32.4769, kl: 29.4433, mi: 4.7054, recon: 3.0336, au 32, time elapsed 1047.77s, acc:  0.9064
epoch: 1, iter: 624, avg_loss: 32.3493, kl: 29.1642, mi: 4.6504, recon: 3.1851, au 32, time elapsed 1107.56s, acc:  0.8983
epoch: 1, iter: 663, avg_loss: 32.9658, kl: 29.7883, mi: 4.7960, recon: 3.1774, au 32, time elapsed 1169.37s, acc:  0.9043
epoch: 1, iter: 702, avg_loss: 29.3509, kl: 26.6043, mi: 4.6805, recon: 2.7465, au 32, time elapsed 1227.46s, acc:  0.9065
epoch: 1, iter: 741, avg_loss: 30.7398, kl: 27.6855, mi: 4.6992, recon: 3.0543, au 32, time elapsed 1281.43s, acc:  0.9089
epoch: 1, iter: 780, avg_loss: 29.3151, kl: 26.4068, mi: 4.7567, recon: 2.9083, au 32, time elapsed 1342.02s, acc:  0.9071
pre mi:4.6361. cur mi:4.6864
train acc: 0.9039
kl weight 0.2862
VAL --- avg_loss: 30.2585, kl: 27.3549, mi: 4.7354, recon: 2.9035, nll: 2.9035, ppl: 1.3057, acc: 0.9113
32 active units
update best loss
saved model
epoch: 2, iter: 819, avg_loss: 26.8105, kl: 24.4028, mi: 4.6395, recon: 2.4077, au 32, time elapsed 1397.58s, acc:  0.9096
epoch: 2, iter: 858, avg_loss: 29.3088, kl: 26.4042, mi: 4.7841, recon: 2.9046, au 32, time elapsed 1452.97s, acc:  0.9101
epoch: 2, iter: 897, avg_loss: 27.2678, kl: 24.6975, mi: 4.7367, recon: 2.5704, au 32, time elapsed 1501.88s, acc:  0.9152
epoch: 2, iter: 936, avg_loss: 27.6338, kl: 24.8132, mi: 4.7571, recon: 2.8206, au 32, time elapsed 1560.62s, acc:  0.9083
epoch: 2, iter: 975, avg_loss: 28.0362, kl: 24.9466, mi: 4.6983, recon: 3.0896, au 32, time elapsed 1617.70s, acc:  0.9029
epoch: 2, iter: 1014, avg_loss: 27.3182, kl: 24.3553, mi: 4.7417, recon: 2.9629, au 32, time elapsed 1670.25s, acc:  0.9029
epoch: 2, iter: 1053, avg_loss: 27.1207, kl: 24.1326, mi: 4.6653, recon: 2.9881, au 32, time elapsed 1729.44s, acc:  0.9049
epoch: 2, iter: 1092, avg_loss: 27.0756, kl: 23.9827, mi: 4.5964, recon: 3.0929, au 32, time elapsed 1780.09s, acc:  0.9013
epoch: 2, iter: 1131, avg_loss: 26.2967, kl: 23.1032, mi: 4.7466, recon: 3.1935, au 32, time elapsed 1834.14s, acc:  0.8976
epoch: 2, iter: 1170, avg_loss: 27.3988, kl: 24.0089, mi: 4.7648, recon: 3.3899, au 32, time elapsed 1887.96s, acc:  0.9011
epoch: 2, iter: 1209, avg_loss: 26.2692, kl: 22.8707, mi: 4.7496, recon: 3.3985, au 32, time elapsed 1939.72s, acc:  0.8924
pre mi:4.6864. cur mi:4.8487
train acc: 0.9037
kl weight 0.3792
VAL --- avg_loss: 26.8153, kl: 23.5607, mi: 4.7720, recon: 3.2546, nll: 3.2546, ppl: 1.3485, acc: 0.9007
32 active units
update best loss
saved model
epoch: 3, iter: 1248, avg_loss: 26.2491, kl: 22.8539, mi: 4.6341, recon: 3.3952, au 32, time elapsed 1997.27s, acc:  0.8970
epoch: 3, iter: 1287, avg_loss: 25.1637, kl: 22.0008, mi: 4.6547, recon: 3.1629, au 32, time elapsed 2052.14s, acc:  0.8964
epoch: 3, iter: 1326, avg_loss: 24.9627, kl: 21.6358, mi: 4.7069, recon: 3.3270, au 32, time elapsed 2105.70s, acc:  0.8901
epoch: 3, iter: 1365, avg_loss: 25.6981, kl: 22.2249, mi: 4.7404, recon: 3.4732, au 31, time elapsed 2157.04s, acc:  0.8957
epoch: 3, iter: 1404, avg_loss: 25.0897, kl: 21.5733, mi: 4.6871, recon: 3.5164, au 32, time elapsed 2210.02s, acc:  0.8903
epoch: 3, iter: 1443, avg_loss: 24.7016, kl: 21.2079, mi: 4.7366, recon: 3.4936, au 30, time elapsed 2261.35s, acc:  0.8890
epoch: 3, iter: 1482, avg_loss: 24.0438, kl: 20.5212, mi: 4.6659, recon: 3.5226, au 31, time elapsed 2320.12s, acc:  0.8814
epoch: 3, iter: 1521, avg_loss: 23.6852, kl: 20.2048, mi: 4.7505, recon: 3.4804, au 31, time elapsed 2372.60s, acc:  0.8821
epoch: 3, iter: 1560, avg_loss: 24.5000, kl: 20.6031, mi: 4.7441, recon: 3.8969, au 31, time elapsed 2427.35s, acc:  0.8808
epoch: 3, iter: 1599, avg_loss: 23.9411, kl: 20.1439, mi: 4.6744, recon: 3.7972, au 31, time elapsed 2482.54s, acc:  0.8766
pre mi:4.8487. cur mi:4.7328
STOP BURNING
train acc: 0.8877
kl weight 0.4723
VAL --- avg_loss: 24.7728, kl: 21.1286, mi: 4.7153, recon: 3.6442, nll: 3.6442, ppl: 1.3977, acc: 0.8901
31 active units
update best loss
saved model
epoch: 4, iter: 1638, avg_loss: 25.2725, kl: 19.7626, recon: 5.5099, time elapsed 2507.81s, acc:  0.8347
epoch: 4, iter: 1677, avg_loss: 23.5932, kl: 19.1245, recon: 4.4687, time elapsed 2509.03s, acc:  0.8521
epoch: 4, iter: 1716, avg_loss: 24.7099, kl: 19.6430, recon: 5.0669, time elapsed 2510.32s, acc:  0.8516
epoch: 4, iter: 1755, avg_loss: 24.1010, kl: 19.0631, recon: 5.0379, time elapsed 2511.60s, acc:  0.8437
epoch: 4, iter: 1794, avg_loss: 23.4979, kl: 18.9220, recon: 4.5759, time elapsed 2512.92s, acc:  0.8564
epoch: 4, iter: 1833, avg_loss: 23.1177, kl: 18.3411, recon: 4.7766, time elapsed 2514.17s, acc:  0.8444
epoch: 4, iter: 1872, avg_loss: 24.2157, kl: 18.8043, recon: 5.4114, time elapsed 2515.54s, acc:  0.8446
epoch: 4, iter: 1911, avg_loss: 22.8592, kl: 17.9851, recon: 4.8740, time elapsed 2516.80s, acc:  0.8458
epoch: 4, iter: 1950, avg_loss: 22.9287, kl: 17.9745, recon: 4.9542, time elapsed 2518.13s, acc:  0.8481
epoch: 4, iter: 1989, avg_loss: 22.4296, kl: 17.2867, recon: 5.1429, time elapsed 2519.36s, acc:  0.8337
train acc: 0.8456
kl weight 0.5654
VAL --- avg_loss: 23.2070, kl: 18.2546, mi: 4.7065, recon: 4.9524, nll: 4.9524, ppl: 1.5762, acc: 0.8512
30 active units
update best loss
saved model
epoch: 5, iter: 2028, avg_loss: 21.3045, kl: 16.5987, recon: 4.7058, time elapsed 2523.06s, acc:  0.8324
epoch: 5, iter: 2067, avg_loss: 21.5681, kl: 16.5622, recon: 5.0059, time elapsed 2524.24s, acc:  0.8306
epoch: 5, iter: 2106, avg_loss: 22.3508, kl: 16.9838, recon: 5.3670, time elapsed 2525.52s, acc:  0.8325
epoch: 5, iter: 2145, avg_loss: 22.1064, kl: 16.7274, recon: 5.3790, time elapsed 2526.78s, acc:  0.8291
epoch: 5, iter: 2184, avg_loss: 22.5477, kl: 17.0012, recon: 5.5466, time elapsed 2528.13s, acc:  0.8356
epoch: 5, iter: 2223, avg_loss: 22.1575, kl: 16.4997, recon: 5.6579, time elapsed 2529.41s, acc:  0.8203
epoch: 5, iter: 2262, avg_loss: 21.8078, kl: 16.4024, recon: 5.4053, time elapsed 2530.70s, acc:  0.8297
epoch: 5, iter: 2301, avg_loss: 21.6637, kl: 16.0275, recon: 5.6361, time elapsed 2531.98s, acc:  0.8236
epoch: 5, iter: 2340, avg_loss: 21.4304, kl: 15.7094, recon: 5.7210, time elapsed 2533.22s, acc:  0.8138
epoch: 5, iter: 2379, avg_loss: 21.0581, kl: 15.4533, recon: 5.6048, time elapsed 2534.47s, acc:  0.8179
epoch: 5, iter: 2418, avg_loss: 21.2531, kl: 15.5013, recon: 5.7518, time elapsed 2535.81s, acc:  0.8208
train acc: 0.8256
kl weight 0.6585
VAL --- avg_loss: 21.5083, kl: 15.8506, mi: 4.7779, recon: 5.6577, nll: 5.6577, ppl: 1.6817, acc: 0.8286
30 active units
update best loss
saved model
epoch: 6, iter: 2457, avg_loss: 20.6623, kl: 14.9279, recon: 5.7344, time elapsed 2538.26s, acc:  0.8104
epoch: 6, iter: 2496, avg_loss: 20.7895, kl: 14.7340, recon: 6.0555, time elapsed 2539.44s, acc:  0.8015
epoch: 6, iter: 2535, avg_loss: 22.2228, kl: 15.5573, recon: 6.6655, time elapsed 2540.79s, acc:  0.8130
epoch: 6, iter: 2574, avg_loss: 21.2585, kl: 14.8768, recon: 6.3817, time elapsed 2542.11s, acc:  0.8039
epoch: 6, iter: 2613, avg_loss: 20.5197, kl: 14.2737, recon: 6.2460, time elapsed 2543.35s, acc:  0.7944
epoch: 6, iter: 2652, avg_loss: 20.4050, kl: 13.9590, recon: 6.4459, time elapsed 2544.57s, acc:  0.7909
epoch: 6, iter: 2691, avg_loss: 20.5687, kl: 14.0276, recon: 6.5411, time elapsed 2545.87s, acc:  0.7912
epoch: 6, iter: 2730, avg_loss: 20.6142, kl: 14.0462, recon: 6.5680, time elapsed 2547.20s, acc:  0.7946
epoch: 6, iter: 2769, avg_loss: 20.4025, kl: 13.6620, recon: 6.7404, time elapsed 2548.46s, acc:  0.7847
epoch: 6, iter: 2808, avg_loss: 20.0682, kl: 13.2522, recon: 6.8160, time elapsed 2549.73s, acc:  0.7762
train acc: 0.7954
kl weight 0.7516
VAL --- avg_loss: 20.5531, kl: 14.0587, mi: 4.6066, recon: 6.4944, nll: 6.4944, ppl: 1.8161, acc: 0.8018
30 active units
update best loss
saved model
epoch: 7, iter: 2847, avg_loss: 19.5211, kl: 12.9169, recon: 6.6042, time elapsed 2552.15s, acc:  0.7812
epoch: 7, iter: 2886, avg_loss: 20.4238, kl: 13.3291, recon: 7.0946, time elapsed 2553.51s, acc:  0.7807
epoch: 7, iter: 2925, avg_loss: 19.8988, kl: 12.7454, recon: 7.1534, time elapsed 2554.76s, acc:  0.7658
epoch: 7, iter: 2964, avg_loss: 19.4815, kl: 12.2896, recon: 7.1919, time elapsed 2555.99s, acc:  0.7607
epoch: 7, iter: 3003, avg_loss: 19.9815, kl: 12.5784, recon: 7.4030, time elapsed 2557.29s, acc:  0.7692
epoch: 7, iter: 3042, avg_loss: 19.8533, kl: 12.1301, recon: 7.7232, time elapsed 2558.57s, acc:  0.7552
epoch: 7, iter: 3081, avg_loss: 19.6575, kl: 11.9862, recon: 7.6712, time elapsed 2559.85s, acc:  0.7552
epoch: 7, iter: 3120, avg_loss: 19.4915, kl: 11.6766, recon: 7.8149, time elapsed 2561.03s, acc:  0.7373
epoch: 7, iter: 3159, avg_loss: 20.4128, kl: 12.1556, recon: 8.2573, time elapsed 2562.42s, acc:  0.7602
epoch: 7, iter: 3198, avg_loss: 20.1376, kl: 11.6183, recon: 8.5194, time elapsed 2563.66s, acc:  0.7399
train acc: 0.7577
kl weight 0.8447
VAL --- avg_loss: 19.8160, kl: 11.8102, mi: 4.6125, recon: 8.0057, nll: 8.0057, ppl: 2.0866, acc: 0.7585
30 active units
update best loss
saved model
epoch: 8, iter: 3237, avg_loss: 19.6454, kl: 11.3131, recon: 8.3323, time elapsed 2566.12s, acc:  0.7423
epoch: 8, iter: 3276, avg_loss: 19.7032, kl: 11.2856, recon: 8.4175, time elapsed 2567.44s, acc:  0.7405
epoch: 8, iter: 3315, avg_loss: 18.7075, kl: 10.6411, recon: 8.0664, time elapsed 2568.62s, acc:  0.7230
epoch: 8, iter: 3354, avg_loss: 19.2363, kl: 10.6478, recon: 8.5885, time elapsed 2569.90s, acc:  0.7248
epoch: 8, iter: 3393, avg_loss: 19.3445, kl: 10.6237, recon: 8.7208, time elapsed 2571.23s, acc:  0.7266
epoch: 8, iter: 3432, avg_loss: 18.7258, kl: 9.9365, recon: 8.7893, time elapsed 2572.44s, acc:  0.7017
epoch: 8, iter: 3471, avg_loss: 19.2446, kl: 9.9861, recon: 9.2585, time elapsed 2573.68s, acc:  0.7055
epoch: 8, iter: 3510, avg_loss: 19.1314, kl: 9.5230, recon: 9.6084, time elapsed 2574.90s, acc:  0.6974
epoch: 8, iter: 3549, avg_loss: 19.6427, kl: 9.7214, recon: 9.9213, time elapsed 2576.23s, acc:  0.6984
epoch: 8, iter: 3588, avg_loss: 18.8914, kl: 9.3152, recon: 9.5763, time elapsed 2577.47s, acc:  0.6907
epoch: 8, iter: 3627, avg_loss: 19.2254, kl: 9.2978, recon: 9.9275, time elapsed 2578.80s, acc:  0.6947
train acc: 0.7112
kl weight 0.9377
VAL --- avg_loss: 19.0994, kl: 9.2280, mi: 4.6004, recon: 9.8714, nll: 9.8714, ppl: 2.4768, acc: 0.7018
30 active units
update best loss
saved model
epoch: 9, iter: 3666, avg_loss: 18.5448, kl: 8.7318, recon: 9.8130, time elapsed 2581.26s, acc:  0.6741
epoch: 9, iter: 3705, avg_loss: 19.1561, kl: 8.7730, recon: 10.3831, time elapsed 2582.54s, acc:  0.6820
epoch: 9, iter: 3744, avg_loss: 18.8699, kl: 8.4598, recon: 10.4100, time elapsed 2583.81s, acc:  0.6721
epoch: 9, iter: 3783, avg_loss: 19.2114, kl: 8.4493, recon: 10.7621, time elapsed 2585.14s, acc:  0.6775
epoch: 9, iter: 3822, avg_loss: 18.3449, kl: 7.8009, recon: 10.5440, time elapsed 2586.37s, acc:  0.6480
epoch: 9, iter: 3861, avg_loss: 18.8217, kl: 7.9000, recon: 10.9217, time elapsed 2587.70s, acc:  0.6607
epoch: 9, iter: 3900, avg_loss: 18.7225, kl: 7.4074, recon: 11.3151, time elapsed 2588.98s, acc:  0.6426
epoch: 9, iter: 3939, avg_loss: 18.3033, kl: 7.0901, recon: 11.2131, time elapsed 2590.23s, acc:  0.6301
epoch: 9, iter: 3978, avg_loss: 18.4805, kl: 7.1199, recon: 11.3605, time elapsed 2591.48s, acc:  0.6369
epoch: 9, iter: 4017, avg_loss: 19.0197, kl: 7.1910, recon: 11.8287, time elapsed 2592.81s, acc:  0.6425
train acc: 0.6542
kl weight 1.0000
VAL --- avg_loss: 19.4699, kl: 7.1588, mi: 4.2291, recon: 12.3111, nll: 12.3111, ppl: 3.0991, acc: 0.6309
28 active units
saved model
