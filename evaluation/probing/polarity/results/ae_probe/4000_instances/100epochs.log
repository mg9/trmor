
number of params: 3072 
Namespace(batchsize=128, dec_dropout_in=0.0, dec_dropout_out=0.0, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=1024, epochs=100, fig_path='evaluation/probing/polarity/results/ae_probe/4000_instances/100epochs.png', log_path='evaluation/probing/polarity/results/ae_probe/4000_instances/100epochs.log', logger=<common.utils.Logger object at 0x7f18a0ea8e50>, lr=0.001, maxtrnsize=57769, maxtstsize=10000, maxvalsize=10000, mname='ae_probe', model=Probe(
  (encoder): AE_Encoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=32, bias=False)
  )
  (linear): Linear(in_features=1024, out_features=3, bias=False)
  (loss): CrossEntropyLoss()
), modelname='evaluation/probing/polarity/results/ae_probe/4000_instances/', nh=1024, ni=512, nz=32, opt='Adam', pretrained_model=AE(
  (encoder): AE_Encoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=32, bias=False)
  )
  (decoder): AE_Decoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (dropout_out): Dropout(p=0.0, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
), save_path='evaluation/probing/polarity/results/ae_probe/4000_instances/100epochs.pt', seq_to_no_pad='surface', task='surf2polar', trndata='evaluation/probing/polarity/data/polar.uniquesurfs.trn.txt', trnsize=4000, tstdata='evaluation/probing/polarity/data/polar.uniquesurfs.val.txt', tstsize=3000, valdata='evaluation/probing/polarity/data/polar.uniquesurfs.val.txt', valsize=3000)

encoder.embed.weight, torch.Size([39, 512]): False
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): False
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): False
encoder.lstm.bias_ih_l0, torch.Size([4096]): False
encoder.lstm.bias_hh_l0, torch.Size([4096]): False
encoder.linear.weight, torch.Size([32, 1024]): False
linear.weight, torch.Size([3, 1024]): True
epoch: 0 avg_loss: 0.9009, acc: 0.6555 
val --- avg_loss: 0.7655, acc: 0.7010  
update best loss 

epoch: 1 avg_loss: 0.7019, acc: 0.7350 
val --- avg_loss: 0.6583, acc: 0.7653  
update best loss 

epoch: 2 avg_loss: 0.6145, acc: 0.7678 
val --- avg_loss: 0.5990, acc: 0.7907  
update best loss 

epoch: 3 avg_loss: 0.5606, acc: 0.7985 
val --- avg_loss: 0.5537, acc: 0.8153  
update best loss 

epoch: 4 avg_loss: 0.5175, acc: 0.8275 
val --- avg_loss: 0.5217, acc: 0.8213  
update best loss 

epoch: 5 avg_loss: 0.4863, acc: 0.8263 
val --- avg_loss: 0.4953, acc: 0.8287  
update best loss 

epoch: 6 avg_loss: 0.4581, acc: 0.8393 
val --- avg_loss: 0.4726, acc: 0.8353  
update best loss 

epoch: 7 avg_loss: 0.4322, acc: 0.8522 
val --- avg_loss: 0.4549, acc: 0.8410  
update best loss 

epoch: 8 avg_loss: 0.4130, acc: 0.8560 
val --- avg_loss: 0.4385, acc: 0.8463  
update best loss 

epoch: 9 avg_loss: 0.3965, acc: 0.8612 
val --- avg_loss: 0.4245, acc: 0.8500  
update best loss 

epoch: 10 avg_loss: 0.3819, acc: 0.8668 
val --- avg_loss: 0.4140, acc: 0.8500  
update best loss 

epoch: 11 avg_loss: 0.3717, acc: 0.8690 
val --- avg_loss: 0.4031, acc: 0.8510  
update best loss 

epoch: 12 avg_loss: 0.3581, acc: 0.8725 
val --- avg_loss: 0.3934, acc: 0.8507  
update best loss 

epoch: 13 avg_loss: 0.3475, acc: 0.8712 
val --- avg_loss: 0.3835, acc: 0.8563  
update best loss 

epoch: 14 avg_loss: 0.3377, acc: 0.8762 
val --- avg_loss: 0.3764, acc: 0.8603  
update best loss 

epoch: 15 avg_loss: 0.3311, acc: 0.8762 
val --- avg_loss: 0.3687, acc: 0.8623  
update best loss 

epoch: 16 avg_loss: 0.3222, acc: 0.8815 
val --- avg_loss: 0.3626, acc: 0.8637  
update best loss 

epoch: 17 avg_loss: 0.3147, acc: 0.8810 
val --- avg_loss: 0.3566, acc: 0.8637  
update best loss 

epoch: 18 avg_loss: 0.3075, acc: 0.8825 
val --- avg_loss: 0.3510, acc: 0.8677  
update best loss 

epoch: 19 avg_loss: 0.3036, acc: 0.8852 
val --- avg_loss: 0.3458, acc: 0.8653  
update best loss 

epoch: 20 avg_loss: 0.2982, acc: 0.8828 
val --- avg_loss: 0.3414, acc: 0.8697  
update best loss 

epoch: 21 avg_loss: 0.2909, acc: 0.8870 
val --- avg_loss: 0.3363, acc: 0.8710  
update best loss 

epoch: 22 avg_loss: 0.2880, acc: 0.8895 
val --- avg_loss: 0.3324, acc: 0.8703  
update best loss 

epoch: 23 avg_loss: 0.2829, acc: 0.8910 
val --- avg_loss: 0.3265, acc: 0.8720  
update best loss 

epoch: 24 avg_loss: 0.2770, acc: 0.8908 
val --- avg_loss: 0.3247, acc: 0.8707  
update best loss 

epoch: 25 avg_loss: 0.2731, acc: 0.8932 
val --- avg_loss: 0.3208, acc: 0.8707  
update best loss 

epoch: 26 avg_loss: 0.2706, acc: 0.8942 
val --- avg_loss: 0.3175, acc: 0.8777  
update best loss 

epoch: 27 avg_loss: 0.2657, acc: 0.8962 
val --- avg_loss: 0.3143, acc: 0.8757  
update best loss 

epoch: 28 avg_loss: 0.2617, acc: 0.8988 
val --- avg_loss: 0.3118, acc: 0.8727  
update best loss 

epoch: 29 avg_loss: 0.2591, acc: 0.8988 
val --- avg_loss: 0.3084, acc: 0.8743  
update best loss 

epoch: 30 avg_loss: 0.2553, acc: 0.9000 
val --- avg_loss: 0.3053, acc: 0.8763  
update best loss 

epoch: 31 avg_loss: 0.2540, acc: 0.8978 
val --- avg_loss: 0.3013, acc: 0.8800  
update best loss 

epoch: 32 avg_loss: 0.2501, acc: 0.9012 
val --- avg_loss: 0.3000, acc: 0.8787  
update best loss 

epoch: 33 avg_loss: 0.2498, acc: 0.9002 
val --- avg_loss: 0.2975, acc: 0.8833  
update best loss 

epoch: 34 avg_loss: 0.2451, acc: 0.9035 
val --- avg_loss: 0.2951, acc: 0.8833  
update best loss 

epoch: 35 avg_loss: 0.2429, acc: 0.9030 
val --- avg_loss: 0.2930, acc: 0.8853  
update best loss 

epoch: 36 avg_loss: 0.2405, acc: 0.9038 
val --- avg_loss: 0.2906, acc: 0.8830  
update best loss 

epoch: 37 avg_loss: 0.2367, acc: 0.9045 
val --- avg_loss: 0.2881, acc: 0.8843  
update best loss 

epoch: 38 avg_loss: 0.2360, acc: 0.9030 
val --- avg_loss: 0.2857, acc: 0.8823  
update best loss 

epoch: 39 avg_loss: 0.2317, acc: 0.9065 
val --- avg_loss: 0.2844, acc: 0.8857  
update best loss 

epoch: 40 avg_loss: 0.2308, acc: 0.9070 
val --- avg_loss: 0.2819, acc: 0.8860  
update best loss 

epoch: 41 avg_loss: 0.2289, acc: 0.9085 
val --- avg_loss: 0.2801, acc: 0.8880  
update best loss 

epoch: 42 avg_loss: 0.2260, acc: 0.9097 
val --- avg_loss: 0.2781, acc: 0.8850  
update best loss 

epoch: 43 avg_loss: 0.2250, acc: 0.9058 
val --- avg_loss: 0.2760, acc: 0.8867  
update best loss 

epoch: 44 avg_loss: 0.2227, acc: 0.9080 
val --- avg_loss: 0.2753, acc: 0.8920  
update best loss 

epoch: 45 avg_loss: 0.2201, acc: 0.9093 
val --- avg_loss: 0.2727, acc: 0.8883  
update best loss 

epoch: 46 avg_loss: 0.2187, acc: 0.9100 
val --- avg_loss: 0.2713, acc: 0.8883  
update best loss 

epoch: 47 avg_loss: 0.2186, acc: 0.9090 
val --- avg_loss: 0.2696, acc: 0.8917  
update best loss 

epoch: 48 avg_loss: 0.2147, acc: 0.9120 
val --- avg_loss: 0.2675, acc: 0.8907  
update best loss 

epoch: 49 avg_loss: 0.2141, acc: 0.9113 
val --- avg_loss: 0.2670, acc: 0.8927  
update best loss 

epoch: 50 avg_loss: 0.2119, acc: 0.9113 
val --- avg_loss: 0.2650, acc: 0.8920  
update best loss 

epoch: 51 avg_loss: 0.2101, acc: 0.9123 
val --- avg_loss: 0.2635, acc: 0.8930  
update best loss 

epoch: 52 avg_loss: 0.2090, acc: 0.9133 
val --- avg_loss: 0.2629, acc: 0.8930  
update best loss 

epoch: 53 avg_loss: 0.2080, acc: 0.9145 
val --- avg_loss: 0.2611, acc: 0.8943  
update best loss 

epoch: 54 avg_loss: 0.2066, acc: 0.9157 
val --- avg_loss: 0.2606, acc: 0.8967  
update best loss 

epoch: 55 avg_loss: 0.2049, acc: 0.9137 
val --- avg_loss: 0.2585, acc: 0.8947  
update best loss 

epoch: 56 avg_loss: 0.2030, acc: 0.9153 
val --- avg_loss: 0.2563, acc: 0.8957  
update best loss 

epoch: 57 avg_loss: 0.2017, acc: 0.9173 
val --- avg_loss: 0.2551, acc: 0.8950  
update best loss 

epoch: 58 avg_loss: 0.2021, acc: 0.9143 
val --- avg_loss: 0.2554, acc: 0.8963  

epoch: 59 avg_loss: 0.2016, acc: 0.9180 
val --- avg_loss: 0.2538, acc: 0.8977  
update best loss 

epoch: 60 avg_loss: 0.1983, acc: 0.9175 
val --- avg_loss: 0.2518, acc: 0.8963  
update best loss 

epoch: 61 avg_loss: 0.1980, acc: 0.9180 
val --- avg_loss: 0.2506, acc: 0.8973  
update best loss 

epoch: 62 avg_loss: 0.1966, acc: 0.9180 
val --- avg_loss: 0.2500, acc: 0.8973  
update best loss 

epoch: 63 avg_loss: 0.1941, acc: 0.9190 
val --- avg_loss: 0.2493, acc: 0.8997  
update best loss 

epoch: 64 avg_loss: 0.1939, acc: 0.9205 
val --- avg_loss: 0.2472, acc: 0.9010  
update best loss 

epoch: 65 avg_loss: 0.1940, acc: 0.9195 
val --- avg_loss: 0.2476, acc: 0.8997  

epoch: 66 avg_loss: 0.1915, acc: 0.9213 
val --- avg_loss: 0.2465, acc: 0.9007  
update best loss 

epoch: 67 avg_loss: 0.1903, acc: 0.9227 
val --- avg_loss: 0.2464, acc: 0.9027  
update best loss 

epoch: 68 avg_loss: 0.1909, acc: 0.9213 
val --- avg_loss: 0.2445, acc: 0.9003  
update best loss 

epoch: 69 avg_loss: 0.1895, acc: 0.9225 
val --- avg_loss: 0.2436, acc: 0.9027  
update best loss 

epoch: 70 avg_loss: 0.1880, acc: 0.9233 
val --- avg_loss: 0.2416, acc: 0.9010  
update best loss 

epoch: 71 avg_loss: 0.1881, acc: 0.9225 
val --- avg_loss: 0.2404, acc: 0.9033  
update best loss 

epoch: 72 avg_loss: 0.1857, acc: 0.9225 
val --- avg_loss: 0.2407, acc: 0.9030  

epoch: 73 avg_loss: 0.1839, acc: 0.9247 
val --- avg_loss: 0.2399, acc: 0.9030  
update best loss 

epoch: 74 avg_loss: 0.1836, acc: 0.9243 
val --- avg_loss: 0.2384, acc: 0.9040  
update best loss 

epoch: 75 avg_loss: 0.1819, acc: 0.9263 
val --- avg_loss: 0.2385, acc: 0.9043  

epoch: 76 avg_loss: 0.1818, acc: 0.9255 
val --- avg_loss: 0.2367, acc: 0.9037  
update best loss 

epoch: 77 avg_loss: 0.1802, acc: 0.9253 
val --- avg_loss: 0.2380, acc: 0.9053  

epoch: 78 avg_loss: 0.1831, acc: 0.9230 
val --- avg_loss: 0.2349, acc: 0.9057  
update best loss 

epoch: 79 avg_loss: 0.1781, acc: 0.9263 
val --- avg_loss: 0.2351, acc: 0.9047  

epoch: 80 avg_loss: 0.1774, acc: 0.9265 
val --- avg_loss: 0.2346, acc: 0.9063  
update best loss 

epoch: 81 avg_loss: 0.1769, acc: 0.9285 
val --- avg_loss: 0.2334, acc: 0.9073  
update best loss 

epoch: 82 avg_loss: 0.1761, acc: 0.9265 
val --- avg_loss: 0.2326, acc: 0.9070  
update best loss 

epoch: 83 avg_loss: 0.1751, acc: 0.9280 
val --- avg_loss: 0.2320, acc: 0.9080  
update best loss 

epoch: 84 avg_loss: 0.1751, acc: 0.9270 
val --- avg_loss: 0.2311, acc: 0.9087  
update best loss 

epoch: 85 avg_loss: 0.1740, acc: 0.9287 
val --- avg_loss: 0.2297, acc: 0.9073  
update best loss 

epoch: 86 avg_loss: 0.1726, acc: 0.9303 
val --- avg_loss: 0.2311, acc: 0.9087  

epoch: 87 avg_loss: 0.1722, acc: 0.9323 
val --- avg_loss: 0.2292, acc: 0.9080  
update best loss 

epoch: 88 avg_loss: 0.1710, acc: 0.9303 
val --- avg_loss: 0.2278, acc: 0.9110  
update best loss 

epoch: 89 avg_loss: 0.1709, acc: 0.9315 
val --- avg_loss: 0.2282, acc: 0.9073  

epoch: 90 avg_loss: 0.1708, acc: 0.9310 
val --- avg_loss: 0.2267, acc: 0.9073  
update best loss 

epoch: 91 avg_loss: 0.1698, acc: 0.9320 
val --- avg_loss: 0.2271, acc: 0.9083  

epoch: 92 avg_loss: 0.1684, acc: 0.9333 
val --- avg_loss: 0.2263, acc: 0.9113  
update best loss 

epoch: 93 avg_loss: 0.1674, acc: 0.9330 
val --- avg_loss: 0.2253, acc: 0.9100  
update best loss 

epoch: 94 avg_loss: 0.1673, acc: 0.9347 
val --- avg_loss: 0.2259, acc: 0.9103  

epoch: 95 avg_loss: 0.1662, acc: 0.9323 
val --- avg_loss: 0.2253, acc: 0.9103  
update best loss 

epoch: 96 avg_loss: 0.1657, acc: 0.9345 
val --- avg_loss: 0.2241, acc: 0.9090  
update best loss 

epoch: 97 avg_loss: 0.1646, acc: 0.9350 
val --- avg_loss: 0.2242, acc: 0.9107  

epoch: 98 avg_loss: 0.1647, acc: 0.9345 
val --- avg_loss: 0.2236, acc: 0.9120  
update best loss 

epoch: 99 avg_loss: 0.1646, acc: 0.9340 
val --- avg_loss: 0.2220, acc: 0.9113  
update best loss 
