
number of params: 12875776 
Namespace(batchsize=128, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=1024, epochs=15, fig_path='model/ae/results/50000_instances/15epochs.png', log_path='model/ae/results/50000_instances/15epochs.log', logger=<common.utils.Logger object at 0x7f6349828ed0>, lr=0.001, maxtrnsize=57769, maxtstsize=10000, maxvalsize=10000, mname='ae', model=AE(
  (encoder): AE_Encoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=32, bias=False)
  )
  (decoder): AE_Decoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
), modelname='model/ae/results/50000_instances/', ni=512, nz=32, opt='Adam', save_path='model/ae/results/50000_instances/15epochs.pt', seq_to_no_pad='surface', surface_vocab_file='model/ae/data/surf.uniquesurfs.trn.txt', task='ae', trndata='model/ae/data/surf.uniquesurfs.trn.txt', trnsize=50000, tstdata='model/ae/data/surf.uniquesurfs.val.txt', tstsize=50000, valdata='model/ae/data/surf.uniquesurfs.val.txt', valsize=4000)

encoder.embed.weight, torch.Size([39, 512]): True
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): True
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
encoder.lstm.bias_ih_l0, torch.Size([4096]): True
encoder.lstm.bias_hh_l0, torch.Size([4096]): True
encoder.linear.weight, torch.Size([32, 1024]): True
decoder.embed.weight, torch.Size([39, 512]): True
decoder.trans_linear.weight, torch.Size([1024, 32]): True
decoder.lstm.weight_ih_l0, torch.Size([4096, 544]): True
decoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
decoder.lstm.bias_ih_l0, torch.Size([4096]): True
decoder.lstm.bias_hh_l0, torch.Size([4096]): True
decoder.pred_linear.weight, torch.Size([39, 1024]): True
epoch: 0 avg_loss: 24.7122, acc: 0.2771
val --- avg_loss: 22.6242, acc: 0.3591  
update best loss 

epoch: 1 avg_loss: 20.2548, acc: 0.3696
val --- avg_loss: 19.7858, acc: 0.4325  
update best loss 

epoch: 2 avg_loss: 17.7958, acc: 0.4443
val --- avg_loss: 17.0581, acc: 0.5121  
update best loss 

epoch: 3 avg_loss: 14.9434, acc: 0.5319
val --- avg_loss: 13.4820, acc: 0.6091  
update best loss 

epoch: 4 avg_loss: 11.4754, acc: 0.6419
val --- avg_loss: 10.9819, acc: 0.6914  
update best loss 

epoch: 5 avg_loss: 8.3444, acc: 0.7446
val --- avg_loss: 8.8916, acc: 0.7650  
update best loss 

epoch: 6 avg_loss: 5.7102, acc: 0.8262
val --- avg_loss: 4.7935, acc: 0.8679  
update best loss 

epoch: 7 avg_loss: 4.1492, acc: 0.8760
val --- avg_loss: 4.2939, acc: 0.9007  
update best loss 

epoch: 8 avg_loss: 2.9991, acc: 0.9119
val --- avg_loss: 2.4203, acc: 0.9424  
update best loss 

epoch: 9 avg_loss: 2.1002, acc: 0.9397
val --- avg_loss: 1.7501, acc: 0.9632  
update best loss 

epoch: 10 avg_loss: 1.6877, acc: 0.9510
val --- avg_loss: 1.6899, acc: 0.9651  
update best loss 

epoch: 11 avg_loss: 1.2782, acc: 0.9623
val --- avg_loss: 1.2380, acc: 0.9755  
update best loss 

epoch: 12 avg_loss: 1.2819, acc: 0.9638
val --- avg_loss: 1.1488, acc: 0.9755  
update best loss 

epoch: 13 avg_loss: 0.8202, acc: 0.9763
val --- avg_loss: 1.0278, acc: 0.9803  
update best loss 

epoch: 14 avg_loss: 0.6361, acc: 0.9812
val --- avg_loss: 2.5928, acc: 0.9644  
