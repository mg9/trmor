
number of params: 16925696 
Namespace(batchsize=128, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=1024, epochs=150, fig_path='model/ae/results/training/50000_instances/150epochs.png', log_path='model/ae/results/training/50000_instances/150epochs.log', logger=<common.utils.Logger object at 0x7fd6b8b301d0>, lr=0.001, maxtrnsize=582000, maxtstsize=10000, maxvalsize=10000, mname='ae', model=AE(
  (encoder): AE_Encoder(
    (embed): Embedding(39, 1024)
    (lstm): LSTM(1024, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=2, bias=False)
  )
  (decoder): AE_Decoder(
    (embed): Embedding(39, 1024, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=2, out_features=1024, bias=False)
    (lstm): LSTM(1026, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
), modelname='model/ae/results/training/50000_instances/', ni=1024, nz=2, opt='Adam', save_path='model/ae/results/training/50000_instances/150epochs.pt', seq_to_no_pad='surface', surface_vocab_file='model/vae/data/surf.uniquesurfs.trn.txt', task='ae', trndata='model/vae/data/surf.uniquesurfs.trn.txt', trnsize=50000, tstdata='model/vae/data/surf.uniquesurfs.val.txt', tstsize=50000, valdata='model/vae/data/surf.uniquesurfs.val.txt', valsize=4000)

encoder.embed.weight, torch.Size([39, 1024]): True
encoder.lstm.weight_ih_l0, torch.Size([4096, 1024]): True
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
encoder.lstm.bias_ih_l0, torch.Size([4096]): True
encoder.lstm.bias_hh_l0, torch.Size([4096]): True
encoder.linear.weight, torch.Size([2, 1024]): True
decoder.embed.weight, torch.Size([39, 1024]): True
decoder.trans_linear.weight, torch.Size([1024, 2]): True
decoder.lstm.weight_ih_l0, torch.Size([4096, 1026]): True
decoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
decoder.lstm.bias_ih_l0, torch.Size([4096]): True
decoder.lstm.bias_hh_l0, torch.Size([4096]): True
decoder.pred_linear.weight, torch.Size([39, 1024]): True
epoch: 0 avg_loss: 22.0562, acc: 0.3366
val --- avg_loss: 19.3639, acc: 0.4467  
update best loss 

epoch: 1 avg_loss: 16.2862, acc: 0.4827
val --- avg_loss: 16.1105, acc: 0.5208  
update best loss 

epoch: 2 avg_loss: 14.3634, acc: 0.5387
val --- avg_loss: 14.9521, acc: 0.5547  
update best loss 

epoch: 3 avg_loss: 12.8590, acc: 0.5837
val --- avg_loss: 12.8140, acc: 0.6114  
update best loss 

epoch: 4 avg_loss: 11.4810, acc: 0.6265
val --- avg_loss: 11.7455, acc: 0.6468  
update best loss 

epoch: 5 avg_loss: 10.7449, acc: 0.6492
val --- avg_loss: 11.3261, acc: 0.6571  
update best loss 

epoch: 6 avg_loss: 10.1537, acc: 0.6653
val --- avg_loss: 10.6254, acc: 0.6776  
update best loss 

epoch: 7 avg_loss: 9.6652, acc: 0.6784
val --- avg_loss: 10.3765, acc: 0.6852  
update best loss 

epoch: 8 avg_loss: 9.2961, acc: 0.6894
val --- avg_loss: 10.3358, acc: 0.6868  
update best loss 

epoch: 9 avg_loss: 8.9661, acc: 0.6991
val --- avg_loss: 9.9331, acc: 0.6985  
update best loss 

epoch: 10 avg_loss: 8.7206, acc: 0.7058
val --- avg_loss: 10.0256, acc: 0.6999  

epoch: 11 avg_loss: 8.5001, acc: 0.7114
val --- avg_loss: 9.7708, acc: 0.7036  
update best loss 

epoch: 12 avg_loss: 8.2659, acc: 0.7186
val --- avg_loss: 9.6182, acc: 0.7059  
update best loss 

epoch: 13 avg_loss: 8.1180, acc: 0.7230
val --- avg_loss: 9.5769, acc: 0.7081  
update best loss 

epoch: 14 avg_loss: 7.9183, acc: 0.7286
val --- avg_loss: 9.5050, acc: 0.7099  
update best loss 

epoch: 15 avg_loss: 7.7753, acc: 0.7328
val --- avg_loss: 9.4221, acc: 0.7159  
update best loss 

epoch: 16 avg_loss: 7.6428, acc: 0.7365
val --- avg_loss: 9.1785, acc: 0.7206  
update best loss 

epoch: 17 avg_loss: 7.5047, acc: 0.7406
val --- avg_loss: 9.2135, acc: 0.7213  

epoch: 18 avg_loss: 7.3731, acc: 0.7450
val --- avg_loss: 9.4106, acc: 0.7180  

epoch: 19 avg_loss: 7.2728, acc: 0.7476
val --- avg_loss: 9.0625, acc: 0.7233  
update best loss 

epoch: 20 avg_loss: 7.1967, acc: 0.7501
val --- avg_loss: 9.1418, acc: 0.7238  

epoch: 21 avg_loss: 7.0949, acc: 0.7529
val --- avg_loss: 9.0732, acc: 0.7264  

epoch: 22 avg_loss: 6.9707, acc: 0.7569
val --- avg_loss: 9.4388, acc: 0.7239  

epoch: 23 avg_loss: 6.9017, acc: 0.7592
val --- avg_loss: 9.0669, acc: 0.7323  

epoch: 24 avg_loss: 6.8293, acc: 0.7617
val --- avg_loss: 9.1803, acc: 0.7268  

epoch: 25 avg_loss: 6.7356, acc: 0.7647
val --- avg_loss: 8.9514, acc: 0.7339  
update best loss 

epoch: 26 avg_loss: 6.6832, acc: 0.7664
val --- avg_loss: 9.0956, acc: 0.7353  

epoch: 27 avg_loss: 6.5495, acc: 0.7713
val --- avg_loss: 9.4049, acc: 0.7275  

epoch: 28 avg_loss: 6.5538, acc: 0.7702
val --- avg_loss: 9.1875, acc: 0.7311  

epoch: 29 avg_loss: 6.4832, acc: 0.7732
val --- avg_loss: 9.0664, acc: 0.7340  

epoch: 30 avg_loss: 6.3407, acc: 0.7768
val --- avg_loss: 9.1684, acc: 0.7369  

epoch: 31 avg_loss: 6.4139, acc: 0.7754
val --- avg_loss: 9.1691, acc: 0.7319  

epoch: 32 avg_loss: 6.2609, acc: 0.7798
val --- avg_loss: 9.2604, acc: 0.7361  

epoch: 33 avg_loss: 6.1918, acc: 0.7815
val --- avg_loss: 9.1733, acc: 0.7349  

epoch: 34 avg_loss: 6.1966, acc: 0.7820
val --- avg_loss: 9.3762, acc: 0.7339  

epoch: 35 avg_loss: 6.1275, acc: 0.7839
val --- avg_loss: 9.4342, acc: 0.7344  

epoch: 36 avg_loss: 6.0716, acc: 0.7858
val --- avg_loss: 9.1096, acc: 0.7396  

epoch: 37 avg_loss: 6.0277, acc: 0.7868
val --- avg_loss: 9.4504, acc: 0.7362  

epoch: 38 avg_loss: 5.9750, acc: 0.7892
val --- avg_loss: 9.8449, acc: 0.7306  

epoch: 39 avg_loss: 5.9772, acc: 0.7884
val --- avg_loss: 9.1081, acc: 0.7386  

epoch: 40 avg_loss: 5.8835, acc: 0.7922
val --- avg_loss: 9.8905, acc: 0.7332  

epoch: 41 avg_loss: 5.8503, acc: 0.7925
val --- avg_loss: 9.5737, acc: 0.7402  

epoch: 42 avg_loss: 5.8149, acc: 0.7944
val --- avg_loss: 10.2615, acc: 0.7284  

epoch: 43 avg_loss: 5.8572, acc: 0.7932
val --- avg_loss: 9.5827, acc: 0.7371  

epoch: 44 avg_loss: 5.7571, acc: 0.7964
val --- avg_loss: 9.6649, acc: 0.7369  

epoch: 45 avg_loss: 5.7249, acc: 0.7980
val --- avg_loss: 9.5011, acc: 0.7337  

epoch: 46 avg_loss: 5.6941, acc: 0.7979
val --- avg_loss: 9.7257, acc: 0.7358  

epoch: 47 avg_loss: 5.6341, acc: 0.8004
val --- avg_loss: 9.3976, acc: 0.7398  

epoch: 48 avg_loss: 5.6108, acc: 0.8008
val --- avg_loss: 9.5679, acc: 0.7388  

epoch: 49 avg_loss: 5.5728, acc: 0.8017
val --- avg_loss: 9.9642, acc: 0.7363  

epoch: 50 avg_loss: 5.5257, acc: 0.8038
val --- avg_loss: 10.1852, acc: 0.7355  

epoch: 51 avg_loss: 5.5037, acc: 0.8045
val --- avg_loss: 9.9978, acc: 0.7404  

epoch: 52 avg_loss: 5.5506, acc: 0.8032
val --- avg_loss: 10.6191, acc: 0.7141  

epoch: 53 avg_loss: 5.5660, acc: 0.8027
val --- avg_loss: 9.9072, acc: 0.7415  

epoch: 54 avg_loss: 5.4361, acc: 0.8062
val --- avg_loss: 9.4746, acc: 0.7424  

epoch: 55 avg_loss: 5.4358, acc: 0.8068
val --- avg_loss: 9.6128, acc: 0.7450  

epoch: 56 avg_loss: 5.3540, acc: 0.8088
val --- avg_loss: 9.8942, acc: 0.7390  

epoch: 57 avg_loss: 5.3587, acc: 0.8088
val --- avg_loss: 9.6924, acc: 0.7397  

epoch: 58 avg_loss: 5.3171, acc: 0.8100
val --- avg_loss: 9.7870, acc: 0.7379  

epoch: 59 avg_loss: 5.3116, acc: 0.8100
val --- avg_loss: 9.6748, acc: 0.7438  

epoch: 60 avg_loss: 5.3374, acc: 0.8099
val --- avg_loss: 10.7903, acc: 0.7364  

epoch: 61 avg_loss: 5.3026, acc: 0.8111
val --- avg_loss: 9.9802, acc: 0.7419  

epoch: 62 avg_loss: 5.3227, acc: 0.8103
val --- avg_loss: 9.8924, acc: 0.7425  

epoch: 63 avg_loss: 5.2476, acc: 0.8120
val --- avg_loss: 10.5918, acc: 0.7432  

epoch: 64 avg_loss: 5.1903, acc: 0.8143
val --- avg_loss: 10.4122, acc: 0.7406  

epoch: 65 avg_loss: 5.1689, acc: 0.8145
val --- avg_loss: 9.9673, acc: 0.7487  

epoch: 66 avg_loss: 5.2046, acc: 0.8143
val --- avg_loss: 10.2376, acc: 0.7427  

epoch: 67 avg_loss: 5.1536, acc: 0.8155
val --- avg_loss: 10.2694, acc: 0.7413  

epoch: 68 avg_loss: 5.1362, acc: 0.8158
val --- avg_loss: 9.8978, acc: 0.7448  

epoch: 69 avg_loss: 5.1445, acc: 0.8156
val --- avg_loss: 9.7797, acc: 0.7424  

epoch: 70 avg_loss: 5.1003, acc: 0.8172
val --- avg_loss: 9.8848, acc: 0.7434  

epoch: 71 avg_loss: 5.0655, acc: 0.8183
val --- avg_loss: 10.7179, acc: 0.7407  

epoch: 72 avg_loss: 5.0658, acc: 0.8180
val --- avg_loss: 10.1216, acc: 0.7467  

epoch: 73 avg_loss: 5.0609, acc: 0.8176
val --- avg_loss: 10.6710, acc: 0.7475  

epoch: 74 avg_loss: 5.0063, acc: 0.8200
val --- avg_loss: 10.3835, acc: 0.7487  

epoch: 75 avg_loss: 4.9901, acc: 0.8200
val --- avg_loss: 10.1056, acc: 0.7478  

epoch: 76 avg_loss: 4.9973, acc: 0.8197
val --- avg_loss: 10.2973, acc: 0.7494  

epoch: 77 avg_loss: 5.0181, acc: 0.8196
val --- avg_loss: 10.1983, acc: 0.7472  

epoch: 78 avg_loss: 4.9882, acc: 0.8209
val --- avg_loss: 10.3539, acc: 0.7496  

epoch: 79 avg_loss: 4.9863, acc: 0.8200
val --- avg_loss: 10.4200, acc: 0.7438  

epoch: 80 avg_loss: 4.9928, acc: 0.8204
val --- avg_loss: 10.4613, acc: 0.7469  

epoch: 81 avg_loss: 4.9456, acc: 0.8221
val --- avg_loss: 10.4173, acc: 0.7459  

epoch: 82 avg_loss: 4.9255, acc: 0.8227
val --- avg_loss: 10.5853, acc: 0.7523  

epoch: 83 avg_loss: 4.8713, acc: 0.8243
val --- avg_loss: 10.6871, acc: 0.7494  

epoch: 84 avg_loss: 4.9007, acc: 0.8230
val --- avg_loss: 10.5781, acc: 0.7459  

epoch: 85 avg_loss: 4.8708, acc: 0.8243
val --- avg_loss: 10.5933, acc: 0.7460  

epoch: 86 avg_loss: 4.8941, acc: 0.8240
val --- avg_loss: 10.1557, acc: 0.7518  

epoch: 87 avg_loss: 4.8526, acc: 0.8249
val --- avg_loss: 10.6538, acc: 0.7476  

epoch: 88 avg_loss: 4.8574, acc: 0.8247
val --- avg_loss: 10.7622, acc: 0.7492  

epoch: 89 avg_loss: 4.8176, acc: 0.8259
val --- avg_loss: 10.5144, acc: 0.7420  

epoch: 90 avg_loss: 4.8466, acc: 0.8247
val --- avg_loss: 10.8741, acc: 0.7462  

epoch: 91 avg_loss: 4.8167, acc: 0.8259
val --- avg_loss: 10.4701, acc: 0.7441  

epoch: 92 avg_loss: 4.8557, acc: 0.8244
val --- avg_loss: 10.4042, acc: 0.7479  

epoch: 93 avg_loss: 4.8284, acc: 0.8248
val --- avg_loss: 10.3605, acc: 0.7496  

epoch: 94 avg_loss: 4.8204, acc: 0.8258
val --- avg_loss: 10.3747, acc: 0.7445  

epoch: 95 avg_loss: 4.7935, acc: 0.8266
val --- avg_loss: 10.9498, acc: 0.7480  

epoch: 96 avg_loss: 4.7332, acc: 0.8284
val --- avg_loss: 10.3425, acc: 0.7483  

epoch: 97 avg_loss: 4.7466, acc: 0.8280
val --- avg_loss: 10.5063, acc: 0.7508  

epoch: 98 avg_loss: 4.7546, acc: 0.8278
val --- avg_loss: 11.1235, acc: 0.7461  

epoch: 99 avg_loss: 4.7730, acc: 0.8273
val --- avg_loss: 10.8240, acc: 0.7535  

epoch: 100 avg_loss: 4.7536, acc: 0.8281
val --- avg_loss: 10.5446, acc: 0.7493  

epoch: 101 avg_loss: 4.7200, acc: 0.8292
val --- avg_loss: 11.1026, acc: 0.7482  

epoch: 102 avg_loss: 4.7059, acc: 0.8292
val --- avg_loss: 10.4551, acc: 0.7515  

epoch: 103 avg_loss: 4.7117, acc: 0.8293
val --- avg_loss: 10.6950, acc: 0.7441  

epoch: 104 avg_loss: 4.7400, acc: 0.8283
val --- avg_loss: 10.6633, acc: 0.7516  

epoch: 105 avg_loss: 4.6998, acc: 0.8292
val --- avg_loss: 10.6603, acc: 0.7495  

epoch: 106 avg_loss: 4.6984, acc: 0.8295
val --- avg_loss: 10.2502, acc: 0.7510  

epoch: 107 avg_loss: 4.6907, acc: 0.8295
val --- avg_loss: 10.9605, acc: 0.7459  

epoch: 108 avg_loss: 4.6829, acc: 0.8297
val --- avg_loss: 10.3717, acc: 0.7533  

epoch: 109 avg_loss: 4.6503, acc: 0.8312
val --- avg_loss: 11.0077, acc: 0.7485  

epoch: 110 avg_loss: 4.6666, acc: 0.8306
val --- avg_loss: 10.4991, acc: 0.7497  

epoch: 111 avg_loss: 4.6654, acc: 0.8310
val --- avg_loss: 10.8434, acc: 0.7411  

epoch: 112 avg_loss: 4.7137, acc: 0.8299
val --- avg_loss: 11.1742, acc: 0.7497  

epoch: 113 avg_loss: 4.7074, acc: 0.8298
val --- avg_loss: 10.3219, acc: 0.7562  

epoch: 114 avg_loss: 4.7042, acc: 0.8300
val --- avg_loss: 11.2644, acc: 0.7511  

epoch: 115 avg_loss: 4.6039, acc: 0.8320
val --- avg_loss: 10.9859, acc: 0.7432  

epoch: 116 avg_loss: 4.6858, acc: 0.8301
val --- avg_loss: 11.1295, acc: 0.7505  

epoch: 117 avg_loss: 4.6004, acc: 0.8329
val --- avg_loss: 10.9866, acc: 0.7488  

epoch: 118 avg_loss: 4.6322, acc: 0.8312
val --- avg_loss: 10.9505, acc: 0.7536  

epoch: 119 avg_loss: 4.5989, acc: 0.8325
val --- avg_loss: 11.1542, acc: 0.7525  

epoch: 120 avg_loss: 4.6034, acc: 0.8328
val --- avg_loss: 11.4226, acc: 0.7516  

epoch: 121 avg_loss: 4.5528, acc: 0.8342
val --- avg_loss: 11.2562, acc: 0.7506  

epoch: 122 avg_loss: 4.6033, acc: 0.8325
val --- avg_loss: 11.2644, acc: 0.7504  

epoch: 123 avg_loss: 4.6077, acc: 0.8325
val --- avg_loss: 10.4381, acc: 0.7531  

epoch: 124 avg_loss: 4.5760, acc: 0.8331
val --- avg_loss: 11.1018, acc: 0.7503  

epoch: 125 avg_loss: 4.6103, acc: 0.8322
val --- avg_loss: 10.7409, acc: 0.7506  

epoch: 126 avg_loss: 4.5488, acc: 0.8345
val --- avg_loss: 10.6945, acc: 0.7517  

epoch: 127 avg_loss: 4.5568, acc: 0.8338
val --- avg_loss: 10.8838, acc: 0.7500  

epoch: 128 avg_loss: 4.5682, acc: 0.8333
val --- avg_loss: 10.9333, acc: 0.7528  

epoch: 129 avg_loss: 4.5369, acc: 0.8345
val --- avg_loss: 11.4342, acc: 0.7461  

epoch: 130 avg_loss: 4.6060, acc: 0.8323
val --- avg_loss: 10.9293, acc: 0.7497  

epoch: 131 avg_loss: 4.5398, acc: 0.8340
val --- avg_loss: 11.1964, acc: 0.7503  

epoch: 132 avg_loss: 4.5508, acc: 0.8338
val --- avg_loss: 11.5080, acc: 0.7505  

epoch: 133 avg_loss: 4.5477, acc: 0.8349
val --- avg_loss: 11.2929, acc: 0.7455  

epoch: 134 avg_loss: 4.5557, acc: 0.8342
val --- avg_loss: 10.8914, acc: 0.7526  

epoch: 135 avg_loss: 4.5265, acc: 0.8349
val --- avg_loss: 10.9896, acc: 0.7512  

epoch: 136 avg_loss: 4.5063, acc: 0.8355
val --- avg_loss: 11.3931, acc: 0.7506  

epoch: 137 avg_loss: 4.4904, acc: 0.8358
val --- avg_loss: 11.0767, acc: 0.7534  

epoch: 138 avg_loss: 4.5401, acc: 0.8344
val --- avg_loss: 10.7942, acc: 0.7503  

epoch: 139 avg_loss: 4.4997, acc: 0.8356
val --- avg_loss: 11.2584, acc: 0.7524  

epoch: 140 avg_loss: 4.5499, acc: 0.8346
val --- avg_loss: 10.9172, acc: 0.7476  

epoch: 141 avg_loss: 4.5230, acc: 0.8349
val --- avg_loss: 11.3940, acc: 0.7478  

epoch: 142 avg_loss: 4.4747, acc: 0.8365
val --- avg_loss: 11.3854, acc: 0.7522  

epoch: 143 avg_loss: 4.5213, acc: 0.8349
val --- avg_loss: 10.7719, acc: 0.7528  

epoch: 144 avg_loss: 4.5508, acc: 0.8345
val --- avg_loss: 10.8733, acc: 0.7556  

epoch: 145 avg_loss: 4.5034, acc: 0.8359
val --- avg_loss: 10.9195, acc: 0.7540  

epoch: 146 avg_loss: 4.4884, acc: 0.8365
val --- avg_loss: 11.2034, acc: 0.7453  

epoch: 147 avg_loss: 4.4647, acc: 0.8369
val --- avg_loss: 11.0028, acc: 0.7545  

epoch: 148 avg_loss: 4.4804, acc: 0.8362
val --- avg_loss: 11.3521, acc: 0.7497  

epoch: 149 avg_loss: 4.4853, acc: 0.8357
val --- avg_loss: 10.9909, acc: 0.7517  
