
number of params: 6359552 
Namespace(batchsize=128, device='cuda', enc_dropout_in=0.2, enc_dropout_out=0.3, epochs=30, fig_path='model/charlm/results/training/50000_instances/30epochs.png', log_path='model/charlm/results/training/50000_instances/30epochs.log', logger=<common.utils.Logger object at 0x7f3cfe63bdd0>, lr=0.001, maxtrnsize=700000, maxtstsize=10000, maxvalsize=10000, mname='charlm', model=CharLM(
  (embed): Embedding(39, 512, padding_idx=0)
  (lstm): LSTM(512, 1024, batch_first=True)
  (dropout_in): Dropout(p=0.2, inplace=False)
  (dropout_out): Dropout(p=0.3, inplace=False)
  (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
  (loss): CrossEntropyLoss()
), modelname='model/charlm/results/training/50000_instances/', nh=1024, ni=512, opt='Adam', save_path='model/charlm/results/training/50000_instances/30epochs.pt', seq_to_no_pad='surface', surface_vocab_file='model/charlm/data/surf.uniquesurfs.trn.txt', task='lm', trndata='model/charlm/data/surf.uniquesurfs.trn.txt', trnsize=50000, tstdata='model/charlm/data/surf.uniquesurfs.val.txt', tstsize=50000, valdata='model/charlm/data/surf.uniquesurfs.val.txt', valsize=4000)

embed.weight, torch.Size([39, 512]): True
lstm.weight_ih_l0, torch.Size([4096, 512]): True
lstm.weight_hh_l0, torch.Size([4096, 1024]): True
lstm.bias_ih_l0, torch.Size([4096]): True
lstm.bias_hh_l0, torch.Size([4096]): True
pred_linear.weight, torch.Size([39, 1024]): True
epoch: 0 avg_loss: 2.2824
val --- avg_loss: 2.0185 
update best loss 

epoch: 1 avg_loss: 1.8696
val --- avg_loss: 1.8112 
update best loss 

epoch: 2 avg_loss: 1.7141
val --- avg_loss: 1.7204 
update best loss 

epoch: 3 avg_loss: 1.6232
val --- avg_loss: 1.6436 
update best loss 

epoch: 4 avg_loss: 1.5596
val --- avg_loss: 1.6004 
update best loss 

epoch: 5 avg_loss: 1.5203
val --- avg_loss: 1.5928 
update best loss 

epoch: 6 avg_loss: 1.4918
val --- avg_loss: 1.5745 
update best loss 

epoch: 7 avg_loss: 1.4629
val --- avg_loss: 1.5696 
update best loss 

epoch: 8 avg_loss: 1.4460
val --- avg_loss: 1.5727 

epoch: 9 avg_loss: 1.4293
val --- avg_loss: 1.5596 
update best loss 

epoch: 10 avg_loss: 1.4165
val --- avg_loss: 1.5784 

epoch: 11 avg_loss: 1.4025
val --- avg_loss: 1.5683 

epoch: 12 avg_loss: 1.3925
val --- avg_loss: 1.5741 

epoch: 13 avg_loss: 1.3844
val --- avg_loss: 1.5680 

epoch: 14 avg_loss: 1.3764
val --- avg_loss: 1.5783 

epoch: 15 avg_loss: 1.3680
val --- avg_loss: 1.5865 

epoch: 16 avg_loss: 1.3608
val --- avg_loss: 1.5778 

epoch: 17 avg_loss: 1.3535
val --- avg_loss: 1.5946 

epoch: 18 avg_loss: 1.3495
val --- avg_loss: 1.5960 

epoch: 19 avg_loss: 1.3435
val --- avg_loss: 1.5909 

epoch: 20 avg_loss: 1.3382
val --- avg_loss: 1.5973 

epoch: 21 avg_loss: 1.3313
val --- avg_loss: 1.6043 

epoch: 22 avg_loss: 1.3279
val --- avg_loss: 1.6459 

epoch: 23 avg_loss: 1.3249
val --- avg_loss: 1.6099 

epoch: 24 avg_loss: 1.3207
val --- avg_loss: 1.6217 

epoch: 25 avg_loss: 1.3155
val --- avg_loss: 1.6317 

epoch: 26 avg_loss: 1.3126
val --- avg_loss: 1.6319 

epoch: 27 avg_loss: 1.3087
val --- avg_loss: 1.6348 

epoch: 28 avg_loss: 1.3065
val --- avg_loss: 1.6355 

epoch: 29 avg_loss: 1.3029
val --- avg_loss: 1.6339 
