
number of params: 12908544 
Namespace(batchsize=128, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=1024, epochs=10, fig_path='model/vae/results/50000_instances/10epochs.png', kl_weight=0.1, log_path='model/vae/results/50000_instances/10epochs.log', logger=<common.utils.Logger object at 0x7f6070376c90>, lr=0.001, maxtrnsize=50000, maxtstsize=10000, maxvalsize=10000, mname='vae', model=VAE(
  (encoder): VAE_Encoder(
    (embed): Embedding(39, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=64, bias=False)
  )
  (decoder): VAE_Decoder(
    (embed): Embedding(39, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=39, bias=False)
    (loss): CrossEntropyLoss()
  )
), modelname='model/vae/results/50000_instances/', ni=512, nz=32, opt='Adam', save_path='model/vae/results/50000_instances/10epochs.pt', seq_to_no_pad='surface', surface_vocab_file='model/vae/data/surf.uniquesurfs.trn.txt', task='vae', trndata='model/vae/data/surf.uniquesurfs.trn.txt', trnsize=50000, tstdata='model/vae/data/surf.uniquesurfs.val.txt', tstsize=50000, valdata='model/vae/data/surf.uniquesurfs.val.txt', valsize=4000)

encoder.embed.weight, torch.Size([39, 512]): True
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): True
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
encoder.lstm.bias_ih_l0, torch.Size([4096]): True
encoder.lstm.bias_hh_l0, torch.Size([4096]): True
encoder.linear.weight, torch.Size([64, 1024]): True
decoder.embed.weight, torch.Size([39, 512]): True
decoder.trans_linear.weight, torch.Size([1024, 32]): True
decoder.lstm.weight_ih_l0, torch.Size([4096, 544]): True
decoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
decoder.lstm.bias_ih_l0, torch.Size([4096]): True
decoder.lstm.bias_hh_l0, torch.Size([4096]): True
decoder.pred_linear.weight, torch.Size([39, 1024]): True
epoch: 0 avg_loss: 23.3231, avg_recon_loss: 23.1515, avg_kl_loss: 0.1715, acc: 0.3072
val --- avg_loss: 20.8881, avg_recon_loss: 20.5544, avg_kl_loss: 0.3337, acc: 0.4133
update best loss 

epoch: 1 avg_loss: 17.9327, avg_recon_loss: 17.5718, avg_kl_loss: 0.3609, acc: 0.4407
val --- avg_loss: 17.5554, avg_recon_loss: 17.1613, avg_kl_loss: 0.3941, acc: 0.4909
update best loss 

epoch: 2 avg_loss: 15.4969, avg_recon_loss: 14.9914, avg_kl_loss: 0.5055, acc: 0.5168
val --- avg_loss: 15.8383, avg_recon_loss: 15.2189, avg_kl_loss: 0.6194, acc: 0.5447
update best loss 

epoch: 3 avg_loss: 13.6420, avg_recon_loss: 12.8246, avg_kl_loss: 0.8174, acc: 0.5868
val --- avg_loss: 13.4109, avg_recon_loss: 12.3854, avg_kl_loss: 1.0255, acc: 0.6288
update best loss 

epoch: 4 avg_loss: 12.0420, avg_recon_loss: 10.9472, avg_kl_loss: 1.0948, acc: 0.6484
val --- avg_loss: 11.7126, avg_recon_loss: 10.4949, avg_kl_loss: 1.2176, acc: 0.6843
update best loss 

epoch: 5 avg_loss: 10.6333, avg_recon_loss: 9.3595, avg_kl_loss: 1.2737, acc: 0.7018
val --- avg_loss: 10.7010, avg_recon_loss: 9.2720, avg_kl_loss: 1.4290, acc: 0.7239
update best loss 

epoch: 6 avg_loss: 9.4627, avg_recon_loss: 7.9612, avg_kl_loss: 1.5015, acc: 0.7456
val --- avg_loss: 9.1660, avg_recon_loss: 7.4893, avg_kl_loss: 1.6768, acc: 0.7773
update best loss 

epoch: 7 avg_loss: 8.2912, avg_recon_loss: 6.5832, avg_kl_loss: 1.7080, acc: 0.7905
val --- avg_loss: 8.4672, avg_recon_loss: 6.6198, avg_kl_loss: 1.8474, acc: 0.8054
update best loss 

epoch: 8 avg_loss: 7.4273, avg_recon_loss: 5.5678, avg_kl_loss: 1.8595, acc: 0.8230
val --- avg_loss: 8.1403, avg_recon_loss: 6.0975, avg_kl_loss: 2.0429, acc: 0.8240
update best loss 

epoch: 9 avg_loss: 6.6765, avg_recon_loss: 4.7131, avg_kl_loss: 1.9634, acc: 0.8501
val --- avg_loss: 6.6646, avg_recon_loss: 4.6314, avg_kl_loss: 2.0332, acc: 0.8685
update best loss 
