
number of params: 12904448 
Namespace(batchsize=128, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=1024, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=1024, epochs=12, fig_path='model/vae/results/training/617298_instances/12epochs.png', kl_anneal=True, kl_start=0.1, log_path='model/vae/results/training/617298_instances/12epochs.log', logger=<common.utils.Logger object at 0x7f26243ce410>, lr=0.001, maxtrnsize=617300, maxtstsize=10000, maxvalsize=10000, mname='vae', model=VAE(
  (encoder): VAE_Encoder(
    (embed): Embedding(37, 512)
    (lstm): LSTM(512, 1024, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=1024, out_features=64, bias=False)
  )
  (decoder): VAE_Decoder(
    (embed): Embedding(37, 512, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (trans_linear): Linear(in_features=32, out_features=1024, bias=False)
    (lstm): LSTM(544, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=37, bias=False)
    (loss): CrossEntropyLoss()
  )
), modelname='model/vae/results/training/617298_instances/', ni=512, nz=32, opt='Adam', save_path='model/vae/results/training/617298_instances/12epochs.pt', seq_to_no_pad='surface', surface_vocab_file='model/vae/data/wordlist.tur', task='vae', trndata='model/vae/data/wordlist.tur', trnsize=617298, tstdata='model/vae/data/wordlist.tur.val', tstsize=617298, valdata='model/vae/data/wordlist.tur.val', valsize=923, warm_up=10)

encoder.embed.weight, torch.Size([37, 512]): True
encoder.lstm.weight_ih_l0, torch.Size([4096, 512]): True
encoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
encoder.lstm.bias_ih_l0, torch.Size([4096]): True
encoder.lstm.bias_hh_l0, torch.Size([4096]): True
encoder.linear.weight, torch.Size([64, 1024]): True
decoder.embed.weight, torch.Size([37, 512]): True
decoder.trans_linear.weight, torch.Size([1024, 32]): True
decoder.lstm.weight_ih_l0, torch.Size([4096, 544]): True
decoder.lstm.weight_hh_l0, torch.Size([4096, 1024]): True
decoder.lstm.bias_ih_l0, torch.Size([4096]): True
decoder.lstm.bias_hh_l0, torch.Size([4096]): True
decoder.pred_linear.weight, torch.Size([37, 1024]): True
epoch: 0, kl_weight: 0.19, avg_loss: 20.6158, avg_recon_loss: 19.1956, avg_kl_loss: 1.4203, acc: 0.4771
val --- kl_weight: 0.19, avg_loss: 15.4393, avg_recon_loss: 12.3324, avg_kl_loss: 3.1069, acc: 0.6555
update best loss 

epoch: 1, kl_weight: 0.28, avg_loss: 14.9323, avg_recon_loss: 10.7976, avg_kl_loss: 4.1347, acc: 0.7019
val --- kl_weight: 0.28, avg_loss: 13.2061, avg_recon_loss: 8.0047, avg_kl_loss: 5.2014, acc: 0.7567
update best loss 

epoch: 2, kl_weight: 0.37, avg_loss: 14.0849, avg_recon_loss: 8.0279, avg_kl_loss: 6.0570, acc: 0.7732
val --- kl_weight: 0.37, avg_loss: 13.4965, avg_recon_loss: 6.9232, avg_kl_loss: 6.5733, acc: 0.7673

epoch: 3, kl_weight: 0.46, avg_loss: 14.7558, avg_recon_loss: 7.3434, avg_kl_loss: 7.4124, acc: 0.7924
val --- kl_weight: 0.46, avg_loss: 13.4093, avg_recon_loss: 5.7568, avg_kl_loss: 7.6525, acc: 0.7978

epoch: 4, kl_weight: 0.55, avg_loss: 15.7076, avg_recon_loss: 7.3753, avg_kl_loss: 8.3323, acc: 0.7902
val --- kl_weight: 0.55, avg_loss: 15.6138, avg_recon_loss: 7.3858, avg_kl_loss: 8.2280, acc: 0.7468

epoch: 5, kl_weight: 0.64, avg_loss: 16.7582, avg_recon_loss: 7.8936, avg_kl_loss: 8.8647, acc: 0.7748
val --- kl_weight: 0.64, avg_loss: 16.1662, avg_recon_loss: 7.5984, avg_kl_loss: 8.5678, acc: 0.7459

epoch: 6, kl_weight: 0.73, avg_loss: 17.7247, avg_recon_loss: 8.6192, avg_kl_loss: 9.1055, acc: 0.7530
val --- kl_weight: 0.73, avg_loss: 16.9113, avg_recon_loss: 7.9627, avg_kl_loss: 8.9486, acc: 0.7281

epoch: 7, kl_weight: 0.82, avg_loss: 18.6454, avg_recon_loss: 9.6819, avg_kl_loss: 8.9635, acc: 0.7222
val --- kl_weight: 0.82, avg_loss: 17.7223, avg_recon_loss: 9.3231, avg_kl_loss: 8.3993, acc: 0.6883

epoch: 8, kl_weight: 0.91, avg_loss: 19.4012, avg_recon_loss: 11.1216, avg_kl_loss: 8.2796, acc: 0.6810
val --- kl_weight: 0.91, avg_loss: 18.1098, avg_recon_loss: 10.5902, avg_kl_loss: 7.5196, acc: 0.6492

epoch: 9, kl_weight: 1.00, avg_loss: 19.9677, avg_recon_loss: 13.0241, avg_kl_loss: 6.9436, acc: 0.6272
val --- kl_weight: 1.00, avg_loss: 18.4769, avg_recon_loss: 12.5913, avg_kl_loss: 5.8857, acc: 0.6014

epoch: 10, kl_weight: 1.00, avg_loss: 19.9994, avg_recon_loss: 14.8559, avg_kl_loss: 5.1435, acc: 0.5742
val --- kl_weight: 1.00, avg_loss: 18.1256, avg_recon_loss: 13.6163, avg_kl_loss: 4.5093, acc: 0.5788

epoch: 11, kl_weight: 1.00, avg_loss: 19.7629, avg_recon_loss: 15.6547, avg_kl_loss: 4.1083, acc: 0.5505
val --- kl_weight: 1.00, avg_loss: 17.8655, avg_recon_loss: 14.1522, avg_kl_loss: 3.7133, acc: 0.5539
