
number of params: 3770880 
Namespace(batchsize=128, beta=0.5, bidirectional=True, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=128, dec_nh_tmp=128, device='cuda', embedding_dim=512, enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=512, epochs=200, fig_path='model/vqvae/results/training/28794_instances/bi_kl0.2_8x6_dec128_suffixd512/200epochs.png', incat=512, incat_tmp=512, log_path='model/vqvae/results/training/28794_instances/bi_kl0.2_8x6_dec128_suffixd512/200epochs.log', logger=<common.utils.Logger object at 0x7fa8420c7c90>, lr=0.001, maxtrnsize=10000000, maxtstsize=10000, maxvalsize=10000, mname='vqvae', model=VQVAE(
  (encoder): VQVAE_Encoder(
    (embed): Embedding(36, 256)
    (lstm): LSTM(256, 512, batch_first=True, bidirectional=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=512, out_features=256, bias=False)
  )
  (ord_vq_layers): ModuleList(
    (0): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (1): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (2): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (3): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (4): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (5): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (6): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
    (7): VectorQuantizer(
      (embedding): Embedding(6, 64)
    )
  )
  (decoder): VQVAE_Decoder(
    (embed): Embedding(36, 256, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (lstm): LSTM(768, 128, batch_first=True)
    (pred_linear): Linear(in_features=128, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
), model_prefix='bi_kl0.2_8x6_dec128_suffixd512/', modelname='model/vqvae/results/training/28794_instances/bi_kl0.2_8x6_dec128_suffixd512/', ni=256, num_dicts=8, num_dicts_tmp=8, nz=128, opt='Adam', orddict_emb_num=6, outcat=0, outcat_tmp=0, pretrained_model=VQVAE_AE(
  (encoder): VQVAE_Encoder(
    (embed): Embedding(36, 256)
    (lstm): LSTM(256, 512, batch_first=True, bidirectional=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
  )
  (decoder): VQVAE_Decoder(
    (embed): Embedding(36, 256, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (lstm): LSTM(256, 1024, batch_first=True)
    (pred_linear): Linear(in_features=1024, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
), root_linear_h=128, save_path='model/vqvae/results/training/28794_instances/bi_kl0.2_8x6_dec128_suffixd512/200epochs.pt', seq_to_no_pad='surface', surf_vocab=<common.vocab.VocabEntry object at 0x7fa8420d8e50>, surface_vocab_file='data/sigmorphon2016/zhou_merged', task='vqvae', trndata='data/sigmorphon2016/zhou_merged', trnsize=28794, tstdata='data/sigmorphon2016/turkish-task3-dev', tstsize=28794, valdata='data/sigmorphon2016/turkish-task3-dev', valsize=1589)

encoder.embed.weight, torch.Size([36, 256]): True
encoder.lstm.weight_ih_l0, torch.Size([2048, 256]): True
encoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0, torch.Size([2048]): True
encoder.lstm.bias_hh_l0, torch.Size([2048]): True
encoder.lstm.weight_ih_l0_reverse, torch.Size([2048, 256]): True
encoder.lstm.weight_hh_l0_reverse, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0_reverse, torch.Size([2048]): True
encoder.lstm.bias_hh_l0_reverse, torch.Size([2048]): True
encoder.linear.weight, torch.Size([256, 512]): True
ord_vq_layers.0.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.1.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.2.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.3.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.4.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.5.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.6.embedding.weight, torch.Size([6, 64]): True
ord_vq_layers.7.embedding.weight, torch.Size([6, 64]): True
decoder.embed.weight, torch.Size([36, 256]): True
decoder.lstm.weight_ih_l0, torch.Size([512, 768]): True
decoder.lstm.weight_hh_l0, torch.Size([512, 128]): True
decoder.lstm.bias_ih_l0, torch.Size([512]): True
decoder.lstm.bias_hh_l0, torch.Size([512]): True
decoder.pred_linear.weight, torch.Size([36, 128]): True
epoch: 0,  avg_loss: 31.7593, avg_recon_loss: 31.3553, avg_kl_loss: 0.3076, avg_vq_loss: 0.3425, ppl: 12.7054, acc: 0.2464, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 2290, unique_suffix_codes: 2290, logdet: 0.0000 
val ---  avg_loss: 25.7652, avg_recon_loss: 25.2218, avg_kl_loss: 0.5015, avg_vq_loss: 0.4432, ppl: 7.6729, acc: 0.3608, vq_inds: [5, 6, 5, 6, 6, 4, 5, 6], unique_vq_codes: 348, unique_suffix_codes: 348, val_unique_suffix_codes: 82 
update best loss 

epoch: 1,  avg_loss: 23.6753, avg_recon_loss: 22.7620, avg_kl_loss: 1.1316, avg_vq_loss: 0.6869, ppl: 6.3304, acc: 0.4219, vq_inds: [6, 6, 6, 6, 6, 5, 6, 6], unique_vq_codes: 1687, unique_suffix_codes: 1687, logdet: 0.0000 
val ---  avg_loss: 22.5153, avg_recon_loss: 21.0919, avg_kl_loss: 2.0088, avg_vq_loss: 1.0216, ppl: 5.4961, acc: 0.4520, vq_inds: [6, 6, 4, 6, 5, 4, 6, 2], unique_vq_codes: 376, unique_suffix_codes: 376, val_unique_suffix_codes: 75 
update best loss 

epoch: 2,  avg_loss: 21.2016, avg_recon_loss: 19.4213, avg_kl_loss: 3.0577, avg_vq_loss: 1.1688, ppl: 4.8284, acc: 0.5101, vq_inds: [6, 6, 5, 6, 6, 4, 6, 4], unique_vq_codes: 1580, unique_suffix_codes: 1580, logdet: 0.0000 
val ---  avg_loss: 20.1917, avg_recon_loss: 17.9310, avg_kl_loss: 4.4415, avg_vq_loss: 1.3725, ppl: 4.2574, acc: 0.5589, vq_inds: [6, 6, 5, 6, 6, 4, 6, 4], unique_vq_codes: 490, unique_suffix_codes: 490, val_unique_suffix_codes: 57 
update best loss 

epoch: 3,  avg_loss: 19.2884, avg_recon_loss: 16.7151, avg_kl_loss: 5.4156, avg_vq_loss: 1.4901, ppl: 3.8772, acc: 0.5841, vq_inds: [6, 6, 6, 6, 6, 6, 6, 4], unique_vq_codes: 2862, unique_suffix_codes: 2862, logdet: 0.0000 
val ---  avg_loss: 18.3121, avg_recon_loss: 15.2926, avg_kl_loss: 6.6177, avg_vq_loss: 1.6960, ppl: 3.4401, acc: 0.6176, vq_inds: [6, 6, 5, 6, 6, 6, 6, 4], unique_vq_codes: 764, unique_suffix_codes: 764, val_unique_suffix_codes: 108 
update best loss 

epoch: 4,  avg_loss: 17.7524, avg_recon_loss: 14.4291, avg_kl_loss: 7.6514, avg_vq_loss: 1.7930, ppl: 3.2213, acc: 0.6418, vq_inds: [6, 6, 6, 6, 6, 6, 6, 5], unique_vq_codes: 4546, unique_suffix_codes: 4546, logdet: 0.0000 
val ---  avg_loss: 16.7771, avg_recon_loss: 12.9054, avg_kl_loss: 9.2746, avg_vq_loss: 2.0168, ppl: 2.8367, acc: 0.6788, vq_inds: [6, 6, 6, 6, 6, 6, 6, 4], unique_vq_codes: 975, unique_suffix_codes: 975, val_unique_suffix_codes: 208 
update best loss 

epoch: 5,  avg_loss: 16.6213, avg_recon_loss: 12.4650, avg_kl_loss: 9.7934, avg_vq_loss: 2.1976, ppl: 2.7471, acc: 0.6905, vq_inds: [6, 6, 6, 6, 6, 6, 6, 5], unique_vq_codes: 6644, unique_suffix_codes: 6644, logdet: 0.0000 
val ---  avg_loss: 15.8099, avg_recon_loss: 11.2888, avg_kl_loss: 10.8131, avg_vq_loss: 2.3585, ppl: 2.4894, acc: 0.7213, vq_inds: [6, 6, 6, 6, 6, 6, 6, 5], unique_vq_codes: 1219, unique_suffix_codes: 1219, val_unique_suffix_codes: 302 
update best loss 

epoch: 6,  avg_loss: 15.5590, avg_recon_loss: 10.8315, avg_kl_loss: 11.6893, avg_vq_loss: 2.3896, ppl: 2.4064, acc: 0.7315, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 8979, unique_suffix_codes: 8979, logdet: 0.0000 
val ---  avg_loss: 14.7667, avg_recon_loss: 9.5643, avg_kl_loss: 12.4752, avg_vq_loss: 2.7073, ppl: 2.1656, acc: 0.7678, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1320, unique_suffix_codes: 1320, val_unique_suffix_codes: 364 
update best loss 

epoch: 7,  avg_loss: 14.6846, avg_recon_loss: 9.2935, avg_kl_loss: 12.9938, avg_vq_loss: 2.7923, ppl: 2.1243, acc: 0.7713, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 11795, unique_suffix_codes: 11795, logdet: 0.0000 
val ---  avg_loss: 13.8813, avg_recon_loss: 8.2170, avg_kl_loss: 13.4140, avg_vq_loss: 2.9815, ppl: 1.9423, acc: 0.8001, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1404, unique_suffix_codes: 1404, val_unique_suffix_codes: 392 
update best loss 

epoch: 8,  avg_loss: 14.2679, avg_recon_loss: 8.3477, avg_kl_loss: 14.0505, avg_vq_loss: 3.1101, ppl: 1.9675, acc: 0.7926, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 14098, unique_suffix_codes: 14098, logdet: 0.0000 
val ---  avg_loss: 13.6881, avg_recon_loss: 7.4550, avg_kl_loss: 14.6222, avg_vq_loss: 3.3087, ppl: 1.8263, acc: 0.8171, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1424, unique_suffix_codes: 1424, val_unique_suffix_codes: 536 
update best loss 

epoch: 9,  avg_loss: 13.5326, avg_recon_loss: 7.2974, avg_kl_loss: 14.8135, avg_vq_loss: 3.2724, ppl: 1.8069, acc: 0.8195, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 15149, unique_suffix_codes: 15149, logdet: 0.0000 
val ---  avg_loss: 13.0029, avg_recon_loss: 6.7053, avg_kl_loss: 14.9832, avg_vq_loss: 3.3009, ppl: 1.7190, acc: 0.8360, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1443, unique_suffix_codes: 1443, val_unique_suffix_codes: 511 
update best loss 

epoch: 10,  avg_loss: 12.8753, avg_recon_loss: 6.4707, avg_kl_loss: 15.2584, avg_vq_loss: 3.3530, ppl: 1.6898, acc: 0.8391, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 16186, unique_suffix_codes: 16186, logdet: 0.0000 
val ---  avg_loss: 12.7037, avg_recon_loss: 6.2394, avg_kl_loss: 14.7578, avg_vq_loss: 3.5127, ppl: 1.6555, acc: 0.8463, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1477, unique_suffix_codes: 1477, val_unique_suffix_codes: 539 
update best loss 

epoch: 11,  avg_loss: 12.4203, avg_recon_loss: 5.8070, avg_kl_loss: 15.6452, avg_vq_loss: 3.4843, ppl: 1.6012, acc: 0.8544, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 16937, unique_suffix_codes: 16937, logdet: 0.0000 
val ---  avg_loss: 12.0196, avg_recon_loss: 5.0564, avg_kl_loss: 16.1605, avg_vq_loss: 3.7311, ppl: 1.5046, acc: 0.8751, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1492, unique_suffix_codes: 1492, val_unique_suffix_codes: 554 
update best loss 

epoch: 12,  avg_loss: 12.0520, avg_recon_loss: 5.3040, avg_kl_loss: 15.6610, avg_vq_loss: 3.6158, ppl: 1.5373, acc: 0.8667, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 17584, unique_suffix_codes: 17584, logdet: 0.0000 
val ---  avg_loss: 11.4941, avg_recon_loss: 4.5357, avg_kl_loss: 16.1663, avg_vq_loss: 3.7251, ppl: 1.4426, acc: 0.8857, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1482, unique_suffix_codes: 1482, val_unique_suffix_codes: 504 
update best loss 

epoch: 13,  avg_loss: 11.8829, avg_recon_loss: 4.9859, avg_kl_loss: 15.9143, avg_vq_loss: 3.7141, ppl: 1.4981, acc: 0.8741, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 17917, unique_suffix_codes: 17917, logdet: 0.0000 
val ---  avg_loss: 11.2158, avg_recon_loss: 4.2509, avg_kl_loss: 16.0841, avg_vq_loss: 3.7480, ppl: 1.4098, acc: 0.8949, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1490, unique_suffix_codes: 1490, val_unique_suffix_codes: 528 
update best loss 

epoch: 14,  avg_loss: 11.6099, avg_recon_loss: 4.6030, avg_kl_loss: 15.9272, avg_vq_loss: 3.8215, ppl: 1.4523, acc: 0.8841, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 18201, unique_suffix_codes: 18201, logdet: 0.0000 
val ---  avg_loss: 11.2892, avg_recon_loss: 4.1986, avg_kl_loss: 15.6688, avg_vq_loss: 3.9569, ppl: 1.4038, acc: 0.8928, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1512, unique_suffix_codes: 1512, val_unique_suffix_codes: 639 

epoch: 15,  avg_loss: 11.4963, avg_recon_loss: 4.3591, avg_kl_loss: 15.9119, avg_vq_loss: 3.9549, ppl: 1.4239, acc: 0.8890, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 18811, unique_suffix_codes: 18811, logdet: 0.0000 
val ---  avg_loss: 11.0076, avg_recon_loss: 3.7258, avg_kl_loss: 16.0994, avg_vq_loss: 4.0620, ppl: 1.3512, acc: 0.9072, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1512, unique_suffix_codes: 1512, val_unique_suffix_codes: 575 
update best loss 

epoch: 16,  avg_loss: 11.2940, avg_recon_loss: 4.0717, avg_kl_loss: 15.8773, avg_vq_loss: 4.0468, ppl: 1.3911, acc: 0.8963, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 19308, unique_suffix_codes: 19308, logdet: 0.0000 
val ---  avg_loss: 11.3805, avg_recon_loss: 4.1250, avg_kl_loss: 15.7111, avg_vq_loss: 4.1134, ppl: 1.3955, acc: 0.8967, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1497, unique_suffix_codes: 1497, val_unique_suffix_codes: 611 

epoch: 17,  avg_loss: 11.3486, avg_recon_loss: 4.0394, avg_kl_loss: 15.9519, avg_vq_loss: 4.1188, ppl: 1.3875, acc: 0.8966, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 19227, unique_suffix_codes: 19227, logdet: 0.0000 
val ---  avg_loss: 10.8579, avg_recon_loss: 3.5612, avg_kl_loss: 15.9985, avg_vq_loss: 4.0969, ppl: 1.3334, acc: 0.9097, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1504, unique_suffix_codes: 1504, val_unique_suffix_codes: 640 
update best loss 

epoch: 18,  avg_loss: 10.9015, avg_recon_loss: 3.6222, avg_kl_loss: 15.7711, avg_vq_loss: 4.1250, ppl: 1.3413, acc: 0.9071, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 19741, unique_suffix_codes: 19741, logdet: 0.0000 
val ---  avg_loss: 11.1686, avg_recon_loss: 3.5978, avg_kl_loss: 15.6035, avg_vq_loss: 4.4501, ppl: 1.3373, acc: 0.9087, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1517, unique_suffix_codes: 1517, val_unique_suffix_codes: 652 

epoch: 19,  avg_loss: 10.8733, avg_recon_loss: 3.4942, avg_kl_loss: 15.7783, avg_vq_loss: 4.2234, ppl: 1.3275, acc: 0.9101, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20206, unique_suffix_codes: 20206, logdet: 0.0000 
val ---  avg_loss: 10.6419, avg_recon_loss: 3.3491, avg_kl_loss: 15.3839, avg_vq_loss: 4.2160, ppl: 1.3107, acc: 0.9147, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1518, unique_suffix_codes: 1518, val_unique_suffix_codes: 671 
update best loss 

epoch: 20,  avg_loss: 10.9973, avg_recon_loss: 3.5346, avg_kl_loss: 15.7893, avg_vq_loss: 4.3048, ppl: 1.3318, acc: 0.9087, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20222, unique_suffix_codes: 20222, logdet: 0.0000 
val ---  avg_loss: 10.5752, avg_recon_loss: 3.0187, avg_kl_loss: 15.7414, avg_vq_loss: 4.4082, ppl: 1.2762, acc: 0.9224, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1531, unique_suffix_codes: 1531, val_unique_suffix_codes: 674 
update best loss 

epoch: 21,  avg_loss: 10.8413, avg_recon_loss: 3.3430, avg_kl_loss: 15.7220, avg_vq_loss: 4.3538, ppl: 1.3113, acc: 0.9141, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20540, unique_suffix_codes: 20540, logdet: 0.0000 
val ---  avg_loss: 10.5685, avg_recon_loss: 2.9285, avg_kl_loss: 15.7969, avg_vq_loss: 4.4806, ppl: 1.2669, acc: 0.9267, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1529, unique_suffix_codes: 1529, val_unique_suffix_codes: 645 
update best loss 

epoch: 22,  avg_loss: 10.7980, avg_recon_loss: 3.2651, avg_kl_loss: 15.7552, avg_vq_loss: 4.3819, ppl: 1.3030, acc: 0.9163, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20403, unique_suffix_codes: 20403, logdet: 0.0000 
val ---  avg_loss: 10.2500, avg_recon_loss: 2.7354, avg_kl_loss: 15.5431, avg_vq_loss: 4.4059, ppl: 1.2473, acc: 0.9315, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1532, unique_suffix_codes: 1532, val_unique_suffix_codes: 625 
update best loss 

epoch: 23,  avg_loss: 10.5387, avg_recon_loss: 3.0512, avg_kl_loss: 15.5944, avg_vq_loss: 4.3687, ppl: 1.2806, acc: 0.9211, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20851, unique_suffix_codes: 20851, logdet: 0.0000 
val ---  avg_loss: 10.4607, avg_recon_loss: 2.7632, avg_kl_loss: 15.6940, avg_vq_loss: 4.5587, ppl: 1.2501, acc: 0.9287, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1530, unique_suffix_codes: 1530, val_unique_suffix_codes: 670 

epoch: 24,  avg_loss: 10.5134, avg_recon_loss: 2.9991, avg_kl_loss: 15.4531, avg_vq_loss: 4.4236, ppl: 1.2753, acc: 0.9231, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 20837, unique_suffix_codes: 20837, logdet: 0.0000 
val ---  avg_loss: 9.9947, avg_recon_loss: 2.5517, avg_kl_loss: 15.0466, avg_vq_loss: 4.4337, ppl: 1.2289, acc: 0.9350, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1536, unique_suffix_codes: 1536, val_unique_suffix_codes: 612 
update best loss 

epoch: 25,  avg_loss: 10.3746, avg_recon_loss: 2.8601, avg_kl_loss: 15.4527, avg_vq_loss: 4.4240, ppl: 1.2610, acc: 0.9259, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21236, unique_suffix_codes: 21236, logdet: 0.0000 
val ---  avg_loss: 10.6147, avg_recon_loss: 2.7959, avg_kl_loss: 16.4733, avg_vq_loss: 4.5241, ppl: 1.2534, acc: 0.9296, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1538, unique_suffix_codes: 1538, val_unique_suffix_codes: 684 

epoch: 26,  avg_loss: 10.3014, avg_recon_loss: 2.7916, avg_kl_loss: 15.3647, avg_vq_loss: 4.4368, ppl: 1.2540, acc: 0.9276, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21459, unique_suffix_codes: 21459, logdet: 0.0000 
val ---  avg_loss: 9.9866, avg_recon_loss: 2.3900, avg_kl_loss: 15.2831, avg_vq_loss: 4.5400, ppl: 1.2130, acc: 0.9409, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1536, unique_suffix_codes: 1536, val_unique_suffix_codes: 659 
update best loss 

epoch: 27,  avg_loss: 10.1242, avg_recon_loss: 2.6366, avg_kl_loss: 15.1738, avg_vq_loss: 4.4529, ppl: 1.2383, acc: 0.9316, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21583, unique_suffix_codes: 21583, logdet: 0.0000 
val ---  avg_loss: 10.0997, avg_recon_loss: 2.6088, avg_kl_loss: 15.0181, avg_vq_loss: 4.4872, ppl: 1.2346, acc: 0.9304, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1529, unique_suffix_codes: 1529, val_unique_suffix_codes: 682 

epoch: 28,  avg_loss: 10.3089, avg_recon_loss: 2.7307, avg_kl_loss: 15.2584, avg_vq_loss: 4.5265, ppl: 1.2478, acc: 0.9293, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21781, unique_suffix_codes: 21781, logdet: 0.0000 
val ---  avg_loss: 10.0611, avg_recon_loss: 2.3560, avg_kl_loss: 15.5223, avg_vq_loss: 4.6006, ppl: 1.2097, acc: 0.9403, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1542, unique_suffix_codes: 1542, val_unique_suffix_codes: 703 

epoch: 29,  avg_loss: 10.1710, avg_recon_loss: 2.6110, avg_kl_loss: 15.1053, avg_vq_loss: 4.5389, ppl: 1.2357, acc: 0.9326, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21803, unique_suffix_codes: 21803, logdet: 0.0000 
val ---  avg_loss: 9.8328, avg_recon_loss: 2.2024, avg_kl_loss: 15.5123, avg_vq_loss: 4.5279, ppl: 1.1947, acc: 0.9428, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1537, unique_suffix_codes: 1537, val_unique_suffix_codes: 659 
update best loss 

epoch: 30,  avg_loss: 10.1328, avg_recon_loss: 2.5346, avg_kl_loss: 15.1666, avg_vq_loss: 4.5649, ppl: 1.2281, acc: 0.9347, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 21891, unique_suffix_codes: 21891, logdet: 0.0000 
val ---  avg_loss: 9.7963, avg_recon_loss: 2.1973, avg_kl_loss: 14.7238, avg_vq_loss: 4.6543, ppl: 1.1943, acc: 0.9446, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1542, unique_suffix_codes: 1542, val_unique_suffix_codes: 634 
update best loss 

epoch: 31,  avg_loss: 9.9514, avg_recon_loss: 2.4046, avg_kl_loss: 14.8782, avg_vq_loss: 4.5712, ppl: 1.2152, acc: 0.9379, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22055, unique_suffix_codes: 22055, logdet: 0.0000 
val ---  avg_loss: 9.5175, avg_recon_loss: 1.9585, avg_kl_loss: 14.9943, avg_vq_loss: 4.5601, ppl: 1.1714, acc: 0.9491, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1535, unique_suffix_codes: 1535, val_unique_suffix_codes: 609 
update best loss 

epoch: 32,  avg_loss: 9.9757, avg_recon_loss: 2.4062, avg_kl_loss: 14.8568, avg_vq_loss: 4.5982, ppl: 1.2154, acc: 0.9378, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22160, unique_suffix_codes: 22160, logdet: 0.0000 
val ---  avg_loss: 9.6447, avg_recon_loss: 1.9742, avg_kl_loss: 15.0709, avg_vq_loss: 4.6564, ppl: 1.1729, acc: 0.9509, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1543, unique_suffix_codes: 1543, val_unique_suffix_codes: 665 

epoch: 33,  avg_loss: 9.8534, avg_recon_loss: 2.2935, avg_kl_loss: 14.6996, avg_vq_loss: 4.6199, ppl: 1.2043, acc: 0.9411, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22118, unique_suffix_codes: 22118, logdet: 0.0000 
val ---  avg_loss: 9.7900, avg_recon_loss: 2.0827, avg_kl_loss: 14.8993, avg_vq_loss: 4.7274, ppl: 1.1832, acc: 0.9461, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1545, unique_suffix_codes: 1545, val_unique_suffix_codes: 676 

epoch: 34,  avg_loss: 9.8961, avg_recon_loss: 2.3414, avg_kl_loss: 14.7735, avg_vq_loss: 4.6000, ppl: 1.2090, acc: 0.9397, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22316, unique_suffix_codes: 22316, logdet: 0.0000 
val ---  avg_loss: 9.7561, avg_recon_loss: 2.1380, avg_kl_loss: 14.9246, avg_vq_loss: 4.6332, ppl: 1.1885, acc: 0.9443, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1545, unique_suffix_codes: 1545, val_unique_suffix_codes: 732 

epoch: 35,  avg_loss: 9.9542, avg_recon_loss: 2.3840, avg_kl_loss: 14.6879, avg_vq_loss: 4.6327, ppl: 1.2132, acc: 0.9385, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22190, unique_suffix_codes: 22190, logdet: 0.0000 
val ---  avg_loss: 9.3849, avg_recon_loss: 1.8642, avg_kl_loss: 14.5057, avg_vq_loss: 4.6196, ppl: 1.1625, acc: 0.9512, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1548, unique_suffix_codes: 1548, val_unique_suffix_codes: 645 
update best loss 

epoch: 36,  avg_loss: 9.9125, avg_recon_loss: 2.2872, avg_kl_loss: 14.6844, avg_vq_loss: 4.6884, ppl: 1.2037, acc: 0.9409, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22426, unique_suffix_codes: 22426, logdet: 0.0000 
val ---  avg_loss: 9.5093, avg_recon_loss: 1.9730, avg_kl_loss: 14.4545, avg_vq_loss: 4.6455, ppl: 1.1728, acc: 0.9507, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 645 

epoch: 37,  avg_loss: 9.7159, avg_recon_loss: 2.1737, avg_kl_loss: 14.3771, avg_vq_loss: 4.6667, ppl: 1.1927, acc: 0.9437, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22528, unique_suffix_codes: 22528, logdet: 0.0000 
val ---  avg_loss: 9.5805, avg_recon_loss: 1.9911, avg_kl_loss: 14.3355, avg_vq_loss: 4.7222, ppl: 1.1745, acc: 0.9491, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 665 

epoch: 38,  avg_loss: 9.8560, avg_recon_loss: 2.2412, avg_kl_loss: 14.4870, avg_vq_loss: 4.7174, ppl: 1.1993, acc: 0.9420, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22588, unique_suffix_codes: 22588, logdet: 0.0000 
val ---  avg_loss: 9.4190, avg_recon_loss: 1.7657, avg_kl_loss: 14.5969, avg_vq_loss: 4.7339, ppl: 1.1533, acc: 0.9554, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1555, unique_suffix_codes: 1555, val_unique_suffix_codes: 704 

epoch: 39,  avg_loss: 9.6607, avg_recon_loss: 2.1303, avg_kl_loss: 14.2482, avg_vq_loss: 4.6807, ppl: 1.1885, acc: 0.9453, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22594, unique_suffix_codes: 22594, logdet: 0.0000 
val ---  avg_loss: 9.2704, avg_recon_loss: 1.7248, avg_kl_loss: 14.1667, avg_vq_loss: 4.7122, ppl: 1.1495, acc: 0.9573, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 638 
update best loss 

epoch: 40,  avg_loss: 9.5874, avg_recon_loss: 2.0567, avg_kl_loss: 14.1523, avg_vq_loss: 4.7003, ppl: 1.1814, acc: 0.9473, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22702, unique_suffix_codes: 22702, logdet: 0.0000 
val ---  avg_loss: 9.4809, avg_recon_loss: 1.9073, avg_kl_loss: 14.2122, avg_vq_loss: 4.7311, ppl: 1.1666, acc: 0.9521, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 690 

epoch: 41,  avg_loss: 9.5458, avg_recon_loss: 2.0289, avg_kl_loss: 14.1814, avg_vq_loss: 4.6807, ppl: 1.1788, acc: 0.9479, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22725, unique_suffix_codes: 22725, logdet: 0.0000 
val ---  avg_loss: 9.4181, avg_recon_loss: 1.8905, avg_kl_loss: 14.2053, avg_vq_loss: 4.6866, ppl: 1.1650, acc: 0.9530, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 704 

epoch: 42,  avg_loss: 9.5675, avg_recon_loss: 2.0564, avg_kl_loss: 14.1084, avg_vq_loss: 4.6895, ppl: 1.1814, acc: 0.9467, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23076, unique_suffix_codes: 23076, logdet: 0.0000 
val ---  avg_loss: 9.3418, avg_recon_loss: 1.8254, avg_kl_loss: 14.3118, avg_vq_loss: 4.6541, ppl: 1.1589, acc: 0.9533, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1550, unique_suffix_codes: 1550, val_unique_suffix_codes: 699 

epoch: 43,  avg_loss: 9.6188, avg_recon_loss: 2.0845, avg_kl_loss: 14.1613, avg_vq_loss: 4.7021, ppl: 1.1841, acc: 0.9459, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22995, unique_suffix_codes: 22995, logdet: 0.0000 
val ---  avg_loss: 9.5532, avg_recon_loss: 1.8407, avg_kl_loss: 14.6729, avg_vq_loss: 4.7778, ppl: 1.1603, acc: 0.9519, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1549, unique_suffix_codes: 1549, val_unique_suffix_codes: 719 

epoch: 44,  avg_loss: 9.6690, avg_recon_loss: 2.0624, avg_kl_loss: 14.2997, avg_vq_loss: 4.7467, ppl: 1.1820, acc: 0.9465, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 22991, unique_suffix_codes: 22991, logdet: 0.0000 
val ---  avg_loss: 9.2472, avg_recon_loss: 1.6461, avg_kl_loss: 14.1516, avg_vq_loss: 4.7707, ppl: 1.1422, acc: 0.9582, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 660 
update best loss 

epoch: 45,  avg_loss: 9.5376, avg_recon_loss: 2.0096, avg_kl_loss: 14.0117, avg_vq_loss: 4.7256, ppl: 1.1769, acc: 0.9480, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23041, unique_suffix_codes: 23041, logdet: 0.0000 
val ---  avg_loss: 9.2219, avg_recon_loss: 1.7237, avg_kl_loss: 13.9863, avg_vq_loss: 4.7009, ppl: 1.1494, acc: 0.9561, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1556, unique_suffix_codes: 1556, val_unique_suffix_codes: 652 
update best loss 

epoch: 46,  avg_loss: 9.4738, avg_recon_loss: 1.9700, avg_kl_loss: 13.8880, avg_vq_loss: 4.7262, ppl: 1.1732, acc: 0.9490, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23082, unique_suffix_codes: 23082, logdet: 0.0000 
val ---  avg_loss: 9.2282, avg_recon_loss: 1.6556, avg_kl_loss: 14.3761, avg_vq_loss: 4.6974, ppl: 1.1431, acc: 0.9574, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1541, unique_suffix_codes: 1541, val_unique_suffix_codes: 657 

epoch: 47,  avg_loss: 9.5885, avg_recon_loss: 2.0227, avg_kl_loss: 14.0398, avg_vq_loss: 4.7579, ppl: 1.1782, acc: 0.9477, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23108, unique_suffix_codes: 23108, logdet: 0.0000 
val ---  avg_loss: 9.3300, avg_recon_loss: 1.6340, avg_kl_loss: 14.3815, avg_vq_loss: 4.8198, ppl: 1.1411, acc: 0.9599, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1549, unique_suffix_codes: 1549, val_unique_suffix_codes: 700 

epoch: 48,  avg_loss: 9.4776, avg_recon_loss: 1.9512, avg_kl_loss: 13.8588, avg_vq_loss: 4.7547, ppl: 1.1714, acc: 0.9498, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23171, unique_suffix_codes: 23171, logdet: 0.0000 
val ---  avg_loss: 9.1577, avg_recon_loss: 1.6590, avg_kl_loss: 13.5900, avg_vq_loss: 4.7807, ppl: 1.1434, acc: 0.9580, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1560, unique_suffix_codes: 1560, val_unique_suffix_codes: 656 
update best loss 

epoch: 49,  avg_loss: 9.3362, avg_recon_loss: 1.8735, avg_kl_loss: 13.5994, avg_vq_loss: 4.7428, ppl: 1.1640, acc: 0.9515, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23363, unique_suffix_codes: 23363, logdet: 0.0000 
val ---  avg_loss: 9.0714, avg_recon_loss: 1.4849, avg_kl_loss: 14.0092, avg_vq_loss: 4.7846, ppl: 1.1275, acc: 0.9638, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1555, unique_suffix_codes: 1555, val_unique_suffix_codes: 658 
update best loss 

epoch: 50,  avg_loss: 9.3156, avg_recon_loss: 1.8572, avg_kl_loss: 13.7459, avg_vq_loss: 4.7092, ppl: 1.1625, acc: 0.9521, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23267, unique_suffix_codes: 23267, logdet: 0.0000 
val ---  avg_loss: 9.0398, avg_recon_loss: 1.6511, avg_kl_loss: 13.4257, avg_vq_loss: 4.7036, ppl: 1.1427, acc: 0.9573, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 663 
update best loss 

epoch: 51,  avg_loss: 9.4087, avg_recon_loss: 1.9124, avg_kl_loss: 13.6210, avg_vq_loss: 4.7721, ppl: 1.1677, acc: 0.9503, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23403, unique_suffix_codes: 23403, logdet: 0.0000 
val ---  avg_loss: 9.1101, avg_recon_loss: 1.5808, avg_kl_loss: 13.6396, avg_vq_loss: 4.8014, ppl: 1.1362, acc: 0.9603, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1552, unique_suffix_codes: 1552, val_unique_suffix_codes: 683 

epoch: 52,  avg_loss: 9.3454, avg_recon_loss: 1.8703, avg_kl_loss: 13.5932, avg_vq_loss: 4.7564, ppl: 1.1637, acc: 0.9514, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23429, unique_suffix_codes: 23429, logdet: 0.0000 
val ---  avg_loss: 9.0206, avg_recon_loss: 1.5385, avg_kl_loss: 13.5775, avg_vq_loss: 4.7666, ppl: 1.1324, acc: 0.9621, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 625 
update best loss 

epoch: 53,  avg_loss: 9.3049, avg_recon_loss: 1.8322, avg_kl_loss: 13.5464, avg_vq_loss: 4.7635, ppl: 1.1601, acc: 0.9530, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23398, unique_suffix_codes: 23398, logdet: 0.0000 
val ---  avg_loss: 8.9866, avg_recon_loss: 1.5362, avg_kl_loss: 13.4437, avg_vq_loss: 4.7617, ppl: 1.1321, acc: 0.9613, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1544, unique_suffix_codes: 1544, val_unique_suffix_codes: 659 
update best loss 

epoch: 54,  avg_loss: 9.3268, avg_recon_loss: 1.8240, avg_kl_loss: 13.5342, avg_vq_loss: 4.7959, ppl: 1.1594, acc: 0.9533, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23626, unique_suffix_codes: 23626, logdet: 0.0000 
val ---  avg_loss: 8.9245, avg_recon_loss: 1.3956, avg_kl_loss: 13.9446, avg_vq_loss: 4.7400, ppl: 1.1194, acc: 0.9646, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 671 
update best loss 

epoch: 55,  avg_loss: 9.3016, avg_recon_loss: 1.8474, avg_kl_loss: 13.4611, avg_vq_loss: 4.7620, ppl: 1.1616, acc: 0.9521, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23623, unique_suffix_codes: 23623, logdet: 0.0000 
val ---  avg_loss: 8.9191, avg_recon_loss: 1.4160, avg_kl_loss: 13.4099, avg_vq_loss: 4.8211, ppl: 1.1212, acc: 0.9646, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 694 
update best loss 

epoch: 56,  avg_loss: 9.2963, avg_recon_loss: 1.8258, avg_kl_loss: 13.5218, avg_vq_loss: 4.7661, ppl: 1.1595, acc: 0.9533, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23679, unique_suffix_codes: 23679, logdet: 0.0000 
val ---  avg_loss: 9.1755, avg_recon_loss: 1.6336, avg_kl_loss: 13.8446, avg_vq_loss: 4.7730, ppl: 1.1411, acc: 0.9583, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1547, unique_suffix_codes: 1547, val_unique_suffix_codes: 669 

epoch: 57,  avg_loss: 9.2836, avg_recon_loss: 1.8226, avg_kl_loss: 13.3861, avg_vq_loss: 4.7837, ppl: 1.1592, acc: 0.9530, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23677, unique_suffix_codes: 23677, logdet: 0.0000 
val ---  avg_loss: 9.0750, avg_recon_loss: 1.6001, avg_kl_loss: 13.2541, avg_vq_loss: 4.8242, ppl: 1.1380, acc: 0.9595, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1549, unique_suffix_codes: 1549, val_unique_suffix_codes: 663 

epoch: 58,  avg_loss: 9.3148, avg_recon_loss: 1.8458, avg_kl_loss: 13.4795, avg_vq_loss: 4.7731, ppl: 1.1614, acc: 0.9521, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23772, unique_suffix_codes: 23772, logdet: 0.0000 
val ---  avg_loss: 8.9749, avg_recon_loss: 1.4682, avg_kl_loss: 13.3486, avg_vq_loss: 4.8369, ppl: 1.1259, acc: 0.9620, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1558, unique_suffix_codes: 1558, val_unique_suffix_codes: 657 

epoch: 59,  avg_loss: 9.2352, avg_recon_loss: 1.7508, avg_kl_loss: 13.3465, avg_vq_loss: 4.8151, ppl: 1.1525, acc: 0.9548, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23835, unique_suffix_codes: 23835, logdet: 0.0000 
val ---  avg_loss: 9.0888, avg_recon_loss: 1.4965, avg_kl_loss: 13.5452, avg_vq_loss: 4.8832, ppl: 1.1285, acc: 0.9631, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1556, unique_suffix_codes: 1556, val_unique_suffix_codes: 648 

epoch: 60,  avg_loss: 9.1613, avg_recon_loss: 1.7322, avg_kl_loss: 13.2234, avg_vq_loss: 4.7845, ppl: 1.1508, acc: 0.9556, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23703, unique_suffix_codes: 23703, logdet: 0.0000 
val ---  avg_loss: 8.8138, avg_recon_loss: 1.3587, avg_kl_loss: 13.2248, avg_vq_loss: 4.8102, ppl: 1.1160, acc: 0.9650, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 665 
update best loss 

epoch: 61,  avg_loss: 9.0626, avg_recon_loss: 1.6720, avg_kl_loss: 13.1436, avg_vq_loss: 4.7619, ppl: 1.1452, acc: 0.9568, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23905, unique_suffix_codes: 23905, logdet: 0.0000 
val ---  avg_loss: 8.8929, avg_recon_loss: 1.4349, avg_kl_loss: 13.3814, avg_vq_loss: 4.7817, ppl: 1.1229, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1549, unique_suffix_codes: 1549, val_unique_suffix_codes: 642 

epoch: 62,  avg_loss: 9.3009, avg_recon_loss: 1.8284, avg_kl_loss: 13.3182, avg_vq_loss: 4.8088, ppl: 1.1598, acc: 0.9532, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23834, unique_suffix_codes: 23834, logdet: 0.0000 
val ---  avg_loss: 9.1062, avg_recon_loss: 1.6356, avg_kl_loss: 13.2665, avg_vq_loss: 4.8173, ppl: 1.1413, acc: 0.9588, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 703 

epoch: 63,  avg_loss: 9.1838, avg_recon_loss: 1.7348, avg_kl_loss: 13.2005, avg_vq_loss: 4.8089, ppl: 1.1510, acc: 0.9555, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23730, unique_suffix_codes: 23730, logdet: 0.0000 
val ---  avg_loss: 8.8886, avg_recon_loss: 1.4936, avg_kl_loss: 12.8574, avg_vq_loss: 4.8235, ppl: 1.1283, acc: 0.9621, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 659 

epoch: 64,  avg_loss: 9.0790, avg_recon_loss: 1.6628, avg_kl_loss: 13.0097, avg_vq_loss: 4.8143, ppl: 1.1443, acc: 0.9574, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23933, unique_suffix_codes: 23933, logdet: 0.0000 
val ---  avg_loss: 8.8131, avg_recon_loss: 1.3656, avg_kl_loss: 13.1364, avg_vq_loss: 4.8202, ppl: 1.1166, acc: 0.9657, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 631 
update best loss 

epoch: 65,  avg_loss: 9.0557, avg_recon_loss: 1.6705, avg_kl_loss: 12.9294, avg_vq_loss: 4.7993, ppl: 1.1450, acc: 0.9572, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23855, unique_suffix_codes: 23855, logdet: 0.0000 
val ---  avg_loss: 8.8487, avg_recon_loss: 1.4289, avg_kl_loss: 13.0354, avg_vq_loss: 4.8128, ppl: 1.1224, acc: 0.9643, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1556, unique_suffix_codes: 1556, val_unique_suffix_codes: 653 

epoch: 66,  avg_loss: 9.1313, avg_recon_loss: 1.6933, avg_kl_loss: 13.0296, avg_vq_loss: 4.8321, ppl: 1.1471, acc: 0.9561, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23903, unique_suffix_codes: 23903, logdet: 0.0000 
val ---  avg_loss: 8.9214, avg_recon_loss: 1.3947, avg_kl_loss: 13.0998, avg_vq_loss: 4.9068, ppl: 1.1193, acc: 0.9667, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1554, unique_suffix_codes: 1554, val_unique_suffix_codes: 666 

epoch: 67,  avg_loss: 9.1276, avg_recon_loss: 1.6944, avg_kl_loss: 13.0315, avg_vq_loss: 4.8268, ppl: 1.1473, acc: 0.9566, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23802, unique_suffix_codes: 23802, logdet: 0.0000 
val ---  avg_loss: 8.6696, avg_recon_loss: 1.2668, avg_kl_loss: 13.0280, avg_vq_loss: 4.7972, ppl: 1.1078, acc: 0.9694, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 646 
update best loss 

epoch: 68,  avg_loss: 8.9933, avg_recon_loss: 1.6196, avg_kl_loss: 12.8230, avg_vq_loss: 4.8090, ppl: 1.1403, acc: 0.9579, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23846, unique_suffix_codes: 23846, logdet: 0.0000 
val ---  avg_loss: 8.6935, avg_recon_loss: 1.2782, avg_kl_loss: 12.9902, avg_vq_loss: 4.8172, ppl: 1.1088, acc: 0.9678, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 634 

epoch: 69,  avg_loss: 9.0006, avg_recon_loss: 1.6404, avg_kl_loss: 12.8539, avg_vq_loss: 4.7894, ppl: 1.1422, acc: 0.9582, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24013, unique_suffix_codes: 24013, logdet: 0.0000 
val ---  avg_loss: 8.8154, avg_recon_loss: 1.4638, avg_kl_loss: 12.7185, avg_vq_loss: 4.8079, ppl: 1.1255, acc: 0.9641, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1558, unique_suffix_codes: 1558, val_unique_suffix_codes: 648 

epoch: 70,  avg_loss: 9.0999, avg_recon_loss: 1.7137, avg_kl_loss: 12.8722, avg_vq_loss: 4.8117, ppl: 1.1491, acc: 0.9558, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23884, unique_suffix_codes: 23884, logdet: 0.0000 
val ---  avg_loss: 8.8872, avg_recon_loss: 1.4705, avg_kl_loss: 12.7839, avg_vq_loss: 4.8599, ppl: 1.1262, acc: 0.9628, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1551, unique_suffix_codes: 1551, val_unique_suffix_codes: 666 

epoch: 71,  avg_loss: 8.9912, avg_recon_loss: 1.6367, avg_kl_loss: 12.7316, avg_vq_loss: 4.8082, ppl: 1.1419, acc: 0.9579, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23949, unique_suffix_codes: 23949, logdet: 0.0000 
val ---  avg_loss: 8.7527, avg_recon_loss: 1.3582, avg_kl_loss: 12.8015, avg_vq_loss: 4.8342, ppl: 1.1160, acc: 0.9660, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1548, unique_suffix_codes: 1548, val_unique_suffix_codes: 647 

epoch: 72,  avg_loss: 8.9882, avg_recon_loss: 1.6266, avg_kl_loss: 12.7015, avg_vq_loss: 4.8213, ppl: 1.1410, acc: 0.9581, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23987, unique_suffix_codes: 23987, logdet: 0.0000 
val ---  avg_loss: 8.7272, avg_recon_loss: 1.3455, avg_kl_loss: 12.5458, avg_vq_loss: 4.8725, ppl: 1.1148, acc: 0.9662, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1560, unique_suffix_codes: 1560, val_unique_suffix_codes: 617 

epoch: 73,  avg_loss: 8.9516, avg_recon_loss: 1.6002, avg_kl_loss: 12.7000, avg_vq_loss: 4.8114, ppl: 1.1385, acc: 0.9591, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23922, unique_suffix_codes: 23922, logdet: 0.0000 
val ---  avg_loss: 8.9400, avg_recon_loss: 1.4599, avg_kl_loss: 13.0414, avg_vq_loss: 4.8718, ppl: 1.1252, acc: 0.9637, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1552, unique_suffix_codes: 1552, val_unique_suffix_codes: 698 

epoch: 74,  avg_loss: 9.0880, avg_recon_loss: 1.6925, avg_kl_loss: 12.7257, avg_vq_loss: 4.8503, ppl: 1.1471, acc: 0.9568, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24092, unique_suffix_codes: 24092, logdet: 0.0000 
val ---  avg_loss: 8.7700, avg_recon_loss: 1.3451, avg_kl_loss: 12.6816, avg_vq_loss: 4.8886, ppl: 1.1148, acc: 0.9659, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1548, unique_suffix_codes: 1548, val_unique_suffix_codes: 679 

epoch: 75,  avg_loss: 9.0173, avg_recon_loss: 1.6422, avg_kl_loss: 12.7373, avg_vq_loss: 4.8276, ppl: 1.1424, acc: 0.9578, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23925, unique_suffix_codes: 23925, logdet: 0.0000 
val ---  avg_loss: 8.7205, avg_recon_loss: 1.3105, avg_kl_loss: 12.7815, avg_vq_loss: 4.8537, ppl: 1.1117, acc: 0.9669, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1555, unique_suffix_codes: 1555, val_unique_suffix_codes: 635 

epoch: 76,  avg_loss: 8.9938, avg_recon_loss: 1.6192, avg_kl_loss: 12.6448, avg_vq_loss: 4.8455, ppl: 1.1403, acc: 0.9581, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24026, unique_suffix_codes: 24026, logdet: 0.0000 
val ---  avg_loss: 8.5504, avg_recon_loss: 1.2171, avg_kl_loss: 12.5974, avg_vq_loss: 4.8138, ppl: 1.1033, acc: 0.9686, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1560, unique_suffix_codes: 1560, val_unique_suffix_codes: 629 
update best loss 

epoch: 77,  avg_loss: 8.8751, avg_recon_loss: 1.5618, avg_kl_loss: 12.5481, avg_vq_loss: 4.8036, ppl: 1.1350, acc: 0.9598, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23959, unique_suffix_codes: 23959, logdet: 0.0000 
val ---  avg_loss: 8.7490, avg_recon_loss: 1.3481, avg_kl_loss: 12.5263, avg_vq_loss: 4.8957, ppl: 1.1151, acc: 0.9657, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1556, unique_suffix_codes: 1556, val_unique_suffix_codes: 640 

epoch: 78,  avg_loss: 8.9258, avg_recon_loss: 1.5728, avg_kl_loss: 12.5635, avg_vq_loss: 4.8403, ppl: 1.1360, acc: 0.9596, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24062, unique_suffix_codes: 24062, logdet: 0.0000 
val ---  avg_loss: 8.9698, avg_recon_loss: 1.5111, avg_kl_loss: 12.6421, avg_vq_loss: 4.9303, ppl: 1.1298, acc: 0.9615, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1557, unique_suffix_codes: 1557, val_unique_suffix_codes: 681 

epoch: 79,  avg_loss: 9.3345, avg_recon_loss: 1.8898, avg_kl_loss: 12.9758, avg_vq_loss: 4.8495, ppl: 1.1656, acc: 0.9516, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23864, unique_suffix_codes: 23864, logdet: 0.0000 
val ---  avg_loss: 8.6869, avg_recon_loss: 1.2349, avg_kl_loss: 13.0577, avg_vq_loss: 4.8404, ppl: 1.1049, acc: 0.9671, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1558, unique_suffix_codes: 1558, val_unique_suffix_codes: 681 

epoch: 80,  avg_loss: 9.1260, avg_recon_loss: 1.7445, avg_kl_loss: 12.7167, avg_vq_loss: 4.8382, ppl: 1.1519, acc: 0.9552, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24139, unique_suffix_codes: 24139, logdet: 0.0000 
val ---  avg_loss: 8.8270, avg_recon_loss: 1.3945, avg_kl_loss: 12.6334, avg_vq_loss: 4.9058, ppl: 1.1193, acc: 0.9656, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 658 

epoch: 81,  avg_loss: 8.9043, avg_recon_loss: 1.5474, avg_kl_loss: 12.5427, avg_vq_loss: 4.8483, ppl: 1.1337, acc: 0.9602, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24083, unique_suffix_codes: 24083, logdet: 0.0000 
val ---  avg_loss: 8.6331, avg_recon_loss: 1.2153, avg_kl_loss: 12.5090, avg_vq_loss: 4.9160, ppl: 1.1032, acc: 0.9697, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1557, unique_suffix_codes: 1557, val_unique_suffix_codes: 632 

epoch: 82,  avg_loss: 8.9047, avg_recon_loss: 1.5443, avg_kl_loss: 12.5105, avg_vq_loss: 4.8584, ppl: 1.1334, acc: 0.9604, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24102, unique_suffix_codes: 24102, logdet: 0.0000 
val ---  avg_loss: 8.6255, avg_recon_loss: 1.2388, avg_kl_loss: 12.5860, avg_vq_loss: 4.8695, ppl: 1.1053, acc: 0.9694, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 637 

epoch: 83,  avg_loss: 8.8515, avg_recon_loss: 1.5240, avg_kl_loss: 12.4468, avg_vq_loss: 4.8382, ppl: 1.1315, acc: 0.9609, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24105, unique_suffix_codes: 24105, logdet: 0.0000 
val ---  avg_loss: 8.5826, avg_recon_loss: 1.2282, avg_kl_loss: 12.3898, avg_vq_loss: 4.8765, ppl: 1.1043, acc: 0.9699, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 614 

epoch: 84,  avg_loss: 8.8091, avg_recon_loss: 1.4893, avg_kl_loss: 12.4396, avg_vq_loss: 4.8319, ppl: 1.1283, acc: 0.9619, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24062, unique_suffix_codes: 24062, logdet: 0.0000 
val ---  avg_loss: 8.6028, avg_recon_loss: 1.2987, avg_kl_loss: 12.6092, avg_vq_loss: 4.7823, ppl: 1.1106, acc: 0.9672, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1553, unique_suffix_codes: 1553, val_unique_suffix_codes: 666 

epoch: 85,  avg_loss: 8.9313, avg_recon_loss: 1.5828, avg_kl_loss: 12.4941, avg_vq_loss: 4.8496, ppl: 1.1369, acc: 0.9593, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24094, unique_suffix_codes: 24094, logdet: 0.0000 
val ---  avg_loss: 8.5616, avg_recon_loss: 1.2491, avg_kl_loss: 12.3455, avg_vq_loss: 4.8434, ppl: 1.1062, acc: 0.9695, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 655 

epoch: 86,  avg_loss: 8.8698, avg_recon_loss: 1.5482, avg_kl_loss: 12.3865, avg_vq_loss: 4.8443, ppl: 1.1337, acc: 0.9603, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24102, unique_suffix_codes: 24102, logdet: 0.0000 
val ---  avg_loss: 8.8195, avg_recon_loss: 1.3862, avg_kl_loss: 12.6242, avg_vq_loss: 4.9084, ppl: 1.1185, acc: 0.9659, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1555, unique_suffix_codes: 1555, val_unique_suffix_codes: 699 

epoch: 87,  avg_loss: 8.8238, avg_recon_loss: 1.5176, avg_kl_loss: 12.3847, avg_vq_loss: 4.8292, ppl: 1.1309, acc: 0.9610, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 23953, unique_suffix_codes: 23953, logdet: 0.0000 
val ---  avg_loss: 8.5818, avg_recon_loss: 1.2467, avg_kl_loss: 12.1357, avg_vq_loss: 4.9080, ppl: 1.1060, acc: 0.9678, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 648 

epoch: 88,  avg_loss: 8.7539, avg_recon_loss: 1.4830, avg_kl_loss: 12.2856, avg_vq_loss: 4.8138, ppl: 1.1278, acc: 0.9622, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24074, unique_suffix_codes: 24074, logdet: 0.0000 
val ---  avg_loss: 8.8240, avg_recon_loss: 1.4424, avg_kl_loss: 12.6662, avg_vq_loss: 4.8484, ppl: 1.1236, acc: 0.9643, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 659 

epoch: 89,  avg_loss: 8.8856, avg_recon_loss: 1.5591, avg_kl_loss: 12.4330, avg_vq_loss: 4.8399, ppl: 1.1347, acc: 0.9598, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24053, unique_suffix_codes: 24053, logdet: 0.0000 
val ---  avg_loss: 8.5735, avg_recon_loss: 1.2481, avg_kl_loss: 12.2440, avg_vq_loss: 4.8766, ppl: 1.1061, acc: 0.9696, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 651 

epoch: 90,  avg_loss: 8.8397, avg_recon_loss: 1.5173, avg_kl_loss: 12.2842, avg_vq_loss: 4.8656, ppl: 1.1309, acc: 0.9610, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24182, unique_suffix_codes: 24182, logdet: 0.0000 
val ---  avg_loss: 8.8119, avg_recon_loss: 1.3555, avg_kl_loss: 12.4130, avg_vq_loss: 4.9738, ppl: 1.1157, acc: 0.9651, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 675 

epoch: 91,  avg_loss: 8.7940, avg_recon_loss: 1.4914, avg_kl_loss: 12.2273, avg_vq_loss: 4.8572, ppl: 1.1285, acc: 0.9614, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24112, unique_suffix_codes: 24112, logdet: 0.0000 
val ---  avg_loss: 8.5396, avg_recon_loss: 1.2011, avg_kl_loss: 12.1764, avg_vq_loss: 4.9032, ppl: 1.1019, acc: 0.9700, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 638 
update best loss 

epoch: 92,  avg_loss: 8.7385, avg_recon_loss: 1.4644, avg_kl_loss: 12.1652, avg_vq_loss: 4.8410, ppl: 1.1261, acc: 0.9627, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24249, unique_suffix_codes: 24249, logdet: 0.0000 
val ---  avg_loss: 8.6589, avg_recon_loss: 1.2886, avg_kl_loss: 12.4107, avg_vq_loss: 4.8882, ppl: 1.1097, acc: 0.9687, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1557, unique_suffix_codes: 1557, val_unique_suffix_codes: 645 

epoch: 93,  avg_loss: 8.7997, avg_recon_loss: 1.4989, avg_kl_loss: 12.1420, avg_vq_loss: 4.8723, ppl: 1.1292, acc: 0.9617, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24283, unique_suffix_codes: 24283, logdet: 0.0000 
val ---  avg_loss: 8.5447, avg_recon_loss: 1.1971, avg_kl_loss: 12.2383, avg_vq_loss: 4.9000, ppl: 1.1015, acc: 0.9704, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 613 

epoch: 94,  avg_loss: 8.7311, avg_recon_loss: 1.4601, avg_kl_loss: 12.1285, avg_vq_loss: 4.8452, ppl: 1.1257, acc: 0.9625, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24269, unique_suffix_codes: 24269, logdet: 0.0000 
val ---  avg_loss: 8.6083, avg_recon_loss: 1.3173, avg_kl_loss: 12.0728, avg_vq_loss: 4.8764, ppl: 1.1123, acc: 0.9686, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1557, unique_suffix_codes: 1557, val_unique_suffix_codes: 638 

epoch: 95,  avg_loss: 8.9386, avg_recon_loss: 1.5505, avg_kl_loss: 12.3906, avg_vq_loss: 4.9100, ppl: 1.1339, acc: 0.9602, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24401, unique_suffix_codes: 24401, logdet: 0.0000 
val ---  avg_loss: 8.7311, avg_recon_loss: 1.2911, avg_kl_loss: 12.2141, avg_vq_loss: 4.9972, ppl: 1.1099, acc: 0.9675, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 717 

epoch: 96,  avg_loss: 8.8416, avg_recon_loss: 1.5268, avg_kl_loss: 12.2823, avg_vq_loss: 4.8584, ppl: 1.1318, acc: 0.9606, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24141, unique_suffix_codes: 24141, logdet: 0.0000 
val ---  avg_loss: 8.4379, avg_recon_loss: 1.1832, avg_kl_loss: 12.0844, avg_vq_loss: 4.8378, ppl: 1.1003, acc: 0.9715, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 643 
update best loss 

epoch: 97,  avg_loss: 8.8052, avg_recon_loss: 1.5018, avg_kl_loss: 12.1748, avg_vq_loss: 4.8684, ppl: 1.1295, acc: 0.9614, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24233, unique_suffix_codes: 24233, logdet: 0.0000 
val ---  avg_loss: 8.7498, avg_recon_loss: 1.3580, avg_kl_loss: 12.3090, avg_vq_loss: 4.9300, ppl: 1.1160, acc: 0.9666, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 670 

epoch: 98,  avg_loss: 8.8367, avg_recon_loss: 1.5403, avg_kl_loss: 12.0944, avg_vq_loss: 4.8775, ppl: 1.1330, acc: 0.9603, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24095, unique_suffix_codes: 24095, logdet: 0.0000 
val ---  avg_loss: 8.6247, avg_recon_loss: 1.2857, avg_kl_loss: 12.2163, avg_vq_loss: 4.8957, ppl: 1.1095, acc: 0.9682, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 656 

epoch: 99,  avg_loss: 8.7793, avg_recon_loss: 1.4723, avg_kl_loss: 12.1526, avg_vq_loss: 4.8765, ppl: 1.1268, acc: 0.9623, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24246, unique_suffix_codes: 24246, logdet: 0.0000 
val ---  avg_loss: 8.5745, avg_recon_loss: 1.1748, avg_kl_loss: 12.4575, avg_vq_loss: 4.9082, ppl: 1.0996, acc: 0.9709, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 671 

epoch: 100,  avg_loss: 8.7511, avg_recon_loss: 1.4440, avg_kl_loss: 12.1858, avg_vq_loss: 4.8699, ppl: 1.1242, acc: 0.9631, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24312, unique_suffix_codes: 24312, logdet: 0.0000 
val ---  avg_loss: 8.4842, avg_recon_loss: 1.1951, avg_kl_loss: 11.9516, avg_vq_loss: 4.8988, ppl: 1.1014, acc: 0.9704, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 656 

epoch: 101,  avg_loss: 8.6589, avg_recon_loss: 1.4092, avg_kl_loss: 11.9876, avg_vq_loss: 4.8522, ppl: 1.1210, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24358, unique_suffix_codes: 24358, logdet: 0.0000 
val ---  avg_loss: 8.4893, avg_recon_loss: 1.1562, avg_kl_loss: 12.1233, avg_vq_loss: 4.9085, ppl: 1.0979, acc: 0.9710, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 655 

epoch: 102,  avg_loss: 8.6644, avg_recon_loss: 1.4321, avg_kl_loss: 12.0042, avg_vq_loss: 4.8315, ppl: 1.1231, acc: 0.9633, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24336, unique_suffix_codes: 24336, logdet: 0.0000 
val ---  avg_loss: 8.4619, avg_recon_loss: 1.2434, avg_kl_loss: 12.2566, avg_vq_loss: 4.7671, ppl: 1.1057, acc: 0.9683, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 670 

epoch: 103,  avg_loss: 8.7435, avg_recon_loss: 1.4985, avg_kl_loss: 12.0250, avg_vq_loss: 4.8400, ppl: 1.1292, acc: 0.9616, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24205, unique_suffix_codes: 24205, logdet: 0.0000 
val ---  avg_loss: 8.6269, avg_recon_loss: 1.3152, avg_kl_loss: 12.0952, avg_vq_loss: 4.8926, ppl: 1.1121, acc: 0.9682, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 704 

epoch: 104,  avg_loss: 8.7912, avg_recon_loss: 1.5451, avg_kl_loss: 12.1175, avg_vq_loss: 4.8226, ppl: 1.1335, acc: 0.9605, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24161, unique_suffix_codes: 24161, logdet: 0.0000 
val ---  avg_loss: 8.4835, avg_recon_loss: 1.1870, avg_kl_loss: 12.0643, avg_vq_loss: 4.8837, ppl: 1.1006, acc: 0.9706, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 637 

epoch: 105,  avg_loss: 8.7542, avg_recon_loss: 1.4869, avg_kl_loss: 11.9909, avg_vq_loss: 4.8691, ppl: 1.1281, acc: 0.9621, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24210, unique_suffix_codes: 24210, logdet: 0.0000 
val ---  avg_loss: 8.4780, avg_recon_loss: 1.2248, avg_kl_loss: 12.0292, avg_vq_loss: 4.8474, ppl: 1.1040, acc: 0.9706, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 639 

epoch: 106,  avg_loss: 8.8200, avg_recon_loss: 1.5287, avg_kl_loss: 12.0272, avg_vq_loss: 4.8858, ppl: 1.1319, acc: 0.9610, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24201, unique_suffix_codes: 24201, logdet: 0.0000 
val ---  avg_loss: 8.5551, avg_recon_loss: 1.2029, avg_kl_loss: 11.9179, avg_vq_loss: 4.9686, ppl: 1.1021, acc: 0.9701, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 642 

epoch: 107,  avg_loss: 8.6737, avg_recon_loss: 1.4157, avg_kl_loss: 11.8617, avg_vq_loss: 4.8856, ppl: 1.1216, acc: 0.9637, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24285, unique_suffix_codes: 24285, logdet: 0.0000 
val ---  avg_loss: 8.4913, avg_recon_loss: 1.2226, avg_kl_loss: 11.8635, avg_vq_loss: 4.8959, ppl: 1.1038, acc: 0.9689, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 641 

epoch: 108,  avg_loss: 8.6140, avg_recon_loss: 1.4132, avg_kl_loss: 11.8813, avg_vq_loss: 4.8246, ppl: 1.1214, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24226, unique_suffix_codes: 24226, logdet: 0.0000 
val ---  avg_loss: 8.5121, avg_recon_loss: 1.1952, avg_kl_loss: 11.9825, avg_vq_loss: 4.9204, ppl: 1.1014, acc: 0.9708, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 661 

epoch: 109,  avg_loss: 8.6346, avg_recon_loss: 1.4070, avg_kl_loss: 11.9233, avg_vq_loss: 4.8429, ppl: 1.1208, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24423, unique_suffix_codes: 24423, logdet: 0.0000 
val ---  avg_loss: 8.6574, avg_recon_loss: 1.2182, avg_kl_loss: 12.5298, avg_vq_loss: 4.9333, ppl: 1.1034, acc: 0.9675, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 633 

epoch: 110,  avg_loss: 8.6241, avg_recon_loss: 1.4312, avg_kl_loss: 11.8635, avg_vq_loss: 4.8202, ppl: 1.1230, acc: 0.9634, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24292, unique_suffix_codes: 24292, logdet: 0.0000 
val ---  avg_loss: 8.4494, avg_recon_loss: 1.2277, avg_kl_loss: 11.7945, avg_vq_loss: 4.8629, ppl: 1.1043, acc: 0.9689, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1569, unique_suffix_codes: 1569, val_unique_suffix_codes: 614 

epoch: 111,  avg_loss: 8.5779, avg_recon_loss: 1.4063, avg_kl_loss: 11.7083, avg_vq_loss: 4.8299, ppl: 1.1208, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24290, unique_suffix_codes: 24290, logdet: 0.0000 
val ---  avg_loss: 8.3256, avg_recon_loss: 1.1128, avg_kl_loss: 11.8246, avg_vq_loss: 4.8479, ppl: 1.0941, acc: 0.9709, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 628 
update best loss 

epoch: 112,  avg_loss: 8.6335, avg_recon_loss: 1.4229, avg_kl_loss: 11.7738, avg_vq_loss: 4.8559, ppl: 1.1223, acc: 0.9637, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24373, unique_suffix_codes: 24373, logdet: 0.0000 
val ---  avg_loss: 8.3724, avg_recon_loss: 1.1502, avg_kl_loss: 11.5559, avg_vq_loss: 4.9110, ppl: 1.0974, acc: 0.9717, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 576 

epoch: 113,  avg_loss: 8.5546, avg_recon_loss: 1.4117, avg_kl_loss: 11.7692, avg_vq_loss: 4.7890, ppl: 1.1213, acc: 0.9636, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24254, unique_suffix_codes: 24254, logdet: 0.0000 
val ---  avg_loss: 8.5017, avg_recon_loss: 1.2567, avg_kl_loss: 11.8435, avg_vq_loss: 4.8762, ppl: 1.1069, acc: 0.9679, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1558, unique_suffix_codes: 1558, val_unique_suffix_codes: 666 

epoch: 114,  avg_loss: 8.6835, avg_recon_loss: 1.4511, avg_kl_loss: 11.8484, avg_vq_loss: 4.8627, ppl: 1.1248, acc: 0.9626, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24395, unique_suffix_codes: 24395, logdet: 0.0000 
val ---  avg_loss: 8.5862, avg_recon_loss: 1.2259, avg_kl_loss: 12.0943, avg_vq_loss: 4.9414, ppl: 1.1041, acc: 0.9708, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 637 

epoch: 115,  avg_loss: 8.6048, avg_recon_loss: 1.4175, avg_kl_loss: 11.7531, avg_vq_loss: 4.8366, ppl: 1.1218, acc: 0.9638, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24352, unique_suffix_codes: 24352, logdet: 0.0000 
val ---  avg_loss: 8.6522, avg_recon_loss: 1.4770, avg_kl_loss: 11.7975, avg_vq_loss: 4.8157, ppl: 1.1267, acc: 0.9647, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 656 

epoch: 116,  avg_loss: 8.6846, avg_recon_loss: 1.4805, avg_kl_loss: 11.7564, avg_vq_loss: 4.8527, ppl: 1.1275, acc: 0.9618, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24408, unique_suffix_codes: 24408, logdet: 0.0000 
val ---  avg_loss: 8.4353, avg_recon_loss: 1.1344, avg_kl_loss: 11.8277, avg_vq_loss: 4.9353, ppl: 1.0960, acc: 0.9726, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 625 

epoch: 117,  avg_loss: 8.6301, avg_recon_loss: 1.4102, avg_kl_loss: 11.8077, avg_vq_loss: 4.8584, ppl: 1.1211, acc: 0.9639, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24345, unique_suffix_codes: 24345, logdet: 0.0000 
val ---  avg_loss: 8.4062, avg_recon_loss: 1.1378, avg_kl_loss: 11.7801, avg_vq_loss: 4.9123, ppl: 1.0963, acc: 0.9715, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 626 

epoch: 118,  avg_loss: 8.5326, avg_recon_loss: 1.3546, avg_kl_loss: 11.6465, avg_vq_loss: 4.8487, ppl: 1.1161, acc: 0.9652, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24516, unique_suffix_codes: 24516, logdet: 0.0000 
val ---  avg_loss: 8.4233, avg_recon_loss: 1.2546, avg_kl_loss: 11.4783, avg_vq_loss: 4.8731, ppl: 1.1067, acc: 0.9697, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 653 

epoch: 119,  avg_loss: 8.5927, avg_recon_loss: 1.4364, avg_kl_loss: 11.7146, avg_vq_loss: 4.8134, ppl: 1.1235, acc: 0.9630, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24366, unique_suffix_codes: 24366, logdet: 0.0000 
val ---  avg_loss: 8.2339, avg_recon_loss: 1.1024, avg_kl_loss: 11.7925, avg_vq_loss: 4.7730, ppl: 1.0932, acc: 0.9712, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1560, unique_suffix_codes: 1560, val_unique_suffix_codes: 623 
update best loss 

epoch: 120,  avg_loss: 8.6083, avg_recon_loss: 1.3939, avg_kl_loss: 11.8325, avg_vq_loss: 4.8479, ppl: 1.1196, acc: 0.9645, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24497, unique_suffix_codes: 24497, logdet: 0.0000 
val ---  avg_loss: 8.3847, avg_recon_loss: 1.1473, avg_kl_loss: 11.6246, avg_vq_loss: 4.9125, ppl: 1.0971, acc: 0.9716, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 625 

epoch: 121,  avg_loss: 8.6062, avg_recon_loss: 1.3939, avg_kl_loss: 11.7259, avg_vq_loss: 4.8671, ppl: 1.1196, acc: 0.9640, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24546, unique_suffix_codes: 24546, logdet: 0.0000 
val ---  avg_loss: 8.3374, avg_recon_loss: 1.1189, avg_kl_loss: 11.5783, avg_vq_loss: 4.9028, ppl: 1.0946, acc: 0.9718, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 610 

epoch: 122,  avg_loss: 8.5462, avg_recon_loss: 1.3563, avg_kl_loss: 11.6247, avg_vq_loss: 4.8650, ppl: 1.1162, acc: 0.9649, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24410, unique_suffix_codes: 24410, logdet: 0.0000 
val ---  avg_loss: 8.3518, avg_recon_loss: 1.1742, avg_kl_loss: 11.4780, avg_vq_loss: 4.8820, ppl: 1.0995, acc: 0.9717, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1573, unique_suffix_codes: 1573, val_unique_suffix_codes: 691 

epoch: 123,  avg_loss: 8.5571, avg_recon_loss: 1.3994, avg_kl_loss: 11.5794, avg_vq_loss: 4.8418, ppl: 1.1201, acc: 0.9641, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24432, unique_suffix_codes: 24432, logdet: 0.0000 
val ---  avg_loss: 8.4638, avg_recon_loss: 1.1916, avg_kl_loss: 11.7166, avg_vq_loss: 4.9289, ppl: 1.1011, acc: 0.9708, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1564, unique_suffix_codes: 1564, val_unique_suffix_codes: 645 

epoch: 124,  avg_loss: 8.5975, avg_recon_loss: 1.4370, avg_kl_loss: 11.6255, avg_vq_loss: 4.8354, ppl: 1.1236, acc: 0.9631, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24426, unique_suffix_codes: 24426, logdet: 0.0000 
val ---  avg_loss: 8.3708, avg_recon_loss: 1.1674, avg_kl_loss: 11.4726, avg_vq_loss: 4.9089, ppl: 1.0989, acc: 0.9711, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 631 

epoch: 125,  avg_loss: 8.5391, avg_recon_loss: 1.3791, avg_kl_loss: 11.5619, avg_vq_loss: 4.8476, ppl: 1.1183, acc: 0.9647, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24517, unique_suffix_codes: 24517, logdet: 0.0000 
val ---  avg_loss: 8.3149, avg_recon_loss: 1.1490, avg_kl_loss: 11.5824, avg_vq_loss: 4.8494, ppl: 1.0973, acc: 0.9712, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 621 

epoch: 126,  avg_loss: 8.5857, avg_recon_loss: 1.3839, avg_kl_loss: 11.5818, avg_vq_loss: 4.8854, ppl: 1.1187, acc: 0.9646, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24423, unique_suffix_codes: 24423, logdet: 0.0000 
val ---  avg_loss: 8.7430, avg_recon_loss: 1.4183, avg_kl_loss: 11.7701, avg_vq_loss: 4.9706, ppl: 1.1214, acc: 0.9630, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1558, unique_suffix_codes: 1558, val_unique_suffix_codes: 637 

epoch: 127,  avg_loss: 8.6349, avg_recon_loss: 1.4185, avg_kl_loss: 11.6781, avg_vq_loss: 4.8808, ppl: 1.1219, acc: 0.9634, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24457, unique_suffix_codes: 24457, logdet: 0.0000 
val ---  avg_loss: 8.4722, avg_recon_loss: 1.2254, avg_kl_loss: 11.4805, avg_vq_loss: 4.9507, ppl: 1.1041, acc: 0.9681, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 698 

epoch: 128,  avg_loss: 8.5526, avg_recon_loss: 1.3717, avg_kl_loss: 11.4685, avg_vq_loss: 4.8872, ppl: 1.1176, acc: 0.9650, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24527, unique_suffix_codes: 24527, logdet: 0.0000 
val ---  avg_loss: 8.4434, avg_recon_loss: 1.2202, avg_kl_loss: 11.4150, avg_vq_loss: 4.9401, ppl: 1.1036, acc: 0.9698, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 638 

epoch: 129,  avg_loss: 8.5857, avg_recon_loss: 1.4143, avg_kl_loss: 11.6204, avg_vq_loss: 4.8472, ppl: 1.1215, acc: 0.9636, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24416, unique_suffix_codes: 24416, logdet: 0.0000 
val ---  avg_loss: 8.3416, avg_recon_loss: 1.0779, avg_kl_loss: 12.0692, avg_vq_loss: 4.8499, ppl: 1.0910, acc: 0.9722, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 637 

epoch: 130,  avg_loss: 8.4946, avg_recon_loss: 1.3434, avg_kl_loss: 11.5360, avg_vq_loss: 4.8440, ppl: 1.1151, acc: 0.9653, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24402, unique_suffix_codes: 24402, logdet: 0.0000 
val ---  avg_loss: 8.5259, avg_recon_loss: 1.3031, avg_kl_loss: 11.4835, avg_vq_loss: 4.9262, ppl: 1.1110, acc: 0.9654, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 655 

epoch: 131,  avg_loss: 8.7098, avg_recon_loss: 1.5024, avg_kl_loss: 11.6429, avg_vq_loss: 4.8788, ppl: 1.1295, acc: 0.9613, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24449, unique_suffix_codes: 24449, logdet: 0.0000 
val ---  avg_loss: 8.3685, avg_recon_loss: 1.1845, avg_kl_loss: 11.4412, avg_vq_loss: 4.8957, ppl: 1.1004, acc: 0.9694, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 646 

epoch: 132,  avg_loss: 8.4682, avg_recon_loss: 1.3621, avg_kl_loss: 11.4959, avg_vq_loss: 4.8068, ppl: 1.1168, acc: 0.9651, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24475, unique_suffix_codes: 24475, logdet: 0.0000 
val ---  avg_loss: 8.2730, avg_recon_loss: 1.1581, avg_kl_loss: 11.4138, avg_vq_loss: 4.8321, ppl: 1.0981, acc: 0.9703, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 612 

epoch: 133,  avg_loss: 8.6762, avg_recon_loss: 1.5122, avg_kl_loss: 11.7505, avg_vq_loss: 4.8139, ppl: 1.1304, acc: 0.9612, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24354, unique_suffix_codes: 24354, logdet: 0.0000 
val ---  avg_loss: 8.3653, avg_recon_loss: 1.2254, avg_kl_loss: 11.4181, avg_vq_loss: 4.8563, ppl: 1.1041, acc: 0.9690, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 655 

epoch: 134,  avg_loss: 8.4870, avg_recon_loss: 1.3688, avg_kl_loss: 11.4735, avg_vq_loss: 4.8235, ppl: 1.1174, acc: 0.9647, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24384, unique_suffix_codes: 24384, logdet: 0.0000 
val ---  avg_loss: 8.2973, avg_recon_loss: 1.1544, avg_kl_loss: 11.5391, avg_vq_loss: 4.8350, ppl: 1.0978, acc: 0.9706, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 635 

epoch: 135,  avg_loss: 8.4402, avg_recon_loss: 1.3519, avg_kl_loss: 11.4047, avg_vq_loss: 4.8074, ppl: 1.1158, acc: 0.9655, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24524, unique_suffix_codes: 24524, logdet: 0.0000 
val ---  avg_loss: 8.1700, avg_recon_loss: 1.0415, avg_kl_loss: 11.5725, avg_vq_loss: 4.8140, ppl: 1.0878, acc: 0.9733, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 585 
update best loss 

epoch: 136,  avg_loss: 8.3832, avg_recon_loss: 1.3198, avg_kl_loss: 11.3796, avg_vq_loss: 4.7874, ppl: 1.1129, acc: 0.9658, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24499, unique_suffix_codes: 24499, logdet: 0.0000 
val ---  avg_loss: 8.2284, avg_recon_loss: 1.1219, avg_kl_loss: 11.2913, avg_vq_loss: 4.8482, ppl: 1.0949, acc: 0.9719, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 594 

epoch: 137,  avg_loss: 8.6319, avg_recon_loss: 1.4566, avg_kl_loss: 11.5472, avg_vq_loss: 4.8658, ppl: 1.1253, acc: 0.9629, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24703, unique_suffix_codes: 24703, logdet: 0.0000 
val ---  avg_loss: 8.4342, avg_recon_loss: 1.1755, avg_kl_loss: 11.6532, avg_vq_loss: 4.9280, ppl: 1.0996, acc: 0.9694, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 638 

epoch: 138,  avg_loss: 8.6889, avg_recon_loss: 1.4753, avg_kl_loss: 11.6888, avg_vq_loss: 4.8759, ppl: 1.1271, acc: 0.9621, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24537, unique_suffix_codes: 24537, logdet: 0.0000 
val ---  avg_loss: 8.4389, avg_recon_loss: 1.1637, avg_kl_loss: 11.8744, avg_vq_loss: 4.9003, ppl: 1.0986, acc: 0.9708, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 643 

epoch: 139,  avg_loss: 8.5581, avg_recon_loss: 1.3863, avg_kl_loss: 11.4842, avg_vq_loss: 4.8749, ppl: 1.1189, acc: 0.9645, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24483, unique_suffix_codes: 24483, logdet: 0.0000 
val ---  avg_loss: 8.3496, avg_recon_loss: 1.1554, avg_kl_loss: 11.3856, avg_vq_loss: 4.9170, ppl: 1.0978, acc: 0.9721, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 578 

epoch: 140,  avg_loss: 8.5698, avg_recon_loss: 1.3950, avg_kl_loss: 11.4385, avg_vq_loss: 4.8870, ppl: 1.1197, acc: 0.9642, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24414, unique_suffix_codes: 24414, logdet: 0.0000 
val ---  avg_loss: 8.2808, avg_recon_loss: 1.0762, avg_kl_loss: 11.3731, avg_vq_loss: 4.9300, ppl: 1.0908, acc: 0.9731, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1568, unique_suffix_codes: 1568, val_unique_suffix_codes: 635 

epoch: 141,  avg_loss: 8.4676, avg_recon_loss: 1.3475, avg_kl_loss: 11.3912, avg_vq_loss: 4.8418, ppl: 1.1154, acc: 0.9650, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24495, unique_suffix_codes: 24495, logdet: 0.0000 
val ---  avg_loss: 8.1166, avg_recon_loss: 1.0270, avg_kl_loss: 11.1019, avg_vq_loss: 4.8692, ppl: 1.0865, acc: 0.9743, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1565, unique_suffix_codes: 1565, val_unique_suffix_codes: 560 
update best loss 

epoch: 142,  avg_loss: 8.4184, avg_recon_loss: 1.3193, avg_kl_loss: 11.3332, avg_vq_loss: 4.8325, ppl: 1.1129, acc: 0.9659, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24435, unique_suffix_codes: 24435, logdet: 0.0000 
val ---  avg_loss: 8.3224, avg_recon_loss: 1.1069, avg_kl_loss: 11.4658, avg_vq_loss: 4.9223, ppl: 1.0936, acc: 0.9720, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 622 

epoch: 143,  avg_loss: 8.4987, avg_recon_loss: 1.3508, avg_kl_loss: 11.3504, avg_vq_loss: 4.8778, ppl: 1.1157, acc: 0.9653, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24478, unique_suffix_codes: 24478, logdet: 0.0000 
val ---  avg_loss: 8.1973, avg_recon_loss: 1.0675, avg_kl_loss: 11.2889, avg_vq_loss: 4.8720, ppl: 1.0901, acc: 0.9738, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1568, unique_suffix_codes: 1568, val_unique_suffix_codes: 598 

epoch: 144,  avg_loss: 8.4746, avg_recon_loss: 1.3397, avg_kl_loss: 11.3398, avg_vq_loss: 4.8670, ppl: 1.1147, acc: 0.9656, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24585, unique_suffix_codes: 24585, logdet: 0.0000 
val ---  avg_loss: 8.2414, avg_recon_loss: 1.1159, avg_kl_loss: 11.2661, avg_vq_loss: 4.8723, ppl: 1.0943, acc: 0.9717, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 594 

epoch: 145,  avg_loss: 8.4418, avg_recon_loss: 1.3412, avg_kl_loss: 11.3661, avg_vq_loss: 4.8273, ppl: 1.1149, acc: 0.9655, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24460, unique_suffix_codes: 24460, logdet: 0.0000 
val ---  avg_loss: 8.3723, avg_recon_loss: 1.1812, avg_kl_loss: 11.2947, avg_vq_loss: 4.9321, ppl: 1.1001, acc: 0.9703, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 661 

epoch: 146,  avg_loss: 8.4586, avg_recon_loss: 1.3587, avg_kl_loss: 11.3544, avg_vq_loss: 4.8290, ppl: 1.1164, acc: 0.9649, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24454, unique_suffix_codes: 24454, logdet: 0.0000 
val ---  avg_loss: 8.4571, avg_recon_loss: 1.2352, avg_kl_loss: 11.5025, avg_vq_loss: 4.9213, ppl: 1.1049, acc: 0.9687, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1561, unique_suffix_codes: 1561, val_unique_suffix_codes: 631 

epoch: 147,  avg_loss: 8.5218, avg_recon_loss: 1.4152, avg_kl_loss: 11.3695, avg_vq_loss: 4.8327, ppl: 1.1216, acc: 0.9642, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24518, unique_suffix_codes: 24518, logdet: 0.0000 
val ---  avg_loss: 8.3384, avg_recon_loss: 1.1865, avg_kl_loss: 11.3347, avg_vq_loss: 4.8850, ppl: 1.1006, acc: 0.9704, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1563, unique_suffix_codes: 1563, val_unique_suffix_codes: 622 

epoch: 148,  avg_loss: 8.5287, avg_recon_loss: 1.4068, avg_kl_loss: 11.3408, avg_vq_loss: 4.8537, ppl: 1.1208, acc: 0.9638, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24502, unique_suffix_codes: 24502, logdet: 0.0000 
val ---  avg_loss: 8.1895, avg_recon_loss: 1.0759, avg_kl_loss: 11.2405, avg_vq_loss: 4.8655, ppl: 1.0908, acc: 0.9728, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1567, unique_suffix_codes: 1567, val_unique_suffix_codes: 610 

epoch: 149,  avg_loss: 8.4044, avg_recon_loss: 1.3533, avg_kl_loss: 11.2655, avg_vq_loss: 4.7979, ppl: 1.1160, acc: 0.9652, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24604, unique_suffix_codes: 24604, logdet: 0.0000 
val ---  avg_loss: 8.2520, avg_recon_loss: 1.1593, avg_kl_loss: 11.1786, avg_vq_loss: 4.8569, ppl: 1.0982, acc: 0.9712, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 594 

epoch: 150,  avg_loss: 8.3757, avg_recon_loss: 1.3397, avg_kl_loss: 11.2788, avg_vq_loss: 4.7802, ppl: 1.1147, acc: 0.9658, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24536, unique_suffix_codes: 24536, logdet: 0.0000 
val ---  avg_loss: 8.0583, avg_recon_loss: 1.0424, avg_kl_loss: 11.1694, avg_vq_loss: 4.7820, ppl: 1.0879, acc: 0.9739, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1566, unique_suffix_codes: 1566, val_unique_suffix_codes: 591 
update best loss 

epoch: 151,  avg_loss: 8.3388, avg_recon_loss: 1.3182, avg_kl_loss: 11.2400, avg_vq_loss: 4.7726, ppl: 1.1128, acc: 0.9661, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24597, unique_suffix_codes: 24597, logdet: 0.0000 
val ---  avg_loss: 8.1600, avg_recon_loss: 1.0602, avg_kl_loss: 11.3824, avg_vq_loss: 4.8233, ppl: 1.0894, acc: 0.9735, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1556, unique_suffix_codes: 1556, val_unique_suffix_codes: 601 

epoch: 152,  avg_loss: 8.3699, avg_recon_loss: 1.3365, avg_kl_loss: 11.1539, avg_vq_loss: 4.8026, ppl: 1.1144, acc: 0.9662, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24645, unique_suffix_codes: 24645, logdet: 0.0000 
val ---  avg_loss: 8.2994, avg_recon_loss: 1.1914, avg_kl_loss: 11.1347, avg_vq_loss: 4.8811, ppl: 1.1010, acc: 0.9687, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1557, unique_suffix_codes: 1557, val_unique_suffix_codes: 609 

epoch: 153,  avg_loss: 8.3258, avg_recon_loss: 1.3022, avg_kl_loss: 11.1491, avg_vq_loss: 4.7938, ppl: 1.1113, acc: 0.9667, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24598, unique_suffix_codes: 24598, logdet: 0.0000 
val ---  avg_loss: 8.2371, avg_recon_loss: 1.1663, avg_kl_loss: 11.0190, avg_vq_loss: 4.8670, ppl: 1.0988, acc: 0.9701, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1562, unique_suffix_codes: 1562, val_unique_suffix_codes: 630 

epoch: 154,  avg_loss: 8.4924, avg_recon_loss: 1.3987, avg_kl_loss: 11.2735, avg_vq_loss: 4.8391, ppl: 1.1201, acc: 0.9643, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24679, unique_suffix_codes: 24679, logdet: 0.0000 
val ---  avg_loss: 8.4679, avg_recon_loss: 1.2675, avg_kl_loss: 11.6232, avg_vq_loss: 4.8758, ppl: 1.1078, acc: 0.9691, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1559, unique_suffix_codes: 1559, val_unique_suffix_codes: 744 

epoch: 155,  avg_loss: 8.5290, avg_recon_loss: 1.4034, avg_kl_loss: 11.3565, avg_vq_loss: 4.8542, ppl: 1.1205, acc: 0.9640, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 24471, unique_suffix_codes: 24471, logdet: 0.0000 
val ---  avg_loss: 8.3209, avg_recon_loss: 1.2156, avg_kl_loss: 11.0754, avg_vq_loss: 4.8902, ppl: 1.1032, acc: 0.9689, vq_inds: [6, 6, 6, 6, 6, 6, 6, 6], unique_vq_codes: 1571, unique_suffix_codes: 1571, val_unique_suffix_codes: 675 
