
number of params: 2195968 
Namespace(batchsize=128, beta=0.5, dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=128, dec_nh_tmp=128, device='cuda', embedding_dim=512, enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=512, epochs=200, fig_path='model/vqvae/results/training/25031_instances/kl0.1_4x10_dec128_suffixd512/200epochs.png', incat=512, incat_tmp=512, log_path='model/vqvae/results/training/25031_instances/kl0.1_4x10_dec128_suffixd512/200epochs.log', logger=<common.utils.Logger object at 0x7f8e29a21490>, lr=0.001, maxtrnsize=10000000, maxtstsize=10000, maxvalsize=10000, mname='vqvae', model=VQVAE(
  (encoder): VQVAE_Encoder(
    (embed): Embedding(36, 256)
    (lstm): LSTM(256, 512, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=512, out_features=256, bias=False)
  )
  (ord_vq_layers): ModuleList(
    (0): VectorQuantizer(
      (embedding): Embedding(10, 128)
    )
    (1): VectorQuantizer(
      (embedding): Embedding(10, 128)
    )
    (2): VectorQuantizer(
      (embedding): Embedding(10, 128)
    )
    (3): VectorQuantizer(
      (embedding): Embedding(10, 128)
    )
  )
  (decoder): VQVAE_Decoder(
    (embed): Embedding(36, 256, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (lstm): LSTM(768, 128, batch_first=True)
    (pred_linear): Linear(in_features=128, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
), model_prefix='kl0.1_4x10_dec128_suffixd512/', modelname='model/vqvae/results/training/25031_instances/kl0.1_4x10_dec128_suffixd512/', ni=256, num_dicts=4, num_dicts_tmp=4, nz=128, opt='Adam', orddict_emb_num=10, outcat=0, outcat_tmp=0, pretrained_model=VQVAE_AE(
  (encoder): VQVAE_Encoder(
    (embed): Embedding(36, 256)
    (lstm): LSTM(256, 512, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
  )
  (decoder): VQVAE_Decoder(
    (embed): Embedding(36, 256, padding_idx=0)
    (dropout_in): Dropout(p=0.5, inplace=False)
    (dropout_out): Dropout(p=0.5, inplace=False)
    (lstm): LSTM(256, 512, batch_first=True)
    (pred_linear): Linear(in_features=512, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
), root_linear_h=128, save_path='model/vqvae/results/training/25031_instances/kl0.1_4x10_dec128_suffixd512/200epochs.pt', seq_to_no_pad='surface', surf_vocab=<common.vocab.VocabEntry object at 0x7f8e29a32390>, surface_vocab_file='data/sigmorphon2016/zhou_merged', task='vqvae', trndata='data/sigmorphon2016/zhou_merged', trnsize=25031, tstdata='data/sigmorphon2016/turkish-task3-dev', tstsize=25031, valdata='data/sigmorphon2016/turkish-task3-dev', valsize=1589)

encoder.embed.weight, torch.Size([36, 256]): True
encoder.lstm.weight_ih_l0, torch.Size([2048, 256]): True
encoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0, torch.Size([2048]): True
encoder.lstm.bias_hh_l0, torch.Size([2048]): True
encoder.linear.weight, torch.Size([256, 512]): True
ord_vq_layers.0.embedding.weight, torch.Size([10, 128]): True
ord_vq_layers.1.embedding.weight, torch.Size([10, 128]): True
ord_vq_layers.2.embedding.weight, torch.Size([10, 128]): True
ord_vq_layers.3.embedding.weight, torch.Size([10, 128]): True
decoder.embed.weight, torch.Size([36, 256]): True
decoder.lstm.weight_ih_l0, torch.Size([512, 768]): True
decoder.lstm.weight_hh_l0, torch.Size([512, 128]): True
decoder.lstm.bias_ih_l0, torch.Size([512]): True
decoder.lstm.bias_hh_l0, torch.Size([512]): True
decoder.pred_linear.weight, torch.Size([36, 128]): True
epoch: 0,  avg_loss: 33.1140, avg_recon_loss: 32.5023, avg_kl_loss: 0.8564, avg_vq_loss: 0.5260, ppl: 13.9309, acc: 0.2204, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1213, unique_suffix_codes: 1213, logdet: 0.0000 
val ---  avg_loss: 26.6310, avg_recon_loss: 25.8075, avg_kl_loss: 1.6364, avg_vq_loss: 0.6599, ppl: 8.0447, acc: 0.3665, vq_inds: [5, 9, 8, 10], unique_vq_codes: 155, unique_suffix_codes: 155, val_unique_suffix_codes: 10 
update best loss 

epoch: 1,  avg_loss: 24.4239, avg_recon_loss: 23.4130, avg_kl_loss: 2.3743, avg_vq_loss: 0.7735, ppl: 6.6690, acc: 0.4109, vq_inds: [8, 9, 9, 10], unique_vq_codes: 421, unique_suffix_codes: 421, logdet: 0.0000 
val ---  avg_loss: 22.8025, avg_recon_loss: 21.6576, avg_kl_loss: 2.3761, avg_vq_loss: 0.9073, ppl: 5.7531, acc: 0.4351, vq_inds: [6, 7, 7, 8], unique_vq_codes: 159, unique_suffix_codes: 159, val_unique_suffix_codes: 3 
update best loss 

epoch: 2,  avg_loss: 21.9553, avg_recon_loss: 20.5048, avg_kl_loss: 3.8075, avg_vq_loss: 1.0697, ppl: 5.2687, acc: 0.4757, vq_inds: [8, 10, 10, 10], unique_vq_codes: 560, unique_suffix_codes: 560, logdet: 0.0000 
val ---  avg_loss: 21.1646, avg_recon_loss: 19.4067, avg_kl_loss: 5.1752, avg_vq_loss: 1.2405, ppl: 4.7965, acc: 0.4980, vq_inds: [8, 9, 9, 10], unique_vq_codes: 311, unique_suffix_codes: 311, val_unique_suffix_codes: 35 
update best loss 

epoch: 3,  avg_loss: 20.5365, avg_recon_loss: 18.2685, avg_kl_loss: 7.3342, avg_vq_loss: 1.5347, ppl: 4.3953, acc: 0.5367, vq_inds: [9, 10, 10, 10], unique_vq_codes: 1127, unique_suffix_codes: 1127, logdet: 0.0000 
val ---  avg_loss: 19.9343, avg_recon_loss: 17.3083, avg_kl_loss: 9.0232, avg_vq_loss: 1.7237, ppl: 4.0485, acc: 0.5643, vq_inds: [9, 10, 10, 10], unique_vq_codes: 503, unique_suffix_codes: 503, val_unique_suffix_codes: 54 
update best loss 

epoch: 4,  avg_loss: 19.1069, avg_recon_loss: 16.2588, avg_kl_loss: 10.3274, avg_vq_loss: 1.8154, ppl: 3.7347, acc: 0.5881, vq_inds: [9, 10, 10, 10], unique_vq_codes: 1733, unique_suffix_codes: 1733, logdet: 0.0000 
val ---  avg_loss: 18.0924, avg_recon_loss: 15.1086, avg_kl_loss: 11.2077, avg_vq_loss: 1.8630, ppl: 3.3894, acc: 0.6149, vq_inds: [9, 10, 10, 10], unique_vq_codes: 655, unique_suffix_codes: 655, val_unique_suffix_codes: 56 
update best loss 

epoch: 5,  avg_loss: 17.6479, avg_recon_loss: 14.3564, avg_kl_loss: 13.8269, avg_vq_loss: 1.9088, ppl: 3.2011, acc: 0.6350, vq_inds: [9, 10, 10, 10], unique_vq_codes: 2120, unique_suffix_codes: 2120, logdet: 0.0000 
val ---  avg_loss: 16.4525, avg_recon_loss: 13.0096, avg_kl_loss: 14.7706, avg_vq_loss: 1.9659, ppl: 2.8607, acc: 0.6703, vq_inds: [9, 10, 10, 10], unique_vq_codes: 720, unique_suffix_codes: 720, val_unique_suffix_codes: 47 
update best loss 

epoch: 6,  avg_loss: 16.1400, avg_recon_loss: 12.4334, avg_kl_loss: 17.0096, avg_vq_loss: 2.0056, ppl: 2.7392, acc: 0.6838, vq_inds: [9, 10, 10, 10], unique_vq_codes: 2406, unique_suffix_codes: 2406, logdet: 0.0000 
val ---  avg_loss: 15.1784, avg_recon_loss: 11.2811, avg_kl_loss: 18.5510, avg_vq_loss: 2.0422, ppl: 2.4878, acc: 0.7144, vq_inds: [9, 10, 10, 10], unique_vq_codes: 810, unique_suffix_codes: 810, val_unique_suffix_codes: 53 
update best loss 

epoch: 7,  avg_loss: 15.0428, avg_recon_loss: 10.8963, avg_kl_loss: 20.6084, avg_vq_loss: 2.0856, ppl: 2.4183, acc: 0.7222, vq_inds: [10, 10, 10, 10], unique_vq_codes: 2939, unique_suffix_codes: 2939, logdet: 0.0000 
val ---  avg_loss: 14.6469, avg_recon_loss: 10.2958, avg_kl_loss: 22.3072, avg_vq_loss: 2.1204, ppl: 2.2975, acc: 0.7361, vq_inds: [10, 10, 10, 10], unique_vq_codes: 888, unique_suffix_codes: 888, val_unique_suffix_codes: 68 
update best loss 

epoch: 8,  avg_loss: 13.8662, avg_recon_loss: 9.4074, avg_kl_loss: 23.0128, avg_vq_loss: 2.1576, ppl: 2.1434, acc: 0.7594, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3137, unique_suffix_codes: 3137, logdet: 0.0000 
val ---  avg_loss: 13.2900, avg_recon_loss: 8.7507, avg_kl_loss: 23.8995, avg_vq_loss: 2.1494, ppl: 2.0279, acc: 0.7788, vq_inds: [10, 10, 10, 10], unique_vq_codes: 932, unique_suffix_codes: 932, val_unique_suffix_codes: 69 
update best loss 

epoch: 9,  avg_loss: 12.9577, avg_recon_loss: 8.2783, avg_kl_loss: 24.9955, avg_vq_loss: 2.1798, ppl: 1.9560, acc: 0.7884, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3410, unique_suffix_codes: 3410, logdet: 0.0000 
val ---  avg_loss: 11.9789, avg_recon_loss: 7.2577, avg_kl_loss: 25.0910, avg_vq_loss: 2.2121, ppl: 1.7974, acc: 0.8175, vq_inds: [10, 10, 10, 10], unique_vq_codes: 928, unique_suffix_codes: 928, val_unique_suffix_codes: 53 
update best loss 

epoch: 10,  avg_loss: 11.8146, avg_recon_loss: 6.9851, avg_kl_loss: 26.2308, avg_vq_loss: 2.2065, ppl: 1.7614, acc: 0.8233, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3478, unique_suffix_codes: 3478, logdet: 0.0000 
val ---  avg_loss: 11.4119, avg_recon_loss: 6.4990, avg_kl_loss: 27.4293, avg_vq_loss: 2.1699, ppl: 1.6906, acc: 0.8381, vq_inds: [10, 10, 10, 10], unique_vq_codes: 963, unique_suffix_codes: 963, val_unique_suffix_codes: 49 
update best loss 

epoch: 11,  avg_loss: 11.4031, avg_recon_loss: 6.4082, avg_kl_loss: 27.7527, avg_vq_loss: 2.2196, ppl: 1.6809, acc: 0.8373, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3471, unique_suffix_codes: 3471, logdet: 0.0000 
val ---  avg_loss: 10.5126, avg_recon_loss: 5.4996, avg_kl_loss: 27.9475, avg_vq_loss: 2.2182, ppl: 1.5594, acc: 0.8625, vq_inds: [10, 10, 10, 10], unique_vq_codes: 977, unique_suffix_codes: 977, val_unique_suffix_codes: 69 
update best loss 

epoch: 12,  avg_loss: 10.9212, avg_recon_loss: 5.8079, avg_kl_loss: 28.7751, avg_vq_loss: 2.2359, ppl: 1.6011, acc: 0.8526, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3637, unique_suffix_codes: 3637, logdet: 0.0000 
val ---  avg_loss: 10.4577, avg_recon_loss: 5.2557, avg_kl_loss: 29.9568, avg_vq_loss: 2.2063, ppl: 1.5290, acc: 0.8680, vq_inds: [10, 10, 10, 10], unique_vq_codes: 934, unique_suffix_codes: 934, val_unique_suffix_codes: 43 
update best loss 

epoch: 13,  avg_loss: 10.0867, avg_recon_loss: 4.9709, avg_kl_loss: 29.0851, avg_vq_loss: 2.2073, ppl: 1.4961, acc: 0.8746, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3552, unique_suffix_codes: 3552, logdet: 0.0000 
val ---  avg_loss: 9.8095, avg_recon_loss: 4.6451, avg_kl_loss: 29.6918, avg_vq_loss: 2.1952, ppl: 1.4554, acc: 0.8843, vq_inds: [10, 10, 10, 10], unique_vq_codes: 955, unique_suffix_codes: 955, val_unique_suffix_codes: 64 
update best loss 

epoch: 14,  avg_loss: 9.5282, avg_recon_loss: 4.3996, avg_kl_loss: 29.2110, avg_vq_loss: 2.2075, ppl: 1.4284, acc: 0.8902, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3632, unique_suffix_codes: 3632, logdet: 0.0000 
val ---  avg_loss: 9.3074, avg_recon_loss: 4.1466, avg_kl_loss: 29.7871, avg_vq_loss: 2.1822, ppl: 1.3979, acc: 0.8960, vq_inds: [10, 10, 10, 10], unique_vq_codes: 985, unique_suffix_codes: 985, val_unique_suffix_codes: 57 
update best loss 

epoch: 15,  avg_loss: 9.4060, avg_recon_loss: 4.1982, avg_kl_loss: 29.9272, avg_vq_loss: 2.2151, ppl: 1.4053, acc: 0.8943, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3610, unique_suffix_codes: 3610, logdet: 0.0000 
val ---  avg_loss: 9.0606, avg_recon_loss: 3.8466, avg_kl_loss: 30.1376, avg_vq_loss: 2.2002, ppl: 1.3645, acc: 0.9034, vq_inds: [10, 10, 10, 10], unique_vq_codes: 982, unique_suffix_codes: 982, val_unique_suffix_codes: 54 
update best loss 

epoch: 16,  avg_loss: 9.0943, avg_recon_loss: 3.8596, avg_kl_loss: 30.1278, avg_vq_loss: 2.2220, ppl: 1.3672, acc: 0.9027, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3619, unique_suffix_codes: 3619, logdet: 0.0000 
val ---  avg_loss: 8.5877, avg_recon_loss: 3.3676, avg_kl_loss: 29.7233, avg_vq_loss: 2.2477, ppl: 1.3127, acc: 0.9173, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1039, unique_suffix_codes: 1039, val_unique_suffix_codes: 70 
update best loss 

epoch: 17,  avg_loss: 8.6534, avg_recon_loss: 3.4689, avg_kl_loss: 29.6701, avg_vq_loss: 2.2176, ppl: 1.3246, acc: 0.9133, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3688, unique_suffix_codes: 3688, logdet: 0.0000 
val ---  avg_loss: 8.3079, avg_recon_loss: 3.0925, avg_kl_loss: 29.6964, avg_vq_loss: 2.2457, ppl: 1.2838, acc: 0.9243, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1062, unique_suffix_codes: 1062, val_unique_suffix_codes: 70 
update best loss 

epoch: 18,  avg_loss: 8.6030, avg_recon_loss: 3.3356, avg_kl_loss: 30.3631, avg_vq_loss: 2.2311, ppl: 1.3104, acc: 0.9161, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3817, unique_suffix_codes: 3817, logdet: 0.0000 
val ---  avg_loss: 7.9843, avg_recon_loss: 2.8423, avg_kl_loss: 29.2680, avg_vq_loss: 2.2152, ppl: 1.2581, acc: 0.9299, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1038, unique_suffix_codes: 1038, val_unique_suffix_codes: 51 
update best loss 

epoch: 19,  avg_loss: 8.1145, avg_recon_loss: 2.9359, avg_kl_loss: 29.6219, avg_vq_loss: 2.2164, ppl: 1.2686, acc: 0.9263, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3858, unique_suffix_codes: 3858, logdet: 0.0000 
val ---  avg_loss: 8.0517, avg_recon_loss: 2.8237, avg_kl_loss: 29.9340, avg_vq_loss: 2.2346, ppl: 1.2562, acc: 0.9300, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1070, unique_suffix_codes: 1070, val_unique_suffix_codes: 70 

epoch: 20,  avg_loss: 7.9943, avg_recon_loss: 2.7984, avg_kl_loss: 29.5476, avg_vq_loss: 2.2411, ppl: 1.2546, acc: 0.9301, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3959, unique_suffix_codes: 3959, logdet: 0.0000 
val ---  avg_loss: 8.2738, avg_recon_loss: 2.9102, avg_kl_loss: 31.1219, avg_vq_loss: 2.2514, ppl: 1.2651, acc: 0.9265, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1037, unique_suffix_codes: 1037, val_unique_suffix_codes: 63 

epoch: 21,  avg_loss: 8.1169, avg_recon_loss: 2.8678, avg_kl_loss: 30.1675, avg_vq_loss: 2.2324, ppl: 1.2616, acc: 0.9274, vq_inds: [10, 10, 10, 10], unique_vq_codes: 3925, unique_suffix_codes: 3925, logdet: 0.0000 
val ---  avg_loss: 7.5389, avg_recon_loss: 2.4101, avg_kl_loss: 29.1022, avg_vq_loss: 2.2186, ppl: 1.2150, acc: 0.9426, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1053, unique_suffix_codes: 1053, val_unique_suffix_codes: 78 
update best loss 

epoch: 22,  avg_loss: 7.6766, avg_recon_loss: 2.5223, avg_kl_loss: 29.3522, avg_vq_loss: 2.2191, ppl: 1.2268, acc: 0.9367, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4011, unique_suffix_codes: 4011, logdet: 0.0000 
val ---  avg_loss: 7.4506, avg_recon_loss: 2.3373, avg_kl_loss: 28.8259, avg_vq_loss: 2.2307, ppl: 1.2078, acc: 0.9422, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1065, unique_suffix_codes: 1065, val_unique_suffix_codes: 61 
update best loss 

epoch: 23,  avg_loss: 7.5152, avg_recon_loss: 2.3956, avg_kl_loss: 29.0107, avg_vq_loss: 2.2186, ppl: 1.2143, acc: 0.9402, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4099, unique_suffix_codes: 4099, logdet: 0.0000 
val ---  avg_loss: 7.4495, avg_recon_loss: 2.2753, avg_kl_loss: 29.9077, avg_vq_loss: 2.1835, ppl: 1.2018, acc: 0.9436, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1050, unique_suffix_codes: 1050, val_unique_suffix_codes: 64 
update best loss 

epoch: 24,  avg_loss: 7.8233, avg_recon_loss: 2.5873, avg_kl_loss: 30.2253, avg_vq_loss: 2.2135, ppl: 1.2333, acc: 0.9339, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4049, unique_suffix_codes: 4049, logdet: 0.0000 
val ---  avg_loss: 7.1418, avg_recon_loss: 2.0775, avg_kl_loss: 28.7693, avg_vq_loss: 2.1873, ppl: 1.1828, acc: 0.9486, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1060, unique_suffix_codes: 1060, val_unique_suffix_codes: 64 
update best loss 

epoch: 25,  avg_loss: 7.5137, avg_recon_loss: 2.3261, avg_kl_loss: 29.8869, avg_vq_loss: 2.1989, ppl: 1.2075, acc: 0.9417, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4048, unique_suffix_codes: 4048, logdet: 0.0000 
val ---  avg_loss: 7.3314, avg_recon_loss: 2.2090, avg_kl_loss: 29.6431, avg_vq_loss: 2.1581, ppl: 1.1954, acc: 0.9433, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1055, unique_suffix_codes: 1055, val_unique_suffix_codes: 62 

epoch: 26,  avg_loss: 7.2775, avg_recon_loss: 2.1832, avg_kl_loss: 29.2232, avg_vq_loss: 2.1720, ppl: 1.1936, acc: 0.9453, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4107, unique_suffix_codes: 4107, logdet: 0.0000 
val ---  avg_loss: 6.9553, avg_recon_loss: 1.9407, avg_kl_loss: 28.7210, avg_vq_loss: 2.1425, ppl: 1.1698, acc: 0.9541, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1075, unique_suffix_codes: 1075, val_unique_suffix_codes: 60 
update best loss 

epoch: 27,  avg_loss: 7.0691, avg_recon_loss: 2.0241, avg_kl_loss: 28.7010, avg_vq_loss: 2.1749, ppl: 1.1783, acc: 0.9494, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4182, unique_suffix_codes: 4182, logdet: 0.0000 
val ---  avg_loss: 8.2061, avg_recon_loss: 2.7045, avg_kl_loss: 32.4321, avg_vq_loss: 2.2584, ppl: 1.2442, acc: 0.9293, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1096, unique_suffix_codes: 1096, val_unique_suffix_codes: 81 

epoch: 28,  avg_loss: 7.2666, avg_recon_loss: 2.1483, avg_kl_loss: 29.3778, avg_vq_loss: 2.1805, ppl: 1.1902, acc: 0.9457, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4216, unique_suffix_codes: 4216, logdet: 0.0000 
val ---  avg_loss: 6.7624, avg_recon_loss: 1.7026, avg_kl_loss: 28.9159, avg_vq_loss: 2.1682, ppl: 1.1475, acc: 0.9587, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1093, unique_suffix_codes: 1093, val_unique_suffix_codes: 63 
update best loss 

epoch: 29,  avg_loss: 6.8313, avg_recon_loss: 1.8493, avg_kl_loss: 28.1094, avg_vq_loss: 2.1711, ppl: 1.1617, acc: 0.9540, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4344, unique_suffix_codes: 4344, logdet: 0.0000 
val ---  avg_loss: 6.7935, avg_recon_loss: 1.8278, avg_kl_loss: 27.9154, avg_vq_loss: 2.1741, ppl: 1.1591, acc: 0.9537, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1113, unique_suffix_codes: 1113, val_unique_suffix_codes: 72 

epoch: 30,  avg_loss: 6.9253, avg_recon_loss: 1.8724, avg_kl_loss: 28.8479, avg_vq_loss: 2.1681, ppl: 1.1639, acc: 0.9528, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4461, unique_suffix_codes: 4461, logdet: 0.0000 
val ---  avg_loss: 6.6253, avg_recon_loss: 1.6108, avg_kl_loss: 28.6513, avg_vq_loss: 2.1494, ppl: 1.1390, acc: 0.9615, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1123, unique_suffix_codes: 1123, val_unique_suffix_codes: 61 
update best loss 

epoch: 31,  avg_loss: 6.9673, avg_recon_loss: 1.9070, avg_kl_loss: 28.9145, avg_vq_loss: 2.1689, ppl: 1.1671, acc: 0.9518, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4500, unique_suffix_codes: 4500, logdet: 0.0000 
val ---  avg_loss: 6.8325, avg_recon_loss: 1.7123, avg_kl_loss: 29.3616, avg_vq_loss: 2.1840, ppl: 1.1484, acc: 0.9574, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1121, unique_suffix_codes: 1121, val_unique_suffix_codes: 65 

epoch: 32,  avg_loss: 6.8731, avg_recon_loss: 1.8664, avg_kl_loss: 28.3307, avg_vq_loss: 2.1736, ppl: 1.1633, acc: 0.9530, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4501, unique_suffix_codes: 4501, logdet: 0.0000 
val ---  avg_loss: 6.5751, avg_recon_loss: 1.6541, avg_kl_loss: 27.6221, avg_vq_loss: 2.1587, ppl: 1.1430, acc: 0.9597, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1116, unique_suffix_codes: 1116, val_unique_suffix_codes: 72 
update best loss 

epoch: 33,  avg_loss: 6.6765, avg_recon_loss: 1.7422, avg_kl_loss: 27.7123, avg_vq_loss: 2.1631, ppl: 1.1516, acc: 0.9563, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4413, unique_suffix_codes: 4413, logdet: 0.0000 
val ---  avg_loss: 6.3252, avg_recon_loss: 1.4611, avg_kl_loss: 27.1551, avg_vq_loss: 2.1485, ppl: 1.1253, acc: 0.9650, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1116, unique_suffix_codes: 1116, val_unique_suffix_codes: 67 
update best loss 

epoch: 34,  avg_loss: 6.5584, avg_recon_loss: 1.6382, avg_kl_loss: 27.5174, avg_vq_loss: 2.1686, ppl: 1.1420, acc: 0.9583, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4433, unique_suffix_codes: 4433, logdet: 0.0000 
val ---  avg_loss: 6.3501, avg_recon_loss: 1.4666, avg_kl_loss: 27.4113, avg_vq_loss: 2.1424, ppl: 1.1258, acc: 0.9634, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1111, unique_suffix_codes: 1111, val_unique_suffix_codes: 75 

epoch: 35,  avg_loss: 6.6539, avg_recon_loss: 1.7021, avg_kl_loss: 27.7886, avg_vq_loss: 2.1730, ppl: 1.1479, acc: 0.9569, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4451, unique_suffix_codes: 4451, logdet: 0.0000 
val ---  avg_loss: 6.7540, avg_recon_loss: 1.6191, avg_kl_loss: 29.6351, avg_vq_loss: 2.1714, ppl: 1.1397, acc: 0.9588, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1083, unique_suffix_codes: 1083, val_unique_suffix_codes: 62 

epoch: 36,  avg_loss: 6.6825, avg_recon_loss: 1.7098, avg_kl_loss: 28.0037, avg_vq_loss: 2.1723, ppl: 1.1486, acc: 0.9566, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4364, unique_suffix_codes: 4364, logdet: 0.0000 
val ---  avg_loss: 6.5100, avg_recon_loss: 1.5108, avg_kl_loss: 28.2451, avg_vq_loss: 2.1747, ppl: 1.1298, acc: 0.9619, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1102, unique_suffix_codes: 1102, val_unique_suffix_codes: 80 

epoch: 37,  avg_loss: 6.7931, avg_recon_loss: 1.7536, avg_kl_loss: 28.5039, avg_vq_loss: 2.1891, ppl: 1.1527, acc: 0.9555, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4384, unique_suffix_codes: 4384, logdet: 0.0000 
val ---  avg_loss: 6.3799, avg_recon_loss: 1.4368, avg_kl_loss: 27.7303, avg_vq_loss: 2.1701, ppl: 1.1231, acc: 0.9642, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1096, unique_suffix_codes: 1096, val_unique_suffix_codes: 75 

epoch: 38,  avg_loss: 6.5463, avg_recon_loss: 1.5867, avg_kl_loss: 27.7057, avg_vq_loss: 2.1890, ppl: 1.1372, acc: 0.9596, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4420, unique_suffix_codes: 4420, logdet: 0.0000 
val ---  avg_loss: 6.1904, avg_recon_loss: 1.3792, avg_kl_loss: 26.3912, avg_vq_loss: 2.1721, ppl: 1.1179, acc: 0.9654, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1092, unique_suffix_codes: 1092, val_unique_suffix_codes: 73 
update best loss 

epoch: 39,  avg_loss: 6.3274, avg_recon_loss: 1.4633, avg_kl_loss: 26.6938, avg_vq_loss: 2.1948, ppl: 1.1259, acc: 0.9632, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4432, unique_suffix_codes: 4432, logdet: 0.0000 
val ---  avg_loss: 6.2942, avg_recon_loss: 1.3969, avg_kl_loss: 26.7989, avg_vq_loss: 2.2174, ppl: 1.1195, acc: 0.9651, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1102, unique_suffix_codes: 1102, val_unique_suffix_codes: 71 

epoch: 40,  avg_loss: 6.4912, avg_recon_loss: 1.5292, avg_kl_loss: 27.4953, avg_vq_loss: 2.2125, ppl: 1.1319, acc: 0.9612, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4481, unique_suffix_codes: 4481, logdet: 0.0000 
val ---  avg_loss: 6.3636, avg_recon_loss: 1.3920, avg_kl_loss: 27.4427, avg_vq_loss: 2.2274, ppl: 1.1190, acc: 0.9657, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1118, unique_suffix_codes: 1118, val_unique_suffix_codes: 91 

epoch: 41,  avg_loss: 6.3898, avg_recon_loss: 1.4740, avg_kl_loss: 27.1543, avg_vq_loss: 2.2003, ppl: 1.1269, acc: 0.9627, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4565, unique_suffix_codes: 4565, logdet: 0.0000 
val ---  avg_loss: 6.2447, avg_recon_loss: 1.3298, avg_kl_loss: 27.3131, avg_vq_loss: 2.1836, ppl: 1.1134, acc: 0.9682, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1112, unique_suffix_codes: 1112, val_unique_suffix_codes: 66 

epoch: 42,  avg_loss: 6.3732, avg_recon_loss: 1.4782, avg_kl_loss: 27.1135, avg_vq_loss: 2.1836, ppl: 1.1273, acc: 0.9623, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4516, unique_suffix_codes: 4516, logdet: 0.0000 
val ---  avg_loss: 6.2546, avg_recon_loss: 1.4067, avg_kl_loss: 26.7350, avg_vq_loss: 2.1744, ppl: 1.1204, acc: 0.9653, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1087, unique_suffix_codes: 1087, val_unique_suffix_codes: 71 

epoch: 43,  avg_loss: 6.3663, avg_recon_loss: 1.4549, avg_kl_loss: 27.1875, avg_vq_loss: 2.1927, ppl: 1.1251, acc: 0.9629, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4609, unique_suffix_codes: 4609, logdet: 0.0000 
val ---  avg_loss: 6.1725, avg_recon_loss: 1.3524, avg_kl_loss: 26.3823, avg_vq_loss: 2.1819, ppl: 1.1155, acc: 0.9650, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1114, unique_suffix_codes: 1114, val_unique_suffix_codes: 64 
update best loss 

epoch: 44,  avg_loss: 6.1869, avg_recon_loss: 1.3716, avg_kl_loss: 26.3028, avg_vq_loss: 2.1851, ppl: 1.1176, acc: 0.9652, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4625, unique_suffix_codes: 4625, logdet: 0.0000 
val ---  avg_loss: 6.4876, avg_recon_loss: 1.5321, avg_kl_loss: 27.6636, avg_vq_loss: 2.1892, ppl: 1.1318, acc: 0.9599, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1118, unique_suffix_codes: 1118, val_unique_suffix_codes: 97 

epoch: 45,  avg_loss: 6.3712, avg_recon_loss: 1.4547, avg_kl_loss: 27.1648, avg_vq_loss: 2.2000, ppl: 1.1251, acc: 0.9629, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4680, unique_suffix_codes: 4680, logdet: 0.0000 
val ---  avg_loss: 6.1471, avg_recon_loss: 1.2713, avg_kl_loss: 26.8793, avg_vq_loss: 2.1879, ppl: 1.1082, acc: 0.9703, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1139, unique_suffix_codes: 1139, val_unique_suffix_codes: 87 
update best loss 

epoch: 46,  avg_loss: 6.3578, avg_recon_loss: 1.4892, avg_kl_loss: 26.6691, avg_vq_loss: 2.2017, ppl: 1.1283, acc: 0.9618, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4722, unique_suffix_codes: 4722, logdet: 0.0000 
val ---  avg_loss: 6.8785, avg_recon_loss: 1.7220, avg_kl_loss: 29.1716, avg_vq_loss: 2.2393, ppl: 1.1493, acc: 0.9556, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1151, unique_suffix_codes: 1151, val_unique_suffix_codes: 124 

epoch: 47,  avg_loss: 6.5677, avg_recon_loss: 1.6098, avg_kl_loss: 27.4863, avg_vq_loss: 2.2092, ppl: 1.1394, acc: 0.9584, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4663, unique_suffix_codes: 4663, logdet: 0.0000 
val ---  avg_loss: 6.2918, avg_recon_loss: 1.3888, avg_kl_loss: 26.8622, avg_vq_loss: 2.2169, ppl: 1.1187, acc: 0.9627, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1136, unique_suffix_codes: 1136, val_unique_suffix_codes: 91 

epoch: 48,  avg_loss: 6.2567, avg_recon_loss: 1.4122, avg_kl_loss: 26.5338, avg_vq_loss: 2.1911, ppl: 1.1213, acc: 0.9640, vq_inds: [10, 10, 10, 10], unique_vq_codes: 4717, unique_suffix_codes: 4717, logdet: 0.0000 
val ---  avg_loss: 6.0878, avg_recon_loss: 1.2340, avg_kl_loss: 26.7422, avg_vq_loss: 2.1795, ppl: 1.1048, acc: 0.9689, vq_inds: [10, 10, 10, 10], unique_vq_codes: 1142, unique_suffix_codes: 1142, val_unique_suffix_codes: 79 
update best loss 
