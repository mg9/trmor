
number of params: 3190784 
Namespace(batchsize=128, beta=0, dec_dropout_in=0.2, dec_dropout_out=0.2, dec_nh=512, device='cuda', embedding_dim=512, enc_dropout_in=0.2, enc_dropout_out=0.2, enc_nh=512, epochs=25, fig_path='model/vqvae/results/training/12229_instances/25epochs.png', incat=0, log_path='model/vqvae/results/training/12229_instances/25epochs.log', logger=<common.utils.Logger object at 0x7fe24df613d0>, lr=0.001, maxtrnsize=1000000, maxtstsize=10000, maxvalsize=10000, mname='vqvae', model=VQVAE_AE(
  (encoder): VQVAE_Encoder(
    (embed): Embedding(36, 256)
    (lstm): LSTM(256, 512, batch_first=True)
    (dropout_in): Dropout(p=0.2, inplace=False)
  )
  (decoder): VQVAE_Decoder(
    (embed): Embedding(36, 256, padding_idx=0)
    (dropout_in): Dropout(p=0.2, inplace=False)
    (dropout_out): Dropout(p=0.2, inplace=False)
    (lstm): LSTM(256, 512, batch_first=True)
    (pred_linear): Linear(in_features=512, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
), modelname='model/vqvae/results/training/12229_instances/', ni=256, num_dicts=0, nz=512, opt='Adam', orddict_emb_num=0, outcat=0, rootdict_emb_dim=512, rootdict_emb_num=0, save_path='model/vqvae/results/training/12229_instances/25epochs.pt', seq_to_no_pad='surface', surface_vocab_file='data/sigmorphon2016/turkish-task3-train', task='vqvae', trndata='data/sigmorphon2016/turkish-task3-train', trnsize=12229, tstdata='data/sigmorphon2016/turkish-task3-dev', tstsize=12229, valdata='data/sigmorphon2016/turkish-task3-dev', valsize=1589)

encoder.embed.weight, torch.Size([36, 256]): True
encoder.lstm.weight_ih_l0, torch.Size([2048, 256]): True
encoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
encoder.lstm.bias_ih_l0, torch.Size([2048]): True
encoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.embed.weight, torch.Size([36, 256]): True
decoder.lstm.weight_ih_l0, torch.Size([2048, 256]): True
decoder.lstm.weight_hh_l0, torch.Size([2048, 512]): True
decoder.lstm.bias_ih_l0, torch.Size([2048]): True
decoder.lstm.bias_hh_l0, torch.Size([2048]): True
decoder.pred_linear.weight, torch.Size([36, 512]): True
epoch: 0,  avg_loss: 34.3845, avg_recon_loss: 34.3845, avg_vq_loss: 0.0000, acc: 0.1770
val ---  avg_loss: 28.8471, avg_recon_loss: 28.8471, avg_vq_loss: 0.0000, acc: 0.2461
update best loss 

epoch: 1,  avg_loss: 26.3386, avg_recon_loss: 26.3386, avg_vq_loss: 0.0000, acc: 0.3361
val ---  avg_loss: 23.7569, avg_recon_loss: 23.7569, avg_vq_loss: 0.0000, acc: 0.3918
update best loss 

epoch: 2,  avg_loss: 22.8265, avg_recon_loss: 22.8265, avg_vq_loss: 0.0000, acc: 0.4075
val ---  avg_loss: 23.4670, avg_recon_loss: 23.4670, avg_vq_loss: 0.0000, acc: 0.4043
update best loss 

epoch: 3,  avg_loss: 21.6120, avg_recon_loss: 21.6120, avg_vq_loss: 0.0000, acc: 0.4330
val ---  avg_loss: 20.8900, avg_recon_loss: 20.8900, avg_vq_loss: 0.0000, acc: 0.4473
update best loss 

epoch: 4,  avg_loss: 20.2725, avg_recon_loss: 20.2725, avg_vq_loss: 0.0000, acc: 0.4628
val ---  avg_loss: 19.3253, avg_recon_loss: 19.3253, avg_vq_loss: 0.0000, acc: 0.4852
update best loss 

epoch: 5,  avg_loss: 19.2190, avg_recon_loss: 19.2190, avg_vq_loss: 0.0000, acc: 0.4880
val ---  avg_loss: 18.4018, avg_recon_loss: 18.4018, avg_vq_loss: 0.0000, acc: 0.5113
update best loss 

epoch: 6,  avg_loss: 18.0761, avg_recon_loss: 18.0761, avg_vq_loss: 0.0000, acc: 0.5201
val ---  avg_loss: 19.1038, avg_recon_loss: 19.1038, avg_vq_loss: 0.0000, acc: 0.4818

epoch: 7,  avg_loss: 17.4213, avg_recon_loss: 17.4213, avg_vq_loss: 0.0000, acc: 0.5353
val ---  avg_loss: 16.8783, avg_recon_loss: 16.8783, avg_vq_loss: 0.0000, acc: 0.5509
update best loss 

epoch: 8,  avg_loss: 15.9934, avg_recon_loss: 15.9934, avg_vq_loss: 0.0000, acc: 0.5744
val ---  avg_loss: 15.4544, avg_recon_loss: 15.4544, avg_vq_loss: 0.0000, acc: 0.5895
update best loss 

epoch: 9,  avg_loss: 15.1597, avg_recon_loss: 15.1597, avg_vq_loss: 0.0000, acc: 0.5959
val ---  avg_loss: 14.3605, avg_recon_loss: 14.3605, avg_vq_loss: 0.0000, acc: 0.6189
update best loss 

epoch: 10,  avg_loss: 13.8659, avg_recon_loss: 13.8659, avg_vq_loss: 0.0000, acc: 0.6318
val ---  avg_loss: 12.7498, avg_recon_loss: 12.7498, avg_vq_loss: 0.0000, acc: 0.6650
update best loss 

epoch: 11,  avg_loss: 12.7563, avg_recon_loss: 12.7563, avg_vq_loss: 0.0000, acc: 0.6624
val ---  avg_loss: 11.8369, avg_recon_loss: 11.8369, avg_vq_loss: 0.0000, acc: 0.6941
update best loss 

epoch: 12,  avg_loss: 11.3265, avg_recon_loss: 11.3265, avg_vq_loss: 0.0000, acc: 0.7012
val ---  avg_loss: 9.9478, avg_recon_loss: 9.9478, avg_vq_loss: 0.0000, acc: 0.7481
update best loss 

epoch: 13,  avg_loss: 9.4438, avg_recon_loss: 9.4438, avg_vq_loss: 0.0000, acc: 0.7563
val ---  avg_loss: 8.0267, avg_recon_loss: 8.0267, avg_vq_loss: 0.0000, acc: 0.8026
update best loss 

epoch: 14,  avg_loss: 8.0846, avg_recon_loss: 8.0846, avg_vq_loss: 0.0000, acc: 0.7935
val ---  avg_loss: 6.4756, avg_recon_loss: 6.4756, avg_vq_loss: 0.0000, acc: 0.8526
update best loss 

epoch: 15,  avg_loss: 6.1639, avg_recon_loss: 6.1639, avg_vq_loss: 0.0000, acc: 0.8476
val ---  avg_loss: 5.3890, avg_recon_loss: 5.3890, avg_vq_loss: 0.0000, acc: 0.8738
update best loss 

epoch: 16,  avg_loss: 4.4415, avg_recon_loss: 4.4415, avg_vq_loss: 0.0000, acc: 0.8932
val ---  avg_loss: 3.9228, avg_recon_loss: 3.9228, avg_vq_loss: 0.0000, acc: 0.9082
update best loss 

epoch: 17,  avg_loss: 3.4827, avg_recon_loss: 3.4827, avg_vq_loss: 0.0000, acc: 0.9179
val ---  avg_loss: 2.6132, avg_recon_loss: 2.6132, avg_vq_loss: 0.0000, acc: 0.9443
update best loss 

epoch: 18,  avg_loss: 2.5655, avg_recon_loss: 2.5655, avg_vq_loss: 0.0000, acc: 0.9415
val ---  avg_loss: 1.9482, avg_recon_loss: 1.9482, avg_vq_loss: 0.0000, acc: 0.9612
update best loss 

epoch: 19,  avg_loss: 1.7947, avg_recon_loss: 1.7947, avg_vq_loss: 0.0000, acc: 0.9625
val ---  avg_loss: 1.4028, avg_recon_loss: 1.4028, avg_vq_loss: 0.0000, acc: 0.9718
update best loss 

epoch: 20,  avg_loss: 1.4337, avg_recon_loss: 1.4337, avg_vq_loss: 0.0000, acc: 0.9705
val ---  avg_loss: 1.2710, avg_recon_loss: 1.2710, avg_vq_loss: 0.0000, acc: 0.9742
update best loss 

epoch: 21,  avg_loss: 1.1260, avg_recon_loss: 1.1260, avg_vq_loss: 0.0000, acc: 0.9779
val ---  avg_loss: 1.0138, avg_recon_loss: 1.0138, avg_vq_loss: 0.0000, acc: 0.9803
update best loss 

epoch: 22,  avg_loss: 0.8021, avg_recon_loss: 0.8021, avg_vq_loss: 0.0000, acc: 0.9861
val ---  avg_loss: 0.7910, avg_recon_loss: 0.7910, avg_vq_loss: 0.0000, acc: 0.9838
update best loss 

epoch: 23,  avg_loss: 0.6061, avg_recon_loss: 0.6061, avg_vq_loss: 0.0000, acc: 0.9899
val ---  avg_loss: 0.6154, avg_recon_loss: 0.6154, avg_vq_loss: 0.0000, acc: 0.9871
update best loss 

epoch: 24,  avg_loss: 0.7802, avg_recon_loss: 0.7802, avg_vq_loss: 0.0000, acc: 0.9846
val ---  avg_loss: 0.7337, avg_recon_loss: 0.7337, avg_vq_loss: 0.0000, acc: 0.9854
