
number of params: 2652281 
Namespace(batchsize=128, dec_dropout_in=0.4, dec_nh=256, device='cuda', enc_dropout_in=0.0, enc_dropout_out=0.0, enc_nh=512, epochs=50, fig_path='model/msved/results/training/12798_instances/50epochs.png', kl_anneal=True, kl_start=0.1, log_path='model/msved/results/training/12798_instances/50epochs.log', logger=<common.utils.Logger object at 0x7f93675b7490>, lr=0.001, maxtrnsize=7000000, maxtstsize=10000, maxvalsize=10000, mname='msved', model=MSVED(
  (encoder): MSVED_Encoder(
    (embed): Embedding(36, 256)
    (gru): GRU(256, 512, batch_first=True)
    (dropout_in): Dropout(p=0.0, inplace=False)
    (linear): Linear(in_features=512, out_features=300, bias=False)
  )
  (decoder): MSVED_Decoder(
    (char_embed): Embedding(36, 300, padding_idx=0)
    (dropout_in): Dropout(p=0.4, inplace=False)
    (trans_linear): Linear(in_features=150, out_features=256, bias=False)
    (gru): GRU(650, 256, batch_first=True)
    (attn): Linear(in_features=706, out_features=11, bias=True)
    (attn_combine): Linear(in_features=650, out_features=650, bias=True)
    (pred_linear): Linear(in_features=256, out_features=36, bias=False)
    (loss): CrossEntropyLoss()
  )
  (z_to_dec): Linear(in_features=150, out_features=256, bias=True)
  (tag_to_dec): Linear(in_features=200, out_features=256, bias=True)
  (tag_embeddings): ModuleList(
    (0): Embedding(7, 200)
    (1): Embedding(3, 200)
    (2): Embedding(2, 200)
    (3): Embedding(2, 200)
    (4): Embedding(3, 200)
    (5): Embedding(4, 200)
    (6): Embedding(3, 200)
    (7): Embedding(4, 200)
    (8): Embedding(5, 200)
    (9): Embedding(2, 200)
    (10): Embedding(7, 200)
  )
  (classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=7, bias=True)
    (1): Linear(in_features=512, out_features=3, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
    (4): Linear(in_features=512, out_features=3, bias=True)
    (5): Linear(in_features=512, out_features=4, bias=True)
    (6): Linear(in_features=512, out_features=3, bias=True)
    (7): Linear(in_features=512, out_features=4, bias=True)
    (8): Linear(in_features=512, out_features=5, bias=True)
    (9): Linear(in_features=512, out_features=2, bias=True)
    (10): Linear(in_features=512, out_features=7, bias=True)
  )
), modelname='model/msved/results/training/12798_instances/', ni=256, nz=150, opt='Adam', save_path='model/msved/results/training/12798_instances/50epochs.pt', seq_to_no_pad='surface', surface_vocab_file='data/sigmorphon2016/turkish-task3-train', task='msved', trndata='data/sigmorphon2016/turkish-task3-train', trnsize=12798, tstdata='data/sigmorphon2016/turkish-task3-dev', tstsize=12798, valdata='data/sigmorphon2016/turkish-task3-dev', valsize=1600, warm_up=10)

encoder.embed.weight, torch.Size([36, 256]): True
encoder.gru.weight_ih_l0, torch.Size([1536, 256]): True
encoder.gru.weight_hh_l0, torch.Size([1536, 512]): True
encoder.gru.bias_ih_l0, torch.Size([1536]): True
encoder.gru.bias_hh_l0, torch.Size([1536]): True
encoder.linear.weight, torch.Size([300, 512]): True
decoder.char_embed.weight, torch.Size([36, 300]): True
decoder.trans_linear.weight, torch.Size([256, 150]): True
decoder.gru.weight_ih_l0, torch.Size([768, 650]): True
decoder.gru.weight_hh_l0, torch.Size([768, 256]): True
decoder.gru.bias_ih_l0, torch.Size([768]): True
decoder.gru.bias_hh_l0, torch.Size([768]): True
decoder.attn.weight, torch.Size([11, 706]): True
decoder.attn.bias, torch.Size([11]): True
decoder.attn_combine.weight, torch.Size([650, 650]): True
decoder.attn_combine.bias, torch.Size([650]): True
decoder.pred_linear.weight, torch.Size([36, 256]): True
z_to_dec.weight, torch.Size([256, 150]): True
z_to_dec.bias, torch.Size([256]): True
tag_to_dec.weight, torch.Size([256, 200]): True
tag_to_dec.bias, torch.Size([256]): True
tag_embeddings.0.weight, torch.Size([7, 200]): True
tag_embeddings.1.weight, torch.Size([3, 200]): True
tag_embeddings.2.weight, torch.Size([2, 200]): True
tag_embeddings.3.weight, torch.Size([2, 200]): True
tag_embeddings.4.weight, torch.Size([3, 200]): True
tag_embeddings.5.weight, torch.Size([4, 200]): True
tag_embeddings.6.weight, torch.Size([3, 200]): True
tag_embeddings.7.weight, torch.Size([4, 200]): True
tag_embeddings.8.weight, torch.Size([5, 200]): True
tag_embeddings.9.weight, torch.Size([2, 200]): True
tag_embeddings.10.weight, torch.Size([7, 200]): True
classifiers.0.weight, torch.Size([7, 512]): True
classifiers.0.bias, torch.Size([7]): True
classifiers.1.weight, torch.Size([3, 512]): True
classifiers.1.bias, torch.Size([3]): True
classifiers.2.weight, torch.Size([2, 512]): True
classifiers.2.bias, torch.Size([2]): True
classifiers.3.weight, torch.Size([2, 512]): True
classifiers.3.bias, torch.Size([2]): True
classifiers.4.weight, torch.Size([3, 512]): True
classifiers.4.bias, torch.Size([3]): True
classifiers.5.weight, torch.Size([4, 512]): True
classifiers.5.bias, torch.Size([4]): True
classifiers.6.weight, torch.Size([3, 512]): True
classifiers.6.bias, torch.Size([3]): True
classifiers.7.weight, torch.Size([4, 512]): True
classifiers.7.bias, torch.Size([4]): True
classifiers.8.weight, torch.Size([5, 512]): True
classifiers.8.bias, torch.Size([5]): True
classifiers.9.weight, torch.Size([2, 512]): True
classifiers.9.bias, torch.Size([2]): True
classifiers.10.weight, torch.Size([7, 512]): True
classifiers.10.bias, torch.Size([7]): True
epoch: 0, kl_weight: 0.19, tmp: 1.00
trn--- loss: 1.1430, labeled_pred_loss: 0.0073, labeled_pred_acc: 0.3742, labeled_recon_loss: 2.6213, unlabeled_recon_loss: 2.6500, labeled_kl_loss: 0.6157, unlabeled_kl_loss: 0.6157 
val--- loss: 2.0120, labeled_pred_loss: 0.0122, labeled_pred_acc: 0.3688, labeled_recon_loss: 2.3588, unlabeled_recon_loss: 2.6044, labeled_kl_loss: 0.0642, unlabeled_kl_loss: 0.0642 
update best loss 

epoch: 1, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.8907, labeled_pred_loss: 0.0058, labeled_pred_acc: 0.3655, labeled_recon_loss: 2.0317, unlabeled_recon_loss: 2.0915, labeled_kl_loss: 0.0931, unlabeled_kl_loss: 0.0931 
val--- loss: 1.5297, labeled_pred_loss: 0.0098, labeled_pred_acc: 0.3475, labeled_recon_loss: 1.7168, unlabeled_recon_loss: 1.9593, labeled_kl_loss: 0.0743, unlabeled_kl_loss: 0.0743 
update best loss 

epoch: 2, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.7279, labeled_pred_loss: 0.0052, labeled_pred_acc: 0.3633, labeled_recon_loss: 1.5795, unlabeled_recon_loss: 1.6884, labeled_kl_loss: 0.1461, unlabeled_kl_loss: 0.1461 
val--- loss: 1.3247, labeled_pred_loss: 0.0093, labeled_pred_acc: 0.3613, labeled_recon_loss: 1.4322, unlabeled_recon_loss: 1.6928, labeled_kl_loss: 0.0999, unlabeled_kl_loss: 0.0999 
update best loss 

epoch: 3, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.6473, labeled_pred_loss: 0.0050, labeled_pred_acc: 0.3643, labeled_recon_loss: 1.3595, unlabeled_recon_loss: 1.4985, labeled_kl_loss: 0.1515, unlabeled_kl_loss: 0.1515 
val--- loss: 1.1930, labeled_pred_loss: 0.0089, labeled_pred_acc: 0.3631, labeled_recon_loss: 1.2577, unlabeled_recon_loss: 1.5238, labeled_kl_loss: 0.0746, unlabeled_kl_loss: 0.0746 
update best loss 

epoch: 4, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.5932, labeled_pred_loss: 0.0048, labeled_pred_acc: 0.3533, labeled_recon_loss: 1.2353, unlabeled_recon_loss: 1.3725, labeled_kl_loss: 0.2170, unlabeled_kl_loss: 0.2170 
val--- loss: 1.0969, labeled_pred_loss: 0.0089, labeled_pred_acc: 0.3550, labeled_recon_loss: 1.1525, unlabeled_recon_loss: 1.4016, labeled_kl_loss: 0.1262, unlabeled_kl_loss: 0.1262 
update best loss 

epoch: 5, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.5475, labeled_pred_loss: 0.0048, labeled_pred_acc: 0.3506, labeled_recon_loss: 1.1378, unlabeled_recon_loss: 1.2597, labeled_kl_loss: 0.1723, unlabeled_kl_loss: 0.1723 
val--- loss: 1.0340, labeled_pred_loss: 0.0086, labeled_pred_acc: 0.3300, labeled_recon_loss: 1.0989, unlabeled_recon_loss: 1.3158, labeled_kl_loss: 0.1422, unlabeled_kl_loss: 0.1422 
update best loss 

epoch: 6, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.5118, labeled_pred_loss: 0.0047, labeled_pred_acc: 0.3570, labeled_recon_loss: 1.0774, unlabeled_recon_loss: 1.1688, labeled_kl_loss: 0.1941, unlabeled_kl_loss: 0.1941 
val--- loss: 0.9894, labeled_pred_loss: 0.0087, labeled_pred_acc: 0.3356, labeled_recon_loss: 1.0460, unlabeled_recon_loss: 1.2185, labeled_kl_loss: 0.1842, unlabeled_kl_loss: 0.1842 
update best loss 

epoch: 7, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4903, labeled_pred_loss: 0.0046, labeled_pred_acc: 0.3545, labeled_recon_loss: 1.0357, unlabeled_recon_loss: 1.1000, labeled_kl_loss: 0.2153, unlabeled_kl_loss: 0.2153 
val--- loss: 0.9315, labeled_pred_loss: 0.0084, labeled_pred_acc: 0.3631, labeled_recon_loss: 0.9984, unlabeled_recon_loss: 1.1408, labeled_kl_loss: 0.1525, unlabeled_kl_loss: 0.1525 
update best loss 

epoch: 8, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4673, labeled_pred_loss: 0.0045, labeled_pred_acc: 0.3580, labeled_recon_loss: 0.9902, unlabeled_recon_loss: 1.0363, labeled_kl_loss: 0.2875, unlabeled_kl_loss: 0.2875 
val--- loss: 0.9141, labeled_pred_loss: 0.0084, labeled_pred_acc: 0.3394, labeled_recon_loss: 0.9830, unlabeled_recon_loss: 1.1268, labeled_kl_loss: 0.3586, unlabeled_kl_loss: 0.3586 
update best loss 

epoch: 9, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4499, labeled_pred_loss: 0.0045, labeled_pred_acc: 0.3635, labeled_recon_loss: 0.9557, unlabeled_recon_loss: 0.9903, labeled_kl_loss: 0.4262, unlabeled_kl_loss: 0.4262 
val--- loss: 0.9009, labeled_pred_loss: 0.0087, labeled_pred_acc: 0.3531, labeled_recon_loss: 0.9667, unlabeled_recon_loss: 1.0795, labeled_kl_loss: 0.5606, unlabeled_kl_loss: 0.5606 
update best loss 

epoch: 10, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4403, labeled_pred_loss: 0.0044, labeled_pred_acc: 0.3631, labeled_recon_loss: 0.9334, unlabeled_recon_loss: 0.9646, labeled_kl_loss: 0.6590, unlabeled_kl_loss: 0.6590 
val--- loss: 0.8600, labeled_pred_loss: 0.0083, labeled_pred_acc: 0.3531, labeled_recon_loss: 0.9116, unlabeled_recon_loss: 1.0255, labeled_kl_loss: 0.6445, unlabeled_kl_loss: 0.6445 
update best loss 

epoch: 11, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4205, labeled_pred_loss: 0.0044, labeled_pred_acc: 0.3668, labeled_recon_loss: 0.8851, unlabeled_recon_loss: 0.9076, labeled_kl_loss: 0.7695, unlabeled_kl_loss: 0.7695 
val--- loss: 0.8603, labeled_pred_loss: 0.0085, labeled_pred_acc: 0.3362, labeled_recon_loss: 0.9081, unlabeled_recon_loss: 1.0087, labeled_kl_loss: 0.8736, unlabeled_kl_loss: 0.8736 

epoch: 12, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.4121, labeled_pred_loss: 0.0044, labeled_pred_acc: 0.3621, labeled_recon_loss: 0.8654, unlabeled_recon_loss: 0.8837, labeled_kl_loss: 1.0113, unlabeled_kl_loss: 1.0113 
val--- loss: 0.8152, labeled_pred_loss: 0.0084, labeled_pred_acc: 0.3531, labeled_recon_loss: 0.8592, unlabeled_recon_loss: 0.9524, labeled_kl_loss: 1.1101, unlabeled_kl_loss: 1.1101 
update best loss 

epoch: 13, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.3973, labeled_pred_loss: 0.0043, labeled_pred_acc: 0.3665, labeled_recon_loss: 0.8250, unlabeled_recon_loss: 0.8393, labeled_kl_loss: 1.3191, unlabeled_kl_loss: 1.3191 
val--- loss: 0.7967, labeled_pred_loss: 0.0085, labeled_pred_acc: 0.3650, labeled_recon_loss: 0.8448, unlabeled_recon_loss: 0.9277, labeled_kl_loss: 1.6307, unlabeled_kl_loss: 1.6307 
update best loss 

epoch: 14, kl_weight: 0.20, tmp: 1.00
trn--- loss: 0.3887, labeled_pred_loss: 0.0043, labeled_pred_acc: 0.3693, labeled_recon_loss: 0.7942, unlabeled_recon_loss: 0.8062, labeled_kl_loss: 1.9032, unlabeled_kl_loss: 1.9032 
val--- loss: 0.7653, labeled_pred_loss: 0.0084, labeled_pred_acc: 0.3469, labeled_recon_loss: 0.7830, unlabeled_recon_loss: 0.8649, labeled_kl_loss: 2.0229, unlabeled_kl_loss: 2.0229 
update best loss 
